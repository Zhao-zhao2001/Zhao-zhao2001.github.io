<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>基于API HOOK的软件行为分析系统 | 穿越时空BB机</title><meta name="keywords" content="软件安全,课程设计"><meta name="author" content="Zhao CP,1524276984@qq.com"><meta name="copyright" content="Zhao CP"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="软件安全课程设计，利用Detours库截获软件API并进行行为分析">
<meta property="og:type" content="article">
<meta property="og:title" content="基于API HOOK的软件行为分析系统">
<meta property="og:url" content="https://zhao-zhao2001.gitee.io/2021/11/17/%E5%9F%BA%E4%BA%8EAPI-HOOK%E7%9A%84%E8%BD%AF%E4%BB%B6%E8%A1%8C%E4%B8%BA%E5%88%86%E6%9E%90%E7%B3%BB%E7%BB%9F/index.html">
<meta property="og:site_name" content="穿越时空BB机">
<meta property="og:description" content="软件安全课程设计，利用Detours库截获软件API并进行行为分析">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://changpeng-image.oss-cn-hangzhou.aliyuncs.com/images-master/img/21142970880911ebb6edd017c2d2eca2.jpg">
<meta property="article:published_time" content="2021-11-17T14:45:51.000Z">
<meta property="article:modified_time" content="2021-11-17T14:45:51.000Z">
<meta property="article:author" content="Zhao CP">
<meta property="article:tag" content="软件安全">
<meta property="article:tag" content="课程设计">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://changpeng-image.oss-cn-hangzhou.aliyuncs.com/images-master/img/21142970880911ebb6edd017c2d2eca2.jpg"><link rel="shortcut icon" href="https://changpeng-image.oss-cn-hangzhou.aliyuncs.com/images-master/img/self.png"><link rel="canonical" href="https://zhao-zhao2001.gitee.io/2021/11/17/%E5%9F%BA%E4%BA%8EAPI-HOOK%E7%9A%84%E8%BD%AF%E4%BB%B6%E8%A1%8C%E4%B8%BA%E5%88%86%E6%9E%90%E7%B3%BB%E7%BB%9F/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin=""/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":600},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: Zhao CP","link":"链接: ","source":"来源: 穿越时空BB机","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#2d3035","position":"bottom-center"},
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '基于API HOOK的软件行为分析系统',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-11-17 22:45:51'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const fontSizeVal = saveToLocal.get('global-font-size')
    if (fontSizeVal !== undefined) {
      document.documentElement.style.setProperty('--global-font-size', fontSizeVal + 'px')
    }
    
    const detectApple = () => {
      if (GLOBAL_CONFIG_SITE.isHome && /iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    document.addEventListener('pjax:complete', detectApple)})(window)</script><link rel="stylesheet" href="/css/ShouyeTouming.css"><link rel="stylesheet" href="/css/icon.css"><link rel="stylesheet" href="/css/Peng.css"><link rel="stylesheet" href="https://cdn.bootcss.com/KaTeX/0.7.1/katex.min.css" ><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper/swiper-bundle.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-card-history/baiduhistory/css/main.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/hexo-electric-clock@1.0.6/clock.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/l-lin/font-awesome-animation/dist/font-awesome-animation.min.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-butterfly-tag-plugins-plus@latest/lib/tag_plugins.min.css" media="defer" onload="this.media='all'"><script async src="https://cdn.jsdelivr.net/npm/hexo-butterfly-tag-plugins-plus@latest/lib/carousel-touch.min.js"></script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.4.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://changpeng-image.oss-cn-hangzhou.aliyuncs.com/images-master/img/self.png" onerror="onerror=null;src='https://changpeng-image.oss-cn-hangzhou.aliyuncs.com/images-master/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">24</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">13</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">16</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://changpeng-image.oss-cn-hangzhou.aliyuncs.com/images-master/img/21142970880911ebb6edd017c2d2eca2.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">穿越时空BB机</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">基于API HOOK的软件行为分析系统</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-11-17T14:45:51.000Z" title="发表于 2021-11-17 22:45:51">2021-11-17</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-11-17T14:45:51.000Z" title="更新于 2021-11-17 22:45:51">2021-11-17</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E8%AF%BE%E7%A8%8B%E8%AE%BE%E8%AE%A1/">课程设计</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E8%AF%BE%E7%A8%8B%E8%AE%BE%E8%AE%A1/%E8%BD%AF%E4%BB%B6%E5%AE%89%E5%85%A8/">软件安全</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">19.4k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>109分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="基于API HOOK的软件行为分析系统"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><hr />
<p>操作平台:<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtext>  </mtext><mi>W</mi><mi>i</mi><mi>n</mi><mtext>  </mtext><mn>10</mn><mtext>  </mtext><mi>X</mi><mn>86</mn></mrow><annotation encoding="application/x-tex">\;Win\;10\;X86</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">W</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mord">8</span><span class="mord">6</span></span></span></span></p>
<p>编译软件:<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtext>  </mtext><mi>V</mi><mi>S</mi><mn>2019</mn><mtext>  </mtext></mrow><annotation encoding="application/x-tex">\;VS2019\;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord">2</span><span class="mord">0</span><span class="mord">1</span><span class="mord">9</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span></span></span></p>
<p>界面设计:<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtext>  </mtext><mi>Q</mi><mi>t</mi><mtext>  </mtext><mn>5.12</mn><mtext>  </mtext></mrow><annotation encoding="application/x-tex">\;Qt\;5.12\;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault">Q</span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">5</span><span class="mord">.</span><span class="mord">1</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span></span></span></p>
<hr />
<p>效果预览：</p>
<p><img src="https://changpeng-image.oss-cn-hangzhou.aliyuncs.com/images-master/img/20211117225136.png" alt="主界面" /></p>
<p>程序中用到的图标文件可以自行替换。</p>
<hr />
<h3 id="dll编写"><a class="markdownIt-Anchor" href="#dll编写"></a> Dll编写</h3>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// dllmain.cpp : 定义 DLL 应用程序的入口点。</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;pch.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;framework.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;detours.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stdio.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stdarg.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;windows.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unordered_map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;WinSock2.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> comment(lib,<span class="meta-string">&quot;detours.lib&quot;</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> comment(lib,<span class="meta-string">&quot;ws2_32.lib&quot;</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> <span class="meta-keyword">warning</span>(disable:4996)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MESSAGEBOXA 1</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MESSAGEBOXW 2</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CREATEFILE 3</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> WRITEFILE 4</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> READFILE 5</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CLOSEHANDLE 6</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> HEAPCREATE 7</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> HEAPDESTROY 8</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> HEAPFREE 9</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> HEAPALLOC 10</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> REGCREATEKEYEX 11</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> REGSETVALUEEX 12</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> REGCLOSEKEY 13</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> REGOPENKEYEX 14</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> REGDELETEVALUE 15</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> THESOCKET 16</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BIND 17</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SEND 18</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CONNECT 19</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> RECV 20</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> COPYFILEA 21</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line">SYSTEMTIME st;</span><br><span class="line"></span><br><span class="line"> <span class="class"><span class="keyword">struct</span> <span class="title">info</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> type;<span class="comment">//截获API类型</span></span><br><span class="line">    <span class="keyword">int</span> Num;<span class="comment">//参数个数</span></span><br><span class="line">    SYSTEMTIME st;</span><br><span class="line">    <span class="keyword">char</span> Name[<span class="number">10</span>][<span class="number">30</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">    <span class="keyword">char</span> Value[<span class="number">10</span>][<span class="number">70</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"> multiset&lt;HANDLE&gt; heaphandle;</span><br><span class="line">HANDLE hSemaphore = <span class="built_in">OpenSemaphore</span>(EVENT_ALL_ACCESS, FALSE, <span class="string">L&quot;mySemaphore&quot;</span>);</span><br><span class="line">HANDLE hMapFile = <span class="built_in">OpenFileMapping</span>(FILE_MAP_ALL_ACCESS, <span class="literal">NULL</span>, <span class="string">L&quot;ShareMemory&quot;</span>);</span><br><span class="line">LPVOID lpBase = <span class="built_in">MapViewOfFile</span>(hMapFile, FILE_MAP_ALL_ACCESS, <span class="number">0</span>, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(info));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//需要HOOK的函数名</span></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="title">int</span> <span class="params">(WINAPI* OldMessageBoxW)</span><span class="params">(_In_opt_ HWND hwnd, _In_opt_ LPCWSTR lpText, _In_opt_ LPCWSTR lpCaption, _In_ UINT utype)</span> </span>= MessageBoxW;</span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="title">int</span> <span class="params">(WINAPI* OldMessageBoxA)</span><span class="params">(_In_opt_ HWND hwnd, _In_opt_ LPCSTR lpText, _In_opt_ LPCSTR lpCaption, _In_ UINT utype)</span> </span>= MessageBoxA;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//替换的函数</span></span><br><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span> __declspec(dllexport)<span class="function"><span class="keyword">int</span> WINAPI <span class="title">NewMessageBoxA</span><span class="params">(_In_opt_ HWND hwnd, _In_opt_ LPCSTR lpText, _In_opt_ LPCSTR lpCaption, _In_ UINT utype)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    info info1;</span><br><span class="line">    <span class="comment">//向共享内存中写入信息</span></span><br><span class="line">    info1.type = MESSAGEBOXA;</span><br><span class="line">    info1.Num = <span class="number">4</span>;</span><br><span class="line">    <span class="built_in">GetLocalTime</span>(&amp;(info1.st));</span><br><span class="line">    <span class="built_in">sprintf</span>(info1.Name[<span class="number">0</span>], <span class="string">&quot;hwnd&quot;</span>);</span><br><span class="line">    <span class="built_in">sprintf</span>(info1.Name[<span class="number">1</span>], <span class="string">&quot;lpText(窗口文本)&quot;</span>);</span><br><span class="line">    <span class="built_in">sprintf</span>(info1.Name[<span class="number">2</span>], <span class="string">&quot;lpCaption(窗口标题)&quot;</span>);</span><br><span class="line">    <span class="built_in">sprintf</span>(info1.Name[<span class="number">3</span>], <span class="string">&quot;utype&quot;</span>);</span><br><span class="line">    <span class="built_in">sprintf</span>(info1.Value[<span class="number">0</span>], <span class="string">&quot;%08X&quot;</span>, hwnd);</span><br><span class="line">    <span class="built_in">sprintf</span>(info1.Value[<span class="number">1</span>], <span class="string">&quot;%s&quot;</span>, lpText);</span><br><span class="line">    <span class="built_in">sprintf</span>(info1.Value[<span class="number">2</span>], <span class="string">&quot;%s&quot;</span>, lpCaption);</span><br><span class="line">    <span class="built_in">sprintf</span>(info1.Value[<span class="number">3</span>], <span class="string">&quot;%08X&quot;</span>, utype);</span><br><span class="line">    <span class="built_in">memcpy</span>(lpBase, &amp;info1, <span class="built_in"><span class="keyword">sizeof</span></span>(info));</span><br><span class="line">    <span class="comment">//V操作，信号量加一</span></span><br><span class="line">    <span class="built_in">ReleaseSemaphore</span>(hSemaphore, <span class="number">1</span>, <span class="literal">NULL</span>); </span><br><span class="line">    info1.Num = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">OldMessageBoxA</span>(<span class="literal">NULL</span>,<span class="string">&quot;嘿，没想到吧！FBI！！open the door！&quot;</span>,<span class="string">&quot;已批准逮捕&quot;</span>,MB_OK);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span> __declspec(dllexport)<span class="function"><span class="keyword">int</span> WINAPI <span class="title">NewMessageBoxW</span><span class="params">(_In_opt_ HWND hwnd, _In_opt_ LPCWSTR lpText, _In_opt_ LPCWSTR lpCaption, _In_ UINT utype)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    info info2;</span><br><span class="line">    info2.Num = <span class="number">4</span>;</span><br><span class="line">    info2.type = MESSAGEBOXW;</span><br><span class="line">    <span class="built_in">GetLocalTime</span>(&amp;(info2.st));</span><br><span class="line">    <span class="built_in">sprintf</span>(info2.Name[<span class="number">0</span>], <span class="string">&quot;hwnd&quot;</span>);</span><br><span class="line">    <span class="built_in">sprintf</span>(info2.Name[<span class="number">1</span>], <span class="string">&quot;lpText(窗口内容)&quot;</span>);</span><br><span class="line">    <span class="built_in">sprintf</span>(info2.Name[<span class="number">2</span>], <span class="string">&quot;lpCaption(窗口标题)&quot;</span>);</span><br><span class="line">    <span class="built_in">sprintf</span>(info2.Name[<span class="number">3</span>], <span class="string">&quot;utype&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">char</span> temp[<span class="number">70</span>];</span><br><span class="line">    <span class="built_in">memset</span>(temp, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(temp));</span><br><span class="line">    <span class="built_in">WideCharToMultiByte</span>(CP_ACP, <span class="number">0</span>, lpText, <span class="built_in">wcslen</span>(lpText), temp, <span class="built_in"><span class="keyword">sizeof</span></span>(temp), <span class="literal">NULL</span>, <span class="literal">NULL</span>);</span><br><span class="line">    <span class="built_in">strcpy</span>(info2.Value[<span class="number">1</span>], temp);</span><br><span class="line">    <span class="built_in">memset</span>(temp, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(temp));</span><br><span class="line">    <span class="built_in">WideCharToMultiByte</span>(CP_ACP, <span class="number">0</span>, lpCaption, <span class="built_in">wcslen</span>(lpCaption), temp, <span class="built_in"><span class="keyword">sizeof</span></span>(temp), <span class="literal">NULL</span>, <span class="literal">NULL</span>);</span><br><span class="line">    <span class="built_in">strcpy</span>(info2.Value[<span class="number">2</span>], temp);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">sprintf</span>(info2.Value[<span class="number">0</span>], <span class="string">&quot;%08X&quot;</span>, hwnd);</span><br><span class="line">    <span class="built_in">sprintf</span>(info2.Value[<span class="number">3</span>], <span class="string">&quot;%08X&quot;</span>, utype);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*FILE* f = fopen(&quot;log.txt&quot;, &quot;a+&quot;);</span></span><br><span class="line"><span class="comment">    fprintf(f, &quot;%s\n&quot;, info2.type);</span></span><br><span class="line"><span class="comment">    for (int i = 0; i &lt; info2.Num; i++)</span></span><br><span class="line"><span class="comment">    &#123;</span></span><br><span class="line"><span class="comment">        fprintf(f, &quot;%s : %s\n&quot;, info2.Name[i], info2.Value[i]);</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">    fclose(f)*/</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">memcpy</span>(lpBase, &amp;info2, <span class="built_in"><span class="keyword">sizeof</span></span>(info));</span><br><span class="line"></span><br><span class="line">    <span class="built_in">ReleaseSemaphore</span>(hSemaphore, <span class="number">1</span>, <span class="literal">NULL</span>);</span><br><span class="line">    info2.Num = <span class="number">0</span>;</span><br><span class="line">   </span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">OldMessageBoxW</span>(<span class="literal">NULL</span>, <span class="string">L&quot;FBI！！open the door！&quot;</span>, <span class="string">L&quot;已批准逮捕&quot;</span>, MB_OK);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="title">HANDLE</span><span class="params">(WINAPI* OldCreateFile)</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">    LPCWSTR               lpFileName,</span></span></span><br><span class="line"><span class="function"><span class="params">    DWORD                 dwDesiredAccess,</span></span></span><br><span class="line"><span class="function"><span class="params">    DWORD                 dwShareMode,</span></span></span><br><span class="line"><span class="function"><span class="params">    LPSECURITY_ATTRIBUTES lpSecurityAttributes,</span></span></span><br><span class="line"><span class="function"><span class="params">    DWORD                 dwCreationDisposition,</span></span></span><br><span class="line"><span class="function"><span class="params">    DWORD                 dwFlagsAndAttributes,</span></span></span><br><span class="line"><span class="function"><span class="params">    HANDLE                hTemplateFile</span></span></span><br><span class="line"><span class="function"><span class="params">    )</span> </span>= CreateFile;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span> __declspec(dllexport)<span class="function">HANDLE WINAPI <span class="title">NewCreateFile</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">    LPCWSTR               lpFileName,</span></span></span><br><span class="line"><span class="function"><span class="params">    DWORD                 dwDesiredAccess,</span></span></span><br><span class="line"><span class="function"><span class="params">    DWORD                 dwShareMode,</span></span></span><br><span class="line"><span class="function"><span class="params">    LPSECURITY_ATTRIBUTES lpSecurityAttributes,</span></span></span><br><span class="line"><span class="function"><span class="params">    DWORD                 dwCreationDisposition,</span></span></span><br><span class="line"><span class="function"><span class="params">    DWORD                 dwFlagsAndAttributes,</span></span></span><br><span class="line"><span class="function"><span class="params">    HANDLE                hTemplateFile</span></span></span><br><span class="line"><span class="function"><span class="params">)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    HANDLE hFile = <span class="built_in">OldCreateFile</span>(lpFileName, dwDesiredAccess, dwShareMode, lpSecurityAttributes, dwCreationDisposition, dwFlagsAndAttributes, hTemplateFile);</span><br><span class="line">    info info3;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">GetFileType</span>(hFile) == FILE_TYPE_DISK) &#123;</span><br><span class="line">        <span class="keyword">char</span> temp[<span class="number">70</span>];</span><br><span class="line">        info3.type = CREATEFILE;</span><br><span class="line">        <span class="built_in">GetLocalTime</span>(&amp;(info3.st));</span><br><span class="line"></span><br><span class="line">        info3.Num = <span class="number">8</span>;</span><br><span class="line">        <span class="comment">// 参数名</span></span><br><span class="line">        <span class="built_in">sprintf</span>(info3.Name[<span class="number">0</span>], <span class="string">&quot;lpFileName&quot;</span>);</span><br><span class="line">        <span class="built_in">sprintf</span>(info3.Name[<span class="number">1</span>], <span class="string">&quot;dwDesiredAccess&quot;</span>);</span><br><span class="line">        <span class="built_in">sprintf</span>(info3.Name[<span class="number">2</span>], <span class="string">&quot;dwShareMode&quot;</span>);</span><br><span class="line">        <span class="built_in">sprintf</span>(info3.Name[<span class="number">3</span>], <span class="string">&quot;lpSecurityAttributes&quot;</span>);</span><br><span class="line">        <span class="built_in">sprintf</span>(info3.Name[<span class="number">4</span>], <span class="string">&quot;dwCreationDisposition&quot;</span>);</span><br><span class="line">        <span class="built_in">sprintf</span>(info3.Name[<span class="number">5</span>], <span class="string">&quot;dwFlagsAndAttributes&quot;</span>);</span><br><span class="line">        <span class="built_in">sprintf</span>(info3.Name[<span class="number">6</span>], <span class="string">&quot;hTemplateFile&quot;</span>);</span><br><span class="line">        <span class="built_in">sprintf</span>(info3.Name[<span class="number">7</span>], <span class="string">&quot;返回文件句柄&quot;</span>);</span><br><span class="line">        <span class="comment">// 参数值</span></span><br><span class="line">        <span class="comment">// 宽字节转char</span></span><br><span class="line">        <span class="built_in">memset</span>(temp, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(temp));</span><br><span class="line">        <span class="built_in">WideCharToMultiByte</span>(CP_ACP, <span class="number">0</span>, lpFileName, <span class="built_in">wcslen</span>(lpFileName), temp, <span class="built_in"><span class="keyword">sizeof</span></span>(temp), <span class="literal">NULL</span>, <span class="literal">NULL</span>);</span><br><span class="line">        <span class="built_in">strcpy</span>(info3.Value[<span class="number">0</span>], temp);</span><br><span class="line">        <span class="built_in">sprintf</span>(info3.Value[<span class="number">1</span>], <span class="string">&quot;%08X&quot;</span>, dwDesiredAccess);</span><br><span class="line">        <span class="built_in">sprintf</span>(info3.Value[<span class="number">2</span>], <span class="string">&quot;%08X&quot;</span>, dwShareMode);</span><br><span class="line">        <span class="built_in">sprintf</span>(info3.Value[<span class="number">3</span>], <span class="string">&quot;%08X&quot;</span>, lpSecurityAttributes);</span><br><span class="line">        <span class="built_in">sprintf</span>(info3.Value[<span class="number">4</span>], <span class="string">&quot;%08X&quot;</span>, dwCreationDisposition);</span><br><span class="line">        <span class="built_in">sprintf</span>(info3.Value[<span class="number">5</span>], <span class="string">&quot;%08X&quot;</span>, dwFlagsAndAttributes);</span><br><span class="line">        <span class="built_in">sprintf</span>(info3.Value[<span class="number">6</span>], <span class="string">&quot;%08X&quot;</span>, hTemplateFile);</span><br><span class="line">        <span class="built_in">sprintf</span>(info3.Value[<span class="number">7</span>], <span class="string">&quot;%08X&quot;</span>, hFile);</span><br><span class="line">        <span class="built_in">memcpy</span>(lpBase, &amp;info3, <span class="built_in"><span class="keyword">sizeof</span></span>(info));</span><br><span class="line">        <span class="built_in">ReleaseSemaphore</span>(hSemaphore, <span class="number">1</span>, <span class="literal">NULL</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> hFile;</span><br><span class="line">    <span class="comment">//return OldCreateFile(lpFileName, dwDesiredAccess, dwShareMode, lpSecurityAttributes, dwCreationDisposition, dwFlagsAndAttributes, hTemplateFile);</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="title">BOOL</span><span class="params">(WINAPI* OldWriteFile)</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">    HANDLE  hFile,<span class="comment">//文件句柄</span></span></span></span><br><span class="line"><span class="function"><span class="params">    LPCVOID lpBuffer,<span class="comment">//数据缓存区指针</span></span></span></span><br><span class="line"><span class="function"><span class="params">    DWORD   nNumberOfBytesToWrite,<span class="comment">//你要写的字节数</span></span></span></span><br><span class="line"><span class="function"><span class="params">    LPDWORD lpNumberOfBytesWritten,<span class="comment">//用于保存实际写入字节数的存储区域的指针</span></span></span></span><br><span class="line"><span class="function"><span class="params">    LPOVERLAPPED lpOverlapped<span class="comment">//OVERLAPPED结构体指针</span></span></span></span><br><span class="line"><span class="function"><span class="params">    )</span> </span>= WriteFile;</span><br><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span> __declspec(dllexport)<span class="function">BOOL WINAPI <span class="title">NewWriteFile</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">    HANDLE hFile,</span></span></span><br><span class="line"><span class="function"><span class="params">    LPCVOID lpBuffer,</span></span></span><br><span class="line"><span class="function"><span class="params">    DWORD nNumberOfBytesToWrite,</span></span></span><br><span class="line"><span class="function"><span class="params">    LPDWORD lpNumberOfBytesWritten,<span class="comment">//用于保存实际写入字节数的存储区域的指针</span></span></span></span><br><span class="line"><span class="function"><span class="params">    LPOVERLAPPED lpOverlapped</span></span></span><br><span class="line"><span class="function"><span class="params">)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">GetFileType</span>(hFile) == FILE_TYPE_DISK)</span><br><span class="line">    &#123;</span><br><span class="line">        info info4;</span><br><span class="line">        info4.type = WRITEFILE;</span><br><span class="line">        info4.Num = <span class="number">5</span>;</span><br><span class="line">        <span class="built_in">GetLocalTime</span>(&amp;(info4.st));</span><br><span class="line">        <span class="comment">//参数名称</span></span><br><span class="line">        <span class="built_in">sprintf</span>(info4.Name[<span class="number">0</span>], <span class="string">&quot;hFile(文件句柄)&quot;</span>);</span><br><span class="line">        <span class="built_in">sprintf</span>(info4.Name[<span class="number">1</span>], <span class="string">&quot;lpBuffer(数据缓存区指针)&quot;</span>);</span><br><span class="line">        <span class="built_in">sprintf</span>(info4.Name[<span class="number">2</span>], <span class="string">&quot;nNumberOfBytesToWrite(要写的字节数)&quot;</span>);</span><br><span class="line">        <span class="built_in">sprintf</span>(info4.Name[<span class="number">3</span>], <span class="string">&quot;lpNumberOfBytesWritten(实际写入字节数存储区域指针)&quot;</span>);</span><br><span class="line">        <span class="built_in">sprintf</span>(info4.Name[<span class="number">4</span>], <span class="string">&quot;lpOverlapped&quot;</span>);</span><br><span class="line">        <span class="comment">//参数的键值</span></span><br><span class="line">        <span class="built_in">sprintf</span>(info4.Value[<span class="number">0</span>], <span class="string">&quot;%08X&quot;</span>, hFile);</span><br><span class="line">        <span class="built_in">sprintf</span>(info4.Value[<span class="number">1</span>], <span class="string">&quot;%08X&quot;</span>, lpBuffer);</span><br><span class="line">        <span class="built_in">sprintf</span>(info4.Value[<span class="number">2</span>], <span class="string">&quot;%08X&quot;</span>, nNumberOfBytesToWrite);</span><br><span class="line">        <span class="built_in">sprintf</span>(info4.Value[<span class="number">3</span>], <span class="string">&quot;%08X&quot;</span>, lpNumberOfBytesWritten);</span><br><span class="line">        <span class="built_in">sprintf</span>(info4.Value[<span class="number">4</span>], <span class="string">&quot;%08X&quot;</span>, lpOverlapped);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">memcpy</span>(lpBase, &amp;info4, <span class="built_in"><span class="keyword">sizeof</span></span>(info));</span><br><span class="line">        <span class="built_in">ReleaseSemaphore</span>(hSemaphore, <span class="number">1</span>, <span class="literal">NULL</span>);</span><br><span class="line">        info4.Num = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">OldWriteFile</span>(hFile, lpBuffer, nNumberOfBytesToWrite, lpNumberOfBytesWritten, lpOverlapped);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="title">BOOL</span><span class="params">(WINAPI* OldReadFile)</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">    HANDLE hFile,                                    <span class="comment">//文件的句柄</span></span></span></span><br><span class="line"><span class="function"><span class="params">    LPVOID lpBuffer,                                <span class="comment">//用于保存读入数据的一个缓冲区</span></span></span></span><br><span class="line"><span class="function"><span class="params">    DWORD nNumberOfBytesToRead,    <span class="comment">//要读入的字节数</span></span></span></span><br><span class="line"><span class="function"><span class="params">    LPDWORD lpNumberOfBytesRead,    <span class="comment">//指向实际读取字节数的指针</span></span></span></span><br><span class="line"><span class="function"><span class="params">    LPOVERLAPPED lpOverlapped</span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="comment">//如文件打开时指定了FILE_FLAG_OVERLAPPED，那么必须，用这个参数引用一个特殊的结构。</span></span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="comment">//该结构定义了一次异步读取操作。否则，应将这个参数设为NULL</span></span></span></span><br><span class="line"><span class="function"><span class="params">    )</span> </span>= ReadFile;</span><br><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span> __declspec(dllexport)<span class="function">BOOL WINAPI <span class="title">NewReadFile</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">    HANDLE hFile,                                    <span class="comment">//文件的句柄</span></span></span></span><br><span class="line"><span class="function"><span class="params">    LPVOID lpBuffer,                                <span class="comment">//用于保存读入数据的一个缓冲区</span></span></span></span><br><span class="line"><span class="function"><span class="params">    DWORD nNumberOfBytesToRead,    <span class="comment">//要读入的字节数</span></span></span></span><br><span class="line"><span class="function"><span class="params">    LPDWORD lpNumberOfBytesRead,    <span class="comment">//指向实际读取字节数的指针</span></span></span></span><br><span class="line"><span class="function"><span class="params">    LPOVERLAPPED lpOverlapped</span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="comment">//如文件打开时指定了FILE_FLAG_OVERLAPPED，那么必须，用这个参数引用一个特殊的结构。</span></span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="comment">//该结构定义了一次异步读取操作。否则，应将这个参数设为NULL</span></span></span></span><br><span class="line"><span class="function"><span class="params">)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   <span class="comment">/* bool x = true;*/</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">GetFileType</span>(hFile) == FILE_TYPE_DISK) &#123;</span><br><span class="line">        info info5;</span><br><span class="line">        info5.Num = <span class="number">5</span>;</span><br><span class="line">        info5.type = READFILE;</span><br><span class="line">        <span class="built_in">GetLocalTime</span>(&amp;(info5.st));</span><br><span class="line">        <span class="comment">//截获</span></span><br><span class="line">       <span class="comment">/* char str[100] = &#123; 0 &#125;;</span></span><br><span class="line"><span class="comment">        str = (char*)malloc((nNumberOfBytesToRead + 1) * sizeof(char));</span></span><br><span class="line"><span class="comment">        x = OldReadFile(hFile, str, nNumberOfBytesToRead, lpNumberOfBytesRead, lpOverlapped);</span></span><br><span class="line"><span class="comment">        str[nNumberOfBytesToRead] = &#x27;\0&#x27;;</span></span><br><span class="line"><span class="comment">        memcpy(lpBuffer,str,sizeof(str));*/</span></span><br><span class="line">        <span class="comment">//参数名称和键值</span></span><br><span class="line">        <span class="built_in">sprintf</span>(info5.Name[<span class="number">0</span>], <span class="string">&quot;hFile(文件句柄)&quot;</span>);</span><br><span class="line">        <span class="built_in">sprintf</span>(info5.Value[<span class="number">0</span>], <span class="string">&quot;%08X&quot;</span>, hFile);</span><br><span class="line">        <span class="built_in">sprintf</span>(info5.Name[<span class="number">1</span>], <span class="string">&quot;lpBuffer(保存数据缓冲区)&quot;</span>);</span><br><span class="line">        <span class="built_in">sprintf</span>(info5.Value[<span class="number">1</span>], <span class="string">&quot;%08X&quot;</span>, lpBuffer);</span><br><span class="line">        <span class="built_in">sprintf</span>(info5.Name[<span class="number">2</span>], <span class="string">&quot;nNumberOfBytesToRead(要读的字节数)&quot;</span>);</span><br><span class="line">        <span class="built_in">sprintf</span>(info5.Value[<span class="number">2</span>], <span class="string">&quot;%08X&quot;</span>, nNumberOfBytesToRead);</span><br><span class="line">        <span class="built_in">sprintf</span>(info5.Name[<span class="number">3</span>], <span class="string">&quot;lpNumberOfBytesRead&quot;</span>);</span><br><span class="line">        <span class="built_in">sprintf</span>(info5.Value[<span class="number">3</span>], <span class="string">&quot;%08X&quot;</span>, lpNumberOfBytesRead);</span><br><span class="line">        <span class="built_in">sprintf</span>(info5.Name[<span class="number">4</span>], <span class="string">&quot;lpOverlapped&quot;</span>);</span><br><span class="line">        <span class="built_in">sprintf</span>(info5.Value[<span class="number">4</span>], <span class="string">&quot;%08X&quot;</span>, lpOverlapped);</span><br><span class="line">       <span class="comment">/* sprintf(info5.Name[5], &quot;读取的数据&quot;);</span></span><br><span class="line"><span class="comment">        sprintf(info5.Value[5], &quot;%s&quot;, str);*/</span></span><br><span class="line">        <span class="built_in">memcpy</span>(lpBase, &amp;info5, <span class="built_in"><span class="keyword">sizeof</span></span>(info));</span><br><span class="line">        <span class="built_in">ReleaseSemaphore</span>(hSemaphore, <span class="number">1</span>, <span class="literal">NULL</span>);</span><br><span class="line">        info5.Num = <span class="number">0</span>;</span><br><span class="line">        <span class="comment">/*return x;*/</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">OldReadFile</span>(hFile, lpBuffer, nNumberOfBytesToRead, lpNumberOfBytesRead, lpOverlapped);</span><br><span class="line">   <span class="comment">// return x;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//文件句柄关闭</span></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="title">BOOL</span><span class="params">(WINAPI* OldCloseHandle)</span><span class="params">(HANDLE hObject)</span> </span>= CloseHandle;</span><br><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span> __declspec(dllexport)<span class="function">BOOL WINAPI <span class="title">NewCloseHandle</span><span class="params">(HANDLE hObject)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    info info6;</span><br><span class="line">    info6.type = CLOSEHANDLE;</span><br><span class="line">    info6.Num = <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">GetLocalTime</span>(&amp;(info6.st));</span><br><span class="line">    <span class="built_in">sprintf</span>(info6.Name[<span class="number">0</span>], <span class="string">&quot;hObject&quot;</span>);</span><br><span class="line">    <span class="built_in">sprintf</span>(info6.Value[<span class="number">0</span>], <span class="string">&quot;%08X&quot;</span>, hObject);</span><br><span class="line">    <span class="built_in">memcpy</span>(lpBase, &amp;info6, <span class="built_in"><span class="keyword">sizeof</span></span>(info));</span><br><span class="line">    <span class="built_in">ReleaseSemaphore</span>(hSemaphore, <span class="number">1</span>, <span class="literal">NULL</span>);</span><br><span class="line">    info6.Num = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">OldCloseHandle</span>(hObject);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="title">HANDLE</span><span class="params">(WINAPI* OldHeapCreate)</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">    DWORD  flOptions,</span></span></span><br><span class="line"><span class="function"><span class="params">    SIZE_T dwInitialSize,<span class="comment">//创建堆块的大小</span></span></span></span><br><span class="line"><span class="function"><span class="params">    SIZE_T dwMaximumSize</span></span></span><br><span class="line"><span class="function"><span class="params">    )</span> </span>= HeapCreate;<span class="comment">//返回创建的堆块的句柄</span></span><br><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span> __declspec(dllexport)<span class="function">HANDLE WINAPI <span class="title">NewHeapCreate</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">    DWORD  flOptions,</span></span></span><br><span class="line"><span class="function"><span class="params">    SIZE_T dwInitialSize,</span></span></span><br><span class="line"><span class="function"><span class="params">    SIZE_T dwMaximumSize</span></span></span><br><span class="line"><span class="function"><span class="params">)</span> </span>&#123;</span><br><span class="line">    info info7;</span><br><span class="line">    HANDLE hd = <span class="built_in">OldHeapCreate</span>(flOptions, dwInitialSize, dwMaximumSize);</span><br><span class="line">    heaphandle.<span class="built_in">insert</span>(hd);</span><br><span class="line">    info7.Num = <span class="number">4</span>;</span><br><span class="line">    info7.type = HEAPCREATE;</span><br><span class="line">    <span class="built_in">GetLocalTime</span>(&amp;(info7.st));</span><br><span class="line">    <span class="comment">//参数名称和键值以及返回句柄</span></span><br><span class="line">    <span class="built_in">sprintf</span>(info7.Name[<span class="number">0</span>], <span class="string">&quot;flOptions&quot;</span>);</span><br><span class="line">    <span class="built_in">sprintf</span>(info7.Value[<span class="number">0</span>], <span class="string">&quot;%08X&quot;</span>, flOptions);</span><br><span class="line">    <span class="built_in">sprintf</span>(info7.Name[<span class="number">1</span>], <span class="string">&quot;dwInitialSize&quot;</span>);</span><br><span class="line">    <span class="built_in">sprintf</span>(info7.Value[<span class="number">1</span>], <span class="string">&quot;%08X&quot;</span>, dwInitialSize);</span><br><span class="line">    <span class="built_in">sprintf</span>(info7.Name[<span class="number">2</span>], <span class="string">&quot;dwMaximumSize&quot;</span>);</span><br><span class="line">    <span class="built_in">sprintf</span>(info7.Value[<span class="number">2</span>], <span class="string">&quot;%08X&quot;</span>, dwMaximumSize);</span><br><span class="line">    <span class="built_in">sprintf</span>(info7.Name[<span class="number">3</span>], <span class="string">&quot;返回句柄&quot;</span>);</span><br><span class="line">    <span class="built_in">sprintf</span>(info7.Value[<span class="number">3</span>], <span class="string">&quot;%08X&quot;</span>, hd);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">memcpy</span>(lpBase, &amp;info7, <span class="built_in"><span class="keyword">sizeof</span></span>(info));</span><br><span class="line">    <span class="built_in">ReleaseSemaphore</span>(hSemaphore, <span class="number">1</span>, <span class="literal">NULL</span>);</span><br><span class="line">    info7.Num = <span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> hd;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="title">BOOL</span><span class="params">(WINAPI* OldHeapDestroy)</span><span class="params">(HANDLE hHeap)</span> </span>= HeapDestroy;<span class="comment">//根据堆块句柄销毁堆块</span></span><br><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span> __declspec(dllexport)<span class="function">BOOL WINAPI <span class="title">NewHeapDestroy</span><span class="params">(HANDLE hHeap)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    heaphandle.<span class="built_in">erase</span>(heaphandle.<span class="built_in">find</span>(hHeap));</span><br><span class="line">    info info8;</span><br><span class="line">    info8.type = HEAPDESTROY;</span><br><span class="line">    info8.Num = <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">GetLocalTime</span>(&amp;(info8.st));</span><br><span class="line">    <span class="comment">//参数</span></span><br><span class="line">    <span class="built_in">sprintf</span>(info8.Name[<span class="number">0</span>], <span class="string">&quot;hHeap(堆句柄)&quot;</span>);</span><br><span class="line">    <span class="built_in">sprintf</span>(info8.Value[<span class="number">0</span>], <span class="string">&quot;%08X&quot;</span>, hHeap);</span><br><span class="line">    <span class="built_in">memcpy</span>(lpBase, &amp;info8, <span class="built_in"><span class="keyword">sizeof</span></span>(info));</span><br><span class="line">    <span class="built_in">ReleaseSemaphore</span>(hSemaphore, <span class="number">1</span>, <span class="literal">NULL</span>);</span><br><span class="line">    info8.Num = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">OldHeapDestroy</span>(hHeap);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="title">BOOL</span><span class="params">(WINAPI* OldHeapFree)</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">    HANDLE hHeap,<span class="comment">//堆块句柄</span></span></span></span><br><span class="line"><span class="function"><span class="params">    DWORD dwFlags,</span></span></span><br><span class="line"><span class="function"><span class="params">    LPVOID lpMem<span class="comment">//释放的内存块的首地址（指针）</span></span></span></span><br><span class="line"><span class="function"><span class="params">    )</span> </span>= HeapFree;</span><br><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span> __declspec(dllexport)<span class="function">BOOL WINAPI <span class="title">NewHeapFree</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">    HANDLE hHeap,</span></span></span><br><span class="line"><span class="function"><span class="params">    DWORD dwFlags,</span></span></span><br><span class="line"><span class="function"><span class="params">    LPVOID lpMem</span></span></span><br><span class="line"><span class="function"><span class="params">)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (heaphandle.<span class="built_in">find</span>(hHeap) != heaphandle.<span class="built_in">end</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        info info9;</span><br><span class="line">        info9.Num = <span class="number">3</span>;</span><br><span class="line">        info9.type = HEAPFREE;</span><br><span class="line">        <span class="built_in">GetLocalTime</span>(&amp;(info9.st));</span><br><span class="line">        <span class="comment">//参数</span></span><br><span class="line">        <span class="built_in">sprintf</span>(info9.Name[<span class="number">0</span>], <span class="string">&quot;hHeap(句柄)&quot;</span>);</span><br><span class="line">        <span class="built_in">sprintf</span>(info9.Value[<span class="number">0</span>], <span class="string">&quot;%08X&quot;</span>, hHeap);</span><br><span class="line">        <span class="built_in">sprintf</span>(info9.Name[<span class="number">1</span>], <span class="string">&quot;dwFlags(堆释放选项)&quot;</span>);</span><br><span class="line">        <span class="built_in">sprintf</span>(info9.Value[<span class="number">1</span>], <span class="string">&quot;%08X&quot;</span>, dwFlags);</span><br><span class="line">        <span class="built_in">sprintf</span>(info9.Name[<span class="number">2</span>], <span class="string">&quot;lpMem(要释放的内存块指针)&quot;</span>);</span><br><span class="line">        <span class="built_in">sprintf</span>(info9.Value[<span class="number">2</span>], <span class="string">&quot;%08X&quot;</span>, lpMem);</span><br><span class="line">        <span class="keyword">int</span> handle = <span class="built_in">strtoul</span>(info9.Value[<span class="number">0</span>], <span class="literal">NULL</span>, <span class="number">16</span>);</span><br><span class="line">        <span class="built_in">memcpy</span>(lpBase, &amp;info9, <span class="built_in"><span class="keyword">sizeof</span></span>(info));</span><br><span class="line">        <span class="built_in">ReleaseSemaphore</span>(hSemaphore, <span class="number">1</span>, <span class="literal">NULL</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//info9.Num = 0;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">OldHeapFree</span>(hHeap, dwFlags, lpMem);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="title">LPVOID</span><span class="params">(WINAPI* OldHeapAlloc)</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">    HANDLE hHeap,<span class="comment">//堆块句柄</span></span></span></span><br><span class="line"><span class="function"><span class="params">    DWORD dwFlags,</span></span></span><br><span class="line"><span class="function"><span class="params">    SIZE_T dwBytes<span class="comment">//申请的内存块大小</span></span></span></span><br><span class="line"><span class="function"><span class="params">    )</span> </span>= HeapAlloc;<span class="comment">//返回申请的内存块地址</span></span><br><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span> __declspec(dllexport) <span class="function">LPVOID WINAPI <span class="title">NewHeapAlloc</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">    HANDLE hHeap,</span></span></span><br><span class="line"><span class="function"><span class="params">    DWORD dwFlags,</span></span></span><br><span class="line"><span class="function"><span class="params">    SIZE_T dwBytes</span></span></span><br><span class="line"><span class="function"><span class="params">)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span>* lpmem = (<span class="keyword">char</span>*)<span class="built_in">OldHeapAlloc</span>(hHeap, dwFlags, dwBytes);</span><br><span class="line">    <span class="keyword">if</span> (heaphandle.<span class="built_in">find</span>(hHeap) != heaphandle.<span class="built_in">end</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        info info10;   </span><br><span class="line">        info10.type = HEAPALLOC;</span><br><span class="line">        info10.Num = <span class="number">4</span>;</span><br><span class="line">        <span class="built_in">GetLocalTime</span>(&amp;(info10.st));</span><br><span class="line">        <span class="comment">//参数</span></span><br><span class="line">        <span class="built_in">sprintf</span>(info10.Name[<span class="number">0</span>], <span class="string">&quot;hHeap(句柄)&quot;</span>);</span><br><span class="line">        <span class="built_in">sprintf</span>(info10.Value[<span class="number">0</span>], <span class="string">&quot;%08X&quot;</span>, hHeap);</span><br><span class="line">        <span class="built_in">sprintf</span>(info10.Name[<span class="number">1</span>], <span class="string">&quot;dwFlags&quot;</span>);</span><br><span class="line">        <span class="built_in">sprintf</span>(info10.Value[<span class="number">1</span>], <span class="string">&quot;%08X&quot;</span>, dwFlags);</span><br><span class="line">        <span class="built_in">sprintf</span>(info10.Name[<span class="number">2</span>], <span class="string">&quot;dwBytes(分配字节数)&quot;</span>);</span><br><span class="line">        <span class="built_in">sprintf</span>(info10.Value[<span class="number">2</span>], <span class="string">&quot;%08X&quot;</span>, dwBytes);</span><br><span class="line">        <span class="built_in">sprintf</span>(info10.Name[<span class="number">3</span>], <span class="string">&quot;内存块首地址&quot;</span>);</span><br><span class="line">        <span class="built_in">sprintf</span>(info10.Value[<span class="number">3</span>], <span class="string">&quot;%08X&quot;</span>, lpmem);</span><br><span class="line">        <span class="comment">/*int handle = strtoul(info10.Value[0], NULL, 16);</span></span><br><span class="line"><span class="comment">        if (heaphandle.find(handle) != heaphandle.end())</span></span><br><span class="line"><span class="comment">        &#123;*/</span></span><br><span class="line">        <span class="built_in">memcpy</span>(lpBase, &amp;info10, <span class="built_in"><span class="keyword">sizeof</span></span>(info));</span><br><span class="line">        <span class="built_in">ReleaseSemaphore</span>(hSemaphore, <span class="number">1</span>, <span class="literal">NULL</span>);</span><br><span class="line">        info10.Num = <span class="number">0</span>;</span><br><span class="line">        <span class="comment">/* &#125;*/</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> lpmem;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="title">LONG</span><span class="params">(WINAPI* OldRegCreateKeyEx)</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">    HKEY hKey,                                  <span class="comment">// handle to open key</span></span></span></span><br><span class="line"><span class="function"><span class="params">    LPCWSTR lpSubKey,                           <span class="comment">// subkey name</span></span></span></span><br><span class="line"><span class="function"><span class="params">    DWORD Reserved,                             <span class="comment">// reserved</span></span></span></span><br><span class="line"><span class="function"><span class="params">    LPWSTR lpClass,                             <span class="comment">// class string</span></span></span></span><br><span class="line"><span class="function"><span class="params">    DWORD dwOptions,                            <span class="comment">// special options</span></span></span></span><br><span class="line"><span class="function"><span class="params">    REGSAM samDesired,                          <span class="comment">// desired security access</span></span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">const</span> LPSECURITY_ATTRIBUTES lpSecurityAttributes, <span class="comment">// inheritance</span></span></span></span><br><span class="line"><span class="function"><span class="params">    PHKEY phkResult,                            <span class="comment">// key handle </span></span></span></span><br><span class="line"><span class="function"><span class="params">    LPDWORD lpdwDisposition                     <span class="comment">// disposition value buffer</span></span></span></span><br><span class="line"><span class="function"><span class="params">    )</span> </span>= RegCreateKeyEx;</span><br><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span> __declspec(dllexport) <span class="function">LONG WINAPI <span class="title">NewRegCreateKeyEx</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">    HKEY hKey,                                  <span class="comment">// handle to open key</span></span></span></span><br><span class="line"><span class="function"><span class="params">    LPCWSTR lpSubKey,                           <span class="comment">// subkey name</span></span></span></span><br><span class="line"><span class="function"><span class="params">    DWORD Reserved,                             <span class="comment">// reserved</span></span></span></span><br><span class="line"><span class="function"><span class="params">    LPWSTR lpClass,                             <span class="comment">// class string</span></span></span></span><br><span class="line"><span class="function"><span class="params">    DWORD dwOptions,                            <span class="comment">// special options</span></span></span></span><br><span class="line"><span class="function"><span class="params">    REGSAM samDesired,                          <span class="comment">// desired security access</span></span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">const</span> LPSECURITY_ATTRIBUTES lpSecurityAttributes, <span class="comment">// inheritance</span></span></span></span><br><span class="line"><span class="function"><span class="params">    PHKEY phkResult,                            <span class="comment">// key handle </span></span></span></span><br><span class="line"><span class="function"><span class="params">    LPDWORD lpdwDisposition                     <span class="comment">// disposition value buffer</span></span></span></span><br><span class="line"><span class="function"><span class="params">)</span></span>&#123;</span><br><span class="line">    info info11;</span><br><span class="line">    info11.type = REGCREATEKEYEX;</span><br><span class="line">    info11.Num = <span class="number">9</span>;</span><br><span class="line">    <span class="built_in">GetLocalTime</span>(&amp;(info11.st));</span><br><span class="line">    <span class="comment">//参数名称</span></span><br><span class="line">    <span class="built_in">sprintf</span>(info11.Name[<span class="number">0</span>], <span class="string">&quot;hKey&quot;</span>);</span><br><span class="line">    <span class="built_in">sprintf</span>(info11.Name[<span class="number">1</span>], <span class="string">&quot;lpSubKey&quot;</span>);</span><br><span class="line">    <span class="built_in">sprintf</span>(info11.Name[<span class="number">2</span>], <span class="string">&quot;Reserved&quot;</span>);</span><br><span class="line">    <span class="built_in">sprintf</span>(info11.Name[<span class="number">3</span>], <span class="string">&quot;lpClass&quot;</span>);</span><br><span class="line">    <span class="built_in">sprintf</span>(info11.Name[<span class="number">4</span>], <span class="string">&quot;dwOptions&quot;</span>);</span><br><span class="line">    <span class="built_in">sprintf</span>(info11.Name[<span class="number">5</span>], <span class="string">&quot;samDesired&quot;</span>);</span><br><span class="line">    <span class="built_in">sprintf</span>(info11.Name[<span class="number">6</span>], <span class="string">&quot;lpSecurityAttributes&quot;</span>);</span><br><span class="line">    <span class="built_in">sprintf</span>(info11.Name[<span class="number">7</span>], <span class="string">&quot;phkResult&quot;</span>);</span><br><span class="line">    <span class="built_in">sprintf</span>(info11.Name[<span class="number">8</span>], <span class="string">&quot;lpdwDisposition&quot;</span>);</span><br><span class="line">    <span class="comment">//参数键值</span></span><br><span class="line">    <span class="keyword">char</span> temp[<span class="number">70</span>];</span><br><span class="line">    <span class="built_in">sprintf</span>(info11.Value[<span class="number">0</span>], <span class="string">&quot;%08X&quot;</span>, hKey);</span><br><span class="line">    <span class="comment">// 宽字节转char</span></span><br><span class="line">    <span class="built_in">memset</span>(temp, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(temp));</span><br><span class="line">    <span class="built_in">WideCharToMultiByte</span>(CP_ACP, <span class="number">0</span>, lpSubKey, <span class="built_in">wcslen</span>(lpSubKey), temp, <span class="built_in"><span class="keyword">sizeof</span></span>(temp), <span class="literal">NULL</span>, <span class="literal">NULL</span>);</span><br><span class="line">    <span class="built_in">strcpy</span>(info11.Value[<span class="number">1</span>], temp);</span><br><span class="line">    <span class="built_in">sprintf</span>(info11.Value[<span class="number">2</span>], <span class="string">&quot;%08X&quot;</span>, Reserved);</span><br><span class="line">    <span class="built_in">sprintf</span>(info11.Value[<span class="number">3</span>], <span class="string">&quot;%08X&quot;</span>, lpClass);</span><br><span class="line">    <span class="built_in">sprintf</span>(info11.Value[<span class="number">4</span>], <span class="string">&quot;%08X&quot;</span>, dwOptions);</span><br><span class="line">    <span class="built_in">sprintf</span>(info11.Value[<span class="number">5</span>], <span class="string">&quot;%08X&quot;</span>, samDesired);</span><br><span class="line">    <span class="built_in">sprintf</span>(info11.Value[<span class="number">6</span>], <span class="string">&quot;%08X&quot;</span>, lpSecurityAttributes);</span><br><span class="line">    <span class="built_in">sprintf</span>(info11.Value[<span class="number">7</span>], <span class="string">&quot;%08X&quot;</span>, phkResult);</span><br><span class="line">    <span class="built_in">sprintf</span>(info11.Value[<span class="number">8</span>], <span class="string">&quot;%08X&quot;</span>, lpdwDisposition);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">memcpy</span>(lpBase, &amp;info11, <span class="built_in"><span class="keyword">sizeof</span></span>(info));</span><br><span class="line">    <span class="built_in">ReleaseSemaphore</span>(hSemaphore, <span class="number">1</span>, <span class="literal">NULL</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">OldRegCreateKeyEx</span>(hKey, lpSubKey, Reserved, lpClass, dwOptions, samDesired, lpSecurityAttributes, phkResult, lpdwDisposition);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="title">LONG</span><span class="params">(WINAPI* OldRegSetValueEx)</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">    HKEY       hKey,</span></span></span><br><span class="line"><span class="function"><span class="params">    LPCWSTR    lpValueName,</span></span></span><br><span class="line"><span class="function"><span class="params">    DWORD      Reserved,</span></span></span><br><span class="line"><span class="function"><span class="params">    DWORD      dwType,</span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">const</span> BYTE* lpData,</span></span></span><br><span class="line"><span class="function"><span class="params">    DWORD      cbData)</span> </span>= RegSetValueEx;</span><br><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span> __declspec(dllexport)<span class="function">LSTATUS WINAPI <span class="title">NewRegSetValueEx</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">    HKEY       hKey,</span></span></span><br><span class="line"><span class="function"><span class="params">    LPCWSTR    lpValueName,</span></span></span><br><span class="line"><span class="function"><span class="params">    DWORD      Reserved,</span></span></span><br><span class="line"><span class="function"><span class="params">    DWORD      dwType,</span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">const</span> BYTE * lpData,</span></span></span><br><span class="line"><span class="function"><span class="params">    DWORD      cbData)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> temp[<span class="number">70</span>];</span><br><span class="line">    info info12;</span><br><span class="line">    info12.Num = <span class="number">6</span>;</span><br><span class="line">    <span class="comment">// 参数名</span></span><br><span class="line">    <span class="built_in">sprintf</span>(info12.Name[<span class="number">0</span>], <span class="string">&quot;hKey&quot;</span>);</span><br><span class="line">    <span class="built_in">sprintf</span>(info12.Name[<span class="number">1</span>], <span class="string">&quot;lpValueName&quot;</span>);</span><br><span class="line">    <span class="built_in">sprintf</span>(info12.Name[<span class="number">2</span>], <span class="string">&quot;Reserved&quot;</span>);</span><br><span class="line">    <span class="built_in">sprintf</span>(info12.Name[<span class="number">3</span>], <span class="string">&quot;dwType&quot;</span>);</span><br><span class="line">    <span class="built_in">sprintf</span>(info12.Name[<span class="number">4</span>], <span class="string">&quot;lpData&quot;</span>);</span><br><span class="line">    <span class="built_in">sprintf</span>(info12.Name[<span class="number">5</span>], <span class="string">&quot;cbData&quot;</span>);</span><br><span class="line">    <span class="comment">// 参数值</span></span><br><span class="line">    <span class="built_in">sprintf</span>(info12.Value[<span class="number">0</span>], <span class="string">&quot;%08X&quot;</span>, hKey);</span><br><span class="line">    <span class="comment">// 宽字节转char</span></span><br><span class="line">    <span class="built_in">memset</span>(temp, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(temp));</span><br><span class="line">    <span class="built_in">WideCharToMultiByte</span>(CP_ACP, <span class="number">0</span>, lpValueName, <span class="built_in">wcslen</span>(lpValueName), temp, <span class="built_in"><span class="keyword">sizeof</span></span>(temp), <span class="literal">NULL</span>, <span class="literal">NULL</span>);</span><br><span class="line">    <span class="built_in">strcpy</span>(info12.Value[<span class="number">1</span>], temp);</span><br><span class="line">    <span class="built_in">sprintf</span>(info12.Value[<span class="number">2</span>], <span class="string">&quot;%08X&quot;</span>, Reserved);</span><br><span class="line">    <span class="built_in">sprintf</span>(info12.Value[<span class="number">3</span>], <span class="string">&quot;%08X&quot;</span>, dwType);</span><br><span class="line">    <span class="built_in">memset</span>(temp, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(temp));</span><br><span class="line">    <span class="built_in">WideCharToMultiByte</span>(CP_ACP, <span class="number">0</span>, (LPCWCH)lpData, <span class="built_in">wcslen</span>((LPCWCH)lpData), temp, <span class="built_in"><span class="keyword">sizeof</span></span>(temp), <span class="literal">NULL</span>, <span class="literal">NULL</span>);</span><br><span class="line">    <span class="built_in">strcpy</span>(info12.Value[<span class="number">4</span>], temp);</span><br><span class="line">    <span class="built_in">sprintf</span>(info12.Value[<span class="number">5</span>], <span class="string">&quot;%08X&quot;</span>, cbData);</span><br><span class="line">    info12.type = REGSETVALUEEX;</span><br><span class="line">    <span class="built_in">GetLocalTime</span>(&amp;(info12.st));</span><br><span class="line">    <span class="built_in">memcpy</span>(lpBase, &amp;info12, <span class="built_in"><span class="keyword">sizeof</span></span>(info));</span><br><span class="line">    <span class="built_in">ReleaseSemaphore</span>(hSemaphore, <span class="number">1</span>, <span class="literal">NULL</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">OldRegSetValueEx</span>(hKey, lpValueName, Reserved, dwType, lpData, cbData);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="title">LSTATUS</span><span class="params">(WINAPI* OldRegCloseKey)</span><span class="params">(HKEY hKey)</span> </span>= RegCloseKey;</span><br><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span> __declspec(dllexport)<span class="function">LSTATUS WINAPI <span class="title">NewRegCloseKey</span><span class="params">(HKEY hKey)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    info info13;</span><br><span class="line">    info13.Num = <span class="number">1</span>;</span><br><span class="line">    <span class="comment">// 参数名</span></span><br><span class="line">    <span class="built_in">sprintf</span>(info13.Name[<span class="number">0</span>], <span class="string">&quot;hKey&quot;</span>);</span><br><span class="line">    <span class="comment">// 参数值</span></span><br><span class="line">    <span class="built_in">sprintf</span>(info13.Value[<span class="number">0</span>], <span class="string">&quot;%08X&quot;</span>, hKey);</span><br><span class="line">    info13.type = REGCLOSEKEY;</span><br><span class="line">    <span class="built_in">GetLocalTime</span>(&amp;(info13.st));</span><br><span class="line">    <span class="built_in">memcpy</span>(lpBase, &amp;info13, <span class="built_in"><span class="keyword">sizeof</span></span>(info));</span><br><span class="line">    <span class="built_in">ReleaseSemaphore</span>(hSemaphore, <span class="number">1</span>, <span class="literal">NULL</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">OldRegCloseKey</span>(hKey);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="title">LSTATUS</span><span class="params">(WINAPI* OldRegOpenKeyEx)</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">    HKEY    hKey,</span></span></span><br><span class="line"><span class="function"><span class="params">    LPCWSTR lpSubKey,</span></span></span><br><span class="line"><span class="function"><span class="params">    DWORD   ulOptions,</span></span></span><br><span class="line"><span class="function"><span class="params">    REGSAM  samDesired,</span></span></span><br><span class="line"><span class="function"><span class="params">    PHKEY   phkResult</span></span></span><br><span class="line"><span class="function"><span class="params">    )</span> </span>= RegOpenKeyEx;</span><br><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span> __declspec(dllexport)<span class="function">LSTATUS WINAPI <span class="title">NewRegOpenKeyEx</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">    HKEY    hKey,</span></span></span><br><span class="line"><span class="function"><span class="params">    LPCWSTR lpSubKey,</span></span></span><br><span class="line"><span class="function"><span class="params">    DWORD   ulOptions,</span></span></span><br><span class="line"><span class="function"><span class="params">    REGSAM  samDesired,</span></span></span><br><span class="line"><span class="function"><span class="params">    PHKEY   phkResult)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> temp[<span class="number">70</span>];</span><br><span class="line">    info info14;</span><br><span class="line">    info14.Num = <span class="number">5</span>;</span><br><span class="line">    <span class="comment">// 参数名</span></span><br><span class="line">    <span class="built_in">sprintf</span>(info14.Name[<span class="number">0</span>], <span class="string">&quot;hKey&quot;</span>);</span><br><span class="line">    <span class="built_in">sprintf</span>(info14.Name[<span class="number">1</span>], <span class="string">&quot;lpSubKey&quot;</span>);</span><br><span class="line">    <span class="built_in">sprintf</span>(info14.Name[<span class="number">2</span>], <span class="string">&quot;ulOptions&quot;</span>);</span><br><span class="line">    <span class="built_in">sprintf</span>(info14.Name[<span class="number">3</span>], <span class="string">&quot;samDesired&quot;</span>);</span><br><span class="line">    <span class="built_in">sprintf</span>(info14.Name[<span class="number">4</span>], <span class="string">&quot;phkResult&quot;</span>);</span><br><span class="line">    <span class="comment">// 参数值</span></span><br><span class="line">    <span class="built_in">sprintf</span>(info14.Value[<span class="number">0</span>], <span class="string">&quot;%08X&quot;</span>, hKey);</span><br><span class="line">    <span class="comment">// 宽字节转char</span></span><br><span class="line">    <span class="built_in">memset</span>(temp, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(temp));</span><br><span class="line">    <span class="built_in">WideCharToMultiByte</span>(CP_ACP, <span class="number">0</span>, lpSubKey, <span class="built_in">wcslen</span>(lpSubKey), temp, <span class="built_in"><span class="keyword">sizeof</span></span>(temp), <span class="literal">NULL</span>, <span class="literal">NULL</span>);</span><br><span class="line">    <span class="built_in">strcpy</span>(info14.Value[<span class="number">1</span>], temp);</span><br><span class="line">    <span class="built_in">sprintf</span>(info14.Value[<span class="number">2</span>], <span class="string">&quot;%08X&quot;</span>, ulOptions);</span><br><span class="line">    <span class="built_in">sprintf</span>(info14.Value[<span class="number">3</span>], <span class="string">&quot;%08X&quot;</span>, samDesired);</span><br><span class="line">    <span class="built_in">sprintf</span>(info14.Value[<span class="number">4</span>], <span class="string">&quot;%08X&quot;</span>, phkResult);</span><br><span class="line"></span><br><span class="line">    info14.type = REGOPENKEYEX;</span><br><span class="line">    <span class="built_in">GetLocalTime</span>(&amp;(info14.st));</span><br><span class="line">    <span class="built_in">memcpy</span>(lpBase, &amp;info14, <span class="built_in"><span class="keyword">sizeof</span></span>(info));</span><br><span class="line">    <span class="built_in">ReleaseSemaphore</span>(hSemaphore, <span class="number">1</span>, <span class="literal">NULL</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">OldRegOpenKeyEx</span>(hKey, lpSubKey, ulOptions, samDesired, phkResult);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="title">LSTATUS</span><span class="params">(WINAPI* OldRegDeleteValue)</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">    HKEY    hKey,</span></span></span><br><span class="line"><span class="function"><span class="params">    LPCWSTR lpValueName</span></span></span><br><span class="line"><span class="function"><span class="params">    )</span> </span>= RegDeleteValue;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span> __declspec(dllexport)<span class="function">LSTATUS WINAPI <span class="title">NewRegDeleteValue</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">    HKEY    hKey,</span></span></span><br><span class="line"><span class="function"><span class="params">    LPCWSTR lpValueName)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> temp[<span class="number">70</span>];</span><br><span class="line">    info info15;</span><br><span class="line">    info15.Num = <span class="number">2</span>;</span><br><span class="line">    <span class="comment">// 参数名</span></span><br><span class="line">    <span class="built_in">sprintf</span>(info15.Name[<span class="number">0</span>], <span class="string">&quot;hKey&quot;</span>);</span><br><span class="line">    <span class="built_in">sprintf</span>(info15.Name[<span class="number">1</span>], <span class="string">&quot;lpValueName&quot;</span>);</span><br><span class="line">    <span class="comment">// 参数值</span></span><br><span class="line">    <span class="built_in">sprintf</span>(info15.Value[<span class="number">0</span>], <span class="string">&quot;%08X&quot;</span>, hKey);</span><br><span class="line">    <span class="comment">// 宽字节转char</span></span><br><span class="line">    <span class="built_in">memset</span>(temp, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(temp));</span><br><span class="line">    <span class="built_in">WideCharToMultiByte</span>(CP_ACP, <span class="number">0</span>, lpValueName, <span class="built_in">wcslen</span>(lpValueName), temp, <span class="built_in"><span class="keyword">sizeof</span></span>(temp), <span class="literal">NULL</span>, <span class="literal">NULL</span>);</span><br><span class="line">    <span class="built_in">strcpy</span>(info15.Value[<span class="number">1</span>], temp);</span><br><span class="line">    info15.type = REGDELETEVALUE;</span><br><span class="line">    <span class="built_in">GetLocalTime</span>(&amp;(info15.st));</span><br><span class="line">    <span class="built_in">memcpy</span>(lpBase, &amp;info15, <span class="built_in"><span class="keyword">sizeof</span></span>(info));</span><br><span class="line">    <span class="built_in">ReleaseSemaphore</span>(hSemaphore, <span class="number">1</span>, <span class="literal">NULL</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">OldRegDeleteValue</span>(hKey, lpValueName);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="title">SOCKET</span> <span class="params">(WINAPI* Oldsocket)</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">int</span> af,</span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">int</span> type,</span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">int</span> protocol</span></span></span><br><span class="line"><span class="function"><span class="params">    )</span> </span>= socket;</span><br><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span> __declspec(dllexport)<span class="function">SOCKET WINAPI <span class="title">Newsocket</span><span class="params">(<span class="keyword">int</span> af, <span class="keyword">int</span> type, <span class="keyword">int</span> protocol)</span> </span>&#123;</span><br><span class="line">    info info16;</span><br><span class="line">    info16.Num = <span class="number">3</span>;</span><br><span class="line">    <span class="comment">// 参数名</span></span><br><span class="line">    <span class="built_in">sprintf</span>(info16.Name[<span class="number">0</span>], <span class="string">&quot;af&quot;</span>);</span><br><span class="line">    <span class="built_in">sprintf</span>(info16.Name[<span class="number">1</span>], <span class="string">&quot;type&quot;</span>);</span><br><span class="line">    <span class="built_in">sprintf</span>(info16.Name[<span class="number">2</span>], <span class="string">&quot;protocol&quot;</span>);</span><br><span class="line">    <span class="comment">// 参数值</span></span><br><span class="line">    <span class="built_in">sprintf</span>(info16.Value[<span class="number">0</span>], <span class="string">&quot;%08X&quot;</span>, af);</span><br><span class="line">    <span class="built_in">sprintf</span>(info16.Value[<span class="number">1</span>], <span class="string">&quot;%08X&quot;</span>, type);</span><br><span class="line">    <span class="built_in">sprintf</span>(info16.Value[<span class="number">2</span>], <span class="string">&quot;%08X&quot;</span>, protocol);</span><br><span class="line">    info16.type = THESOCKET;</span><br><span class="line">    <span class="built_in">GetLocalTime</span>(&amp;(info16.st));</span><br><span class="line">    <span class="built_in">memcpy</span>(lpBase, &amp;info16, <span class="built_in"><span class="keyword">sizeof</span></span>(info));</span><br><span class="line">    <span class="built_in">ReleaseSemaphore</span>(hSemaphore, <span class="number">1</span>, <span class="literal">NULL</span>);</span><br><span class="line">    info16.Num = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Oldsocket</span>(af, type, protocol);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="title">int</span> <span class="params">(WINAPI* Oldbind)</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">    SOCKET         s,</span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">const</span> sockaddr* name,</span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">int</span>            namelen</span></span></span><br><span class="line"><span class="function"><span class="params">    )</span> </span>= bind;</span><br><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span> __declspec(dllexport)<span class="function"><span class="keyword">int</span> WINAPI <span class="title">Newbind</span><span class="params">(SOCKET s, <span class="keyword">const</span> sockaddr * name, <span class="keyword">int</span> namelen)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//name-&gt;sa_data</span></span><br><span class="line">    info info17;</span><br><span class="line">    info17.Num = <span class="number">5</span>;</span><br><span class="line">    <span class="comment">// 参数名</span></span><br><span class="line">    <span class="built_in">sprintf</span>(info17.Name[<span class="number">0</span>], <span class="string">&quot;s&quot;</span>);</span><br><span class="line">    <span class="built_in">sprintf</span>(info17.Name[<span class="number">1</span>], <span class="string">&quot;name&quot;</span>);</span><br><span class="line">    <span class="built_in">sprintf</span>(info17.Name[<span class="number">2</span>], <span class="string">&quot;namelen&quot;</span>);</span><br><span class="line">    <span class="built_in">sprintf</span>(info17.Name[<span class="number">3</span>], <span class="string">&quot;IP&quot;</span>);</span><br><span class="line">    <span class="built_in">sprintf</span>(info17.Name[<span class="number">4</span>], <span class="string">&quot;port&quot;</span>);</span><br><span class="line">    <span class="comment">// 参数值</span></span><br><span class="line">    <span class="built_in">sprintf</span>(info17.Value[<span class="number">0</span>], <span class="string">&quot;%08X&quot;</span>, s);</span><br><span class="line">    <span class="built_in">sprintf</span>(info17.Value[<span class="number">1</span>], <span class="string">&quot;%08X&quot;</span>, name);</span><br><span class="line">    <span class="built_in">sprintf</span>(info17.Value[<span class="number">2</span>], <span class="string">&quot;%08X&quot;</span>, namelen);</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span>* <span class="title">sock</span> =</span> (struct sockaddr_in*)name;</span><br><span class="line">    <span class="keyword">int</span> port = <span class="built_in">ntohs</span>(sock-&gt;sin_port);</span><br><span class="line">    <span class="built_in">sprintf</span>(info17.Value[<span class="number">3</span>], <span class="string">&quot;%s&quot;</span>, <span class="built_in">inet_ntoa</span>(sock-&gt;sin_addr));</span><br><span class="line">    <span class="built_in">sprintf</span>(info17.Value[<span class="number">4</span>], <span class="string">&quot;%d&quot;</span>, port);</span><br><span class="line">    info17.type = BIND;</span><br><span class="line">    <span class="built_in">GetLocalTime</span>(&amp;(info17.st));</span><br><span class="line">    <span class="built_in">memcpy</span>(lpBase, &amp;info17, <span class="built_in"><span class="keyword">sizeof</span></span>(info));</span><br><span class="line">    <span class="built_in">ReleaseSemaphore</span>(hSemaphore, <span class="number">1</span>, <span class="literal">NULL</span>);</span><br><span class="line">    info17.Num = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Oldbind</span>(s, name, namelen);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="title">int</span> <span class="params">(WINAPI* Oldsend)</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">    SOCKET     s,</span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">const</span> <span class="keyword">char</span>* buf,</span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">int</span>        len,</span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">int</span>        flags</span></span></span><br><span class="line"><span class="function"><span class="params">    )</span> </span>= send;</span><br><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span> __declspec(dllexport)<span class="function"><span class="keyword">int</span> WINAPI <span class="title">Newsend</span><span class="params">(SOCKET s, <span class="keyword">const</span> <span class="keyword">char</span>* buf, <span class="keyword">int</span> len, <span class="keyword">int</span> flags)</span> </span>&#123;</span><br><span class="line">    info info18;</span><br><span class="line">    info18.Num = <span class="number">5</span>;</span><br><span class="line">    <span class="comment">// 参数名</span></span><br><span class="line">    <span class="built_in">sprintf</span>(info18.Name[<span class="number">0</span>], <span class="string">&quot;s&quot;</span>);</span><br><span class="line">    <span class="built_in">sprintf</span>(info18.Name[<span class="number">1</span>], <span class="string">&quot;buf&quot;</span>);</span><br><span class="line">    <span class="built_in">sprintf</span>(info18.Name[<span class="number">2</span>], <span class="string">&quot;len&quot;</span>);</span><br><span class="line">    <span class="built_in">sprintf</span>(info18.Name[<span class="number">3</span>], <span class="string">&quot;flags&quot;</span>);</span><br><span class="line">    <span class="built_in">sprintf</span>(info18.Name[<span class="number">4</span>], <span class="string">&quot;发送数据&quot;</span>);</span><br><span class="line">    <span class="comment">// 参数值</span></span><br><span class="line">    <span class="built_in">sprintf</span>(info18.Value[<span class="number">0</span>], <span class="string">&quot;%08X&quot;</span>, s);</span><br><span class="line">    <span class="built_in">sprintf</span>(info18.Value[<span class="number">1</span>], <span class="string">&quot;%08X&quot;</span>, buf);</span><br><span class="line">    <span class="built_in">sprintf</span>(info18.Value[<span class="number">2</span>], <span class="string">&quot;%08X&quot;</span>, len);</span><br><span class="line">    <span class="built_in">sprintf</span>(info18.Value[<span class="number">3</span>], <span class="string">&quot;%08X&quot;</span>, flags);</span><br><span class="line">    <span class="built_in">sprintf</span>(info18.Value[<span class="number">4</span>], <span class="string">&quot;%s&quot;</span>, buf);</span><br><span class="line">    <span class="comment">/*FILE* f = fopen(&quot;test.txt&quot;, &quot;a+&quot;);</span></span><br><span class="line"><span class="comment">    fprintf(f, &quot;发送数据：%s\nsendinfo中：%s&quot;,buf,info18.Value[4]);</span></span><br><span class="line"><span class="comment">    fclose(f);*/</span></span><br><span class="line">    info18.type = SEND;</span><br><span class="line">    <span class="built_in">GetLocalTime</span>(&amp;(info18.st));</span><br><span class="line">    <span class="built_in">memcpy</span>(lpBase, &amp;info18, <span class="built_in"><span class="keyword">sizeof</span></span>(info));</span><br><span class="line">    <span class="built_in">ReleaseSemaphore</span>(hSemaphore, <span class="number">1</span>, <span class="literal">NULL</span>);</span><br><span class="line">    info18.Num = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Oldsend</span>(s, buf, len, flags);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="title">int</span> <span class="params">(WINAPI* Oldconnect)</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">    SOCKET         s,</span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">const</span> sockaddr* name,</span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">int</span>            namelen</span></span></span><br><span class="line"><span class="function"><span class="params">    )</span> </span>= connect;</span><br><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span> __declspec(dllexport)<span class="function"><span class="keyword">int</span> WINAPI <span class="title">Newconnect</span><span class="params">(SOCKET s, <span class="keyword">const</span> sockaddr * name, <span class="keyword">int</span> namelen)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//name-&gt;sa_data</span></span><br><span class="line">    info info19;</span><br><span class="line">    info19.Num = <span class="number">5</span>;</span><br><span class="line">    <span class="comment">// 参数名</span></span><br><span class="line">    <span class="built_in">sprintf</span>(info19.Name[<span class="number">0</span>], <span class="string">&quot;s&quot;</span>);</span><br><span class="line">    <span class="built_in">sprintf</span>(info19.Name[<span class="number">1</span>], <span class="string">&quot;name&quot;</span>);</span><br><span class="line">    <span class="built_in">sprintf</span>(info19.Name[<span class="number">2</span>], <span class="string">&quot;namelen&quot;</span>);</span><br><span class="line">    <span class="built_in">sprintf</span>(info19.Name[<span class="number">3</span>], <span class="string">&quot;IP&quot;</span>);</span><br><span class="line">    <span class="built_in">sprintf</span>(info19.Name[<span class="number">4</span>], <span class="string">&quot;port&quot;</span>);</span><br><span class="line">    <span class="comment">// 参数值</span></span><br><span class="line">    <span class="built_in">sprintf</span>(info19.Value[<span class="number">0</span>], <span class="string">&quot;%08X&quot;</span>, s);</span><br><span class="line">    <span class="built_in">sprintf</span>(info19.Value[<span class="number">1</span>], <span class="string">&quot;%08X&quot;</span>, name);</span><br><span class="line">    <span class="built_in">sprintf</span>(info19.Value[<span class="number">2</span>], <span class="string">&quot;%08X&quot;</span>, namelen);</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span>* <span class="title">sock</span> =</span> (struct sockaddr_in*)name;</span><br><span class="line">    <span class="keyword">int</span> port = <span class="built_in">ntohs</span>(sock-&gt;sin_port);</span><br><span class="line">    <span class="built_in">sprintf</span>(info19.Value[<span class="number">3</span>], <span class="string">&quot;%s&quot;</span>, <span class="built_in">inet_ntoa</span>(sock-&gt;sin_addr));</span><br><span class="line">    <span class="built_in">sprintf</span>(info19.Value[<span class="number">4</span>], <span class="string">&quot;%d&quot;</span>, port);</span><br><span class="line">    info19.type = CONNECT;</span><br><span class="line">    <span class="built_in">GetLocalTime</span>(&amp;(info19.st));</span><br><span class="line">    <span class="built_in">memcpy</span>(lpBase, &amp;info19, <span class="built_in"><span class="keyword">sizeof</span></span>(info));</span><br><span class="line">    <span class="built_in">ReleaseSemaphore</span>(hSemaphore, <span class="number">1</span>, <span class="literal">NULL</span>);</span><br><span class="line">    info19.Num = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Oldconnect</span>(s, name, namelen);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="title">int</span> <span class="params">(WINAPI* Oldrecv)</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">    SOCKET     s,</span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">char</span>* buf,</span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">int</span>        len,</span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">int</span>        flags</span></span></span><br><span class="line"><span class="function"><span class="params">    )</span> </span>= recv;</span><br><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span> __declspec(dllexport)<span class="function"><span class="keyword">int</span> WINAPI <span class="title">Newrecv</span><span class="params">(SOCKET s, <span class="keyword">char</span>* buf, <span class="keyword">int</span> len, <span class="keyword">int</span> flags)</span> </span>&#123;</span><br><span class="line">    info info20;</span><br><span class="line">    info20.Num = <span class="number">5</span>;</span><br><span class="line">    <span class="comment">//截获收到的数据，再将原先存储收到数据的地方赋值</span></span><br><span class="line">    <span class="keyword">char</span> buffer[<span class="number">100</span>];</span><br><span class="line">    <span class="built_in">memset</span>(buffer, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(buffer));</span><br><span class="line">    <span class="keyword">int</span> x=<span class="built_in">Oldrecv</span>(s, buffer, len, flags);</span><br><span class="line">    <span class="built_in">memcpy</span>(buf, buffer, <span class="built_in"><span class="keyword">sizeof</span></span>(buffer));</span><br><span class="line">    <span class="comment">// 参数名</span></span><br><span class="line">    <span class="built_in">sprintf</span>(info20.Name[<span class="number">0</span>], <span class="string">&quot;s&quot;</span>);</span><br><span class="line">    <span class="built_in">sprintf</span>(info20.Name[<span class="number">1</span>], <span class="string">&quot;buf&quot;</span>);</span><br><span class="line">    <span class="built_in">sprintf</span>(info20.Name[<span class="number">2</span>], <span class="string">&quot;len&quot;</span>);</span><br><span class="line">    <span class="built_in">sprintf</span>(info20.Name[<span class="number">3</span>], <span class="string">&quot;flags&quot;</span>);</span><br><span class="line">    <span class="built_in">sprintf</span>(info20.Name[<span class="number">4</span>], <span class="string">&quot;接收数据&quot;</span>);</span><br><span class="line">    <span class="comment">// 参数值</span></span><br><span class="line">    <span class="built_in">sprintf</span>(info20.Value[<span class="number">0</span>], <span class="string">&quot;%08X&quot;</span>, s);</span><br><span class="line">    <span class="built_in">sprintf</span>(info20.Value[<span class="number">1</span>], <span class="string">&quot;%08X&quot;</span>,buf);</span><br><span class="line">    <span class="built_in">sprintf</span>(info20.Value[<span class="number">2</span>], <span class="string">&quot;%08X&quot;</span>, len);</span><br><span class="line">    <span class="built_in">sprintf</span>(info20.Value[<span class="number">3</span>], <span class="string">&quot;%08X&quot;</span>, flags);</span><br><span class="line">    <span class="built_in">sprintf</span>(info20.Value[<span class="number">4</span>], <span class="string">&quot;%s&quot;</span>, buffer);</span><br><span class="line">    info20.type = RECV;</span><br><span class="line">    <span class="built_in">GetLocalTime</span>(&amp;(info20.st));</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*FILE* f = fopen(&quot;test.txt&quot;, &quot;a+&quot;);</span></span><br><span class="line"><span class="comment">    fprintf(f, &quot;接收数据:%s\nsendinfo中：%s&quot;,buf,info20.Value[1]);</span></span><br><span class="line"><span class="comment">    fclose(f);*/</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">memcpy</span>(lpBase, &amp;info20, <span class="built_in"><span class="keyword">sizeof</span></span>(info));</span><br><span class="line">    <span class="built_in">ReleaseSemaphore</span>(hSemaphore, <span class="number">1</span>, <span class="literal">NULL</span>);</span><br><span class="line">    info20.Num = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">//return Oldrecv(s, buf, len, flags);</span></span><br><span class="line">    <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="title">BOOL</span> <span class="params">(WINAPI* OldCopyFileA)</span><span class="params">(LPCSTR lpExistingFileName, LPCSTR lpNewFileName, BOOL bFailIfExists)</span> </span>= CopyFileA;</span><br><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span> __declspec(dllexport)<span class="function">BOOL WINAPI <span class="title">NewCopyFileA</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">    LPCSTR lpExistingFileName,</span></span></span><br><span class="line"><span class="function"><span class="params">    LPCSTR lpNewFileName,</span></span></span><br><span class="line"><span class="function"><span class="params">    BOOL bFailIfExists</span></span></span><br><span class="line"><span class="function"><span class="params">)</span> </span>&#123;</span><br><span class="line">    info info21;</span><br><span class="line">    info21.Num = <span class="number">3</span>;</span><br><span class="line">    info21.type = COPYFILEA;</span><br><span class="line">    <span class="built_in">GetLocalTime</span>(&amp;(info21.st));</span><br><span class="line">    <span class="built_in">sprintf</span>(info21.Name[<span class="number">0</span>], <span class="string">&quot;原文件名&quot;</span>);</span><br><span class="line">    <span class="built_in">sprintf</span>(info21.Name[<span class="number">1</span>], <span class="string">&quot;目的文件名&quot;</span>);</span><br><span class="line">    <span class="built_in">sprintf</span>(info21.Name[<span class="number">2</span>], <span class="string">&quot;bfailIfExists&quot;</span>);</span><br><span class="line">    <span class="built_in">sprintf</span>(info21.Value[<span class="number">0</span>], <span class="string">&quot;%s&quot;</span>, lpExistingFileName);</span><br><span class="line">    <span class="built_in">sprintf</span>(info21.Value[<span class="number">1</span>], <span class="string">&quot;%s&quot;</span>, lpNewFileName);</span><br><span class="line">    <span class="built_in">sprintf</span>(info21.Value[<span class="number">2</span>], <span class="string">&quot;%d&quot;</span>, bFailIfExists);</span><br><span class="line">    <span class="built_in">memcpy</span>(lpBase, &amp;info21, <span class="built_in"><span class="keyword">sizeof</span></span>(info));</span><br><span class="line">    <span class="built_in">ReleaseSemaphore</span>(hSemaphore, <span class="number">1</span>, <span class="literal">NULL</span>);</span><br><span class="line">    info21.Num = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">OldCopyFileA</span>(lpExistingFileName, lpNewFileName, bFailIfExists);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function">BOOL WINAPI <span class="title">DllMain</span><span class="params">( HMODULE hModule,</span></span></span><br><span class="line"><span class="function"><span class="params">                       DWORD  ul_reason_for_call,</span></span></span><br><span class="line"><span class="function"><span class="params">                       LPVOID lpReserved</span></span></span><br><span class="line"><span class="function"><span class="params">                     )</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in"><span class="keyword">switch</span></span> (ul_reason_for_call)</span><br><span class="line">    &#123;</span><br><span class="line">    <span class="keyword">case</span> DLL_PROCESS_ATTACH:</span><br><span class="line">        <span class="built_in">DisableThreadLibraryCalls</span>(hModule);</span><br><span class="line">        <span class="built_in">DetourTransactionBegin</span>();</span><br><span class="line">        <span class="built_in">DetourUpdateThread</span>(<span class="built_in">GetCurrentThread</span>());</span><br><span class="line">        <span class="built_in">DetourAttach</span>(&amp;(PVOID&amp;)OldMessageBoxA, NewMessageBoxA);</span><br><span class="line">        <span class="built_in">DetourAttach</span>(&amp;(PVOID&amp;)OldMessageBoxW, NewMessageBoxW);<span class="comment">//进行链接</span></span><br><span class="line">        <span class="built_in">DetourAttach</span>(&amp;(PVOID&amp;)OldCreateFile, NewCreateFile);</span><br><span class="line">        <span class="built_in">DetourAttach</span>(&amp;(PVOID&amp;)OldWriteFile, NewWriteFile);</span><br><span class="line">        <span class="built_in">DetourAttach</span>(&amp;(PVOID&amp;)OldReadFile, NewReadFile);</span><br><span class="line">        <span class="built_in">DetourAttach</span>(&amp;(PVOID&amp;)OldCloseHandle, NewCloseHandle);</span><br><span class="line">        <span class="built_in">DetourAttach</span>(&amp;(PVOID&amp;)OldHeapCreate, NewHeapCreate);</span><br><span class="line">        <span class="built_in">DetourAttach</span>(&amp;(PVOID&amp;)OldHeapDestroy, NewHeapDestroy);</span><br><span class="line">        <span class="built_in">DetourAttach</span>(&amp;(PVOID&amp;)OldHeapFree, NewHeapFree);</span><br><span class="line">        <span class="built_in">DetourAttach</span>(&amp;(PVOID&amp;)OldHeapAlloc, NewHeapAlloc);</span><br><span class="line">        <span class="built_in">DetourAttach</span>(&amp;(PVOID&amp;)OldRegCreateKeyEx, NewRegCreateKeyEx);</span><br><span class="line">        <span class="built_in">DetourAttach</span>(&amp;(PVOID&amp;)OldRegSetValueEx, NewRegSetValueEx);</span><br><span class="line">        <span class="built_in">DetourAttach</span>(&amp;(PVOID&amp;)OldRegDeleteValue, NewRegDeleteValue);</span><br><span class="line">        <span class="built_in">DetourAttach</span>(&amp;(PVOID&amp;)OldRegCloseKey, NewRegCloseKey);</span><br><span class="line">        <span class="built_in">DetourAttach</span>(&amp;(PVOID&amp;)OldRegOpenKeyEx, NewRegOpenKeyEx);</span><br><span class="line">        <span class="built_in">DetourAttach</span>(&amp;(PVOID&amp;)Oldsocket, Newsocket);</span><br><span class="line">        <span class="built_in">DetourAttach</span>(&amp;(PVOID&amp;)Oldbind, Newbind);</span><br><span class="line">        <span class="built_in">DetourAttach</span>(&amp;(PVOID&amp;)Oldconnect, Newconnect);</span><br><span class="line">        <span class="built_in">DetourAttach</span>(&amp;(PVOID&amp;)Oldsend, Newsend);</span><br><span class="line">        <span class="built_in">DetourAttach</span>(&amp;(PVOID&amp;)Oldrecv, Newrecv);</span><br><span class="line">        <span class="built_in">DetourAttach</span>(&amp;(PVOID&amp;)OldCopyFileA, NewCopyFileA);</span><br><span class="line">        <span class="built_in">DetourTransactionCommit</span>();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> DLL_THREAD_ATTACH:</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> DLL_THREAD_DETACH: </span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> DLL_PROCESS_DETACH:</span><br><span class="line">        <span class="built_in">DetourTransactionBegin</span>();</span><br><span class="line">        <span class="built_in">DetourUpdateThread</span>(<span class="built_in">GetCurrentThread</span>());</span><br><span class="line">        <span class="built_in">DetourDetach</span>(&amp;(PVOID&amp;)OldMessageBoxA, NewMessageBoxA);</span><br><span class="line">        <span class="built_in">DetourDetach</span>(&amp;(PVOID&amp;)OldMessageBoxW, NewMessageBoxW);</span><br><span class="line">        <span class="built_in">DetourDetach</span>(&amp;(PVOID&amp;)OldCreateFile, NewCreateFile);</span><br><span class="line">        <span class="built_in">DetourDetach</span>(&amp;(PVOID&amp;)OldWriteFile, NewWriteFile);</span><br><span class="line">        <span class="built_in">DetourDetach</span>(&amp;(PVOID&amp;)OldReadFile, NewReadFile);</span><br><span class="line">        <span class="built_in">DetourDetach</span>(&amp;(PVOID&amp;)OldCloseHandle, NewCloseHandle);</span><br><span class="line">        <span class="built_in">DetourDetach</span>(&amp;(PVOID&amp;)OldHeapCreate, NewHeapCreate);</span><br><span class="line">        <span class="built_in">DetourDetach</span>(&amp;(PVOID&amp;)OldHeapDestroy, NewHeapDestroy);</span><br><span class="line">        <span class="built_in">DetourDetach</span>(&amp;(PVOID&amp;)OldHeapFree, NewHeapFree);</span><br><span class="line">        <span class="built_in">DetourDetach</span>(&amp;(PVOID&amp;)OldHeapAlloc, NewHeapAlloc);</span><br><span class="line">        <span class="built_in">DetourDetach</span>(&amp;(PVOID&amp;)OldRegCreateKeyEx, NewRegCreateKeyEx);</span><br><span class="line">        <span class="built_in">DetourDetach</span>(&amp;(PVOID&amp;)OldRegSetValueEx, NewRegSetValueEx);</span><br><span class="line">        <span class="built_in">DetourDetach</span>(&amp;(PVOID&amp;)OldRegDeleteValue, NewRegDeleteValue);</span><br><span class="line">        <span class="built_in">DetourDetach</span>(&amp;(PVOID&amp;)OldRegCloseKey, NewRegCloseKey);</span><br><span class="line">        <span class="built_in">DetourDetach</span>(&amp;(PVOID&amp;)OldRegOpenKeyEx, NewRegOpenKeyEx);</span><br><span class="line">        <span class="built_in">DetourDetach</span>(&amp;(PVOID&amp;)Oldsocket, Newsocket);</span><br><span class="line">        <span class="built_in">DetourDetach</span>(&amp;(PVOID&amp;)Oldbind, Newbind);</span><br><span class="line">        <span class="built_in">DetourDetach</span>(&amp;(PVOID&amp;)Oldconnect, Newconnect);</span><br><span class="line">        <span class="built_in">DetourDetach</span>(&amp;(PVOID&amp;)Oldsend, Newsend);</span><br><span class="line">        <span class="built_in">DetourDetach</span>(&amp;(PVOID&amp;)Oldrecv, Newrecv);</span><br><span class="line">        <span class="built_in">DetourDetach</span>(&amp;(PVOID&amp;)OldCopyFileA, NewCopyFileA);</span><br><span class="line">        <span class="built_in">DetourTransactionCommit</span>();</span><br><span class="line">        <span class="built_in">UnmapViewOfFile</span>(lpBase);</span><br><span class="line">        <span class="built_in">CloseHandle</span>(hMapFile);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> TRUE;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="注射器程序"><a class="markdownIt-Anchor" href="#注射器程序"></a> 注射器程序</h3>
<p>注意代码中的路径。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// App.cpp : 此文件包含 &quot;main&quot; 函数。程序执行将在此处开始并结束。</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;Windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;detours.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;thread&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> comment(lib,<span class="meta-string">&quot;detours.lib&quot;</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> <span class="meta-keyword">warning</span>(disable:4996)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc,<span class="keyword">char</span>* argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   <span class="comment">// std::cout &lt;&lt; &quot;Hello World!\n&quot;;</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (<span class="built_in">strstr</span>(argv[<span class="number">0</span>], <span class="string">&quot;App&quot;</span>)) &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">wchar_t</span> fileName[<span class="number">256</span>] = <span class="string">L&quot;&quot;</span>;</span><br><span class="line">	<span class="built_in">MultiByteToWideChar</span>(CP_ACP, <span class="number">0</span>, argv[<span class="number">0</span>], <span class="built_in">strlen</span>(argv[<span class="number">0</span>]), fileName, <span class="built_in"><span class="keyword">sizeof</span></span>(fileName));</span><br><span class="line">	<span class="built_in">wprintf</span>(<span class="string">L&quot;%s\n&quot;</span>, fileName);</span><br><span class="line"></span><br><span class="line">	STARTUPINFO si;</span><br><span class="line">	PROCESS_INFORMATION pi;</span><br><span class="line">	<span class="built_in">ZeroMemory</span>(&amp;si, <span class="built_in"><span class="keyword">sizeof</span></span>(STARTUPINFO));</span><br><span class="line">	<span class="built_in">ZeroMemory</span>(&amp;pi, <span class="built_in"><span class="keyword">sizeof</span></span>(PROCESS_INFORMATION));</span><br><span class="line">	si.cb = <span class="built_in"><span class="keyword">sizeof</span></span>(STARTUPINFO);</span><br><span class="line">	WCHAR DirPath[MAX_PATH + <span class="number">1</span>];</span><br><span class="line">	<span class="comment">/*wcscpy_s(DirPath, MAX_PATH, L&quot;C:\\Users\\15242\\source\\repos\\SoftWareScan\\Debug&quot;);*/</span></span><br><span class="line">	<span class="built_in">wcscpy_s</span>(DirPath, MAX_PATH, <span class="string">L&quot;./&quot;</span>);</span><br><span class="line">	<span class="comment">/*char DLLPath[MAX_PATH + 1] = &quot;C:\\Users\\15242\\source\\repos\\SoftWareScan\\Debug\\Dll1.dll&quot;;*/</span></span><br><span class="line">	<span class="keyword">char</span> DLLPath[MAX_PATH + <span class="number">1</span>] = <span class="string">&quot;Dll1.dll&quot;</span>;</span><br><span class="line">	WCHAR EXE[MAX_PATH + <span class="number">1</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">	<span class="comment">//wcscpy_s(EXE, MAX_PATH, L&quot;C:\\Users\\15242\\Documents\\Tencent Files\\1524276984\\FileRecv\\TestInitialNullForStudent\\TestApp\\Debug\\TestApp.exe&quot;);</span></span><br><span class="line">	<span class="built_in">wcscpy_s</span>(EXE, MAX_PATH, fileName);</span><br><span class="line"></span><br><span class="line">	std::cout &lt;&lt; fileName &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (<span class="built_in">DetourCreateProcessWithDllEx</span>(EXE, <span class="literal">NULL</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span>, TRUE, CREATE_DEFAULT_ERROR_MODE | CREATE_SUSPENDED, <span class="literal">NULL</span>, DirPath, &amp;si, &amp;pi, DLLPath, <span class="literal">NULL</span>))</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">ResumeThread</span>(pi.hThread);</span><br><span class="line">		<span class="built_in">WaitForSingleObject</span>(pi.hProcess, INFINITE);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">char</span> error[<span class="number">100</span>];</span><br><span class="line">		<span class="built_in">sprintf</span>(error, <span class="string">&quot;%d&quot;</span>, <span class="built_in">GetLastError</span>());</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="主程序softwarescan"><a class="markdownIt-Anchor" href="#主程序softwarescan"></a> 主程序SoftWareScan</h3>
<p>界面<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtext>  </mtext><mi>U</mi><mi>I</mi><mtext>  </mtext></mrow><annotation encoding="application/x-tex">\;UI\;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">U</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span></span></span>文件<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtext>  </mtext><mi>S</mi><mi>o</mi><mi>f</mi><mi>t</mi><mi>W</mi><mi>a</mi><mi>r</mi><mi>e</mi><mi>S</mi><mi>c</mi><mi>a</mi><mi>n</mi><mi mathvariant="normal">.</mi><mi>u</mi><mi>i</mi><mtext>  </mtext></mrow><annotation encoding="application/x-tex">\;SoftWareScan.ui\;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:0.13889em;">W</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">c</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord">.</span><span class="mord mathdefault">u</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span></span></span>:</p>
<p>该程序利用<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtext>  </mtext><mi>V</mi><mi>S</mi><mn>2019</mn><mtext>  </mtext></mrow><annotation encoding="application/x-tex">\;VS2019\;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord">2</span><span class="mord">0</span><span class="mord">1</span><span class="mord">9</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span></span></span>中的可视化操作界面生成部分UI组件，因此该文件由<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtext>  </mtext><mi>Q</mi><mi>t</mi><mtext>  </mtext></mrow><annotation encoding="application/x-tex">\;Qt\;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault">Q</span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span></span></span>自动生成。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ui</span> <span class="attr">version</span>=<span class="string">&quot;4.0&quot;</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">class</span>&gt;</span>SoftWareScanClass<span class="tag">&lt;/<span class="name">class</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">widget</span> <span class="attr">class</span>=<span class="string">&quot;QWidget&quot;</span> <span class="attr">name</span>=<span class="string">&quot;SoftWareScanClass&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;geometry&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">rect</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">x</span>&gt;</span>0<span class="tag">&lt;/<span class="name">x</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">y</span>&gt;</span>0<span class="tag">&lt;/<span class="name">y</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">width</span>&gt;</span>1123<span class="tag">&lt;/<span class="name">width</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">height</span>&gt;</span>799<span class="tag">&lt;/<span class="name">height</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">rect</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;cursor&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">cursorShape</span>&gt;</span>PointingHandCursor<span class="tag">&lt;/<span class="name">cursorShape</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;mouseTracking&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">bool</span>&gt;</span>true<span class="tag">&lt;/<span class="name">bool</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;windowTitle&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">string</span>&gt;</span>SoftWareScan<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;windowIcon&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">iconset</span> <span class="attr">resource</span>=<span class="string">&quot;SoftWareScan.qrc&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">normaloff</span>&gt;</span>:/SoftWareScan/Resources/SoftWareScan.png<span class="tag">&lt;/<span class="name">normaloff</span>&gt;</span>:/SoftWareScan/Resources/SoftWareScan.png<span class="tag">&lt;/<span class="name">iconset</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;autoFillBackground&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">bool</span>&gt;</span>false<span class="tag">&lt;/<span class="name">bool</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">widget</span> <span class="attr">class</span>=<span class="string">&quot;QWidget&quot;</span> <span class="attr">name</span>=<span class="string">&quot;InfoWidget&quot;</span> <span class="attr">native</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;geometry&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">rect</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">x</span>&gt;</span>0<span class="tag">&lt;/<span class="name">x</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">y</span>&gt;</span>0<span class="tag">&lt;/<span class="name">y</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">width</span>&gt;</span>591<span class="tag">&lt;/<span class="name">width</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">height</span>&gt;</span>281<span class="tag">&lt;/<span class="name">height</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">rect</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;styleSheet&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">string</span> <span class="attr">notr</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">widget</span> <span class="attr">class</span>=<span class="string">&quot;QTextBrowser&quot;</span> <span class="attr">name</span>=<span class="string">&quot;FilePathShow&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;geometry&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">rect</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">x</span>&gt;</span>0<span class="tag">&lt;/<span class="name">x</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">y</span>&gt;</span>20<span class="tag">&lt;/<span class="name">y</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">width</span>&gt;</span>591<span class="tag">&lt;/<span class="name">width</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">height</span>&gt;</span>41<span class="tag">&lt;/<span class="name">height</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">rect</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;font&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">font</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">family</span>&gt;</span>华文楷体<span class="tag">&lt;/<span class="name">family</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">pointsize</span>&gt;</span>14<span class="tag">&lt;/<span class="name">pointsize</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">italic</span>&gt;</span>false<span class="tag">&lt;/<span class="name">italic</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">font</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;autoFillBackground&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">bool</span>&gt;</span>true<span class="tag">&lt;/<span class="name">bool</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;html&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">string</span>&gt;</span><span class="symbol">&amp;lt;</span>!DOCTYPE HTML PUBLIC <span class="symbol">&amp;quot;</span>-//W3C//DTD HTML 4.0//EN<span class="symbol">&amp;quot;</span> <span class="symbol">&amp;quot;</span>http://www.w3.org/TR/REC-html40/strict.dtd<span class="symbol">&amp;quot;</span><span class="symbol">&amp;gt;</span></span><br><span class="line"><span class="symbol">&amp;lt;</span>html<span class="symbol">&amp;gt;</span><span class="symbol">&amp;lt;</span>head<span class="symbol">&amp;gt;</span><span class="symbol">&amp;lt;</span>meta name=<span class="symbol">&amp;quot;</span>qrichtext<span class="symbol">&amp;quot;</span> content=<span class="symbol">&amp;quot;</span>1<span class="symbol">&amp;quot;</span> /<span class="symbol">&amp;gt;</span><span class="symbol">&amp;lt;</span>style type=<span class="symbol">&amp;quot;</span>text/css<span class="symbol">&amp;quot;</span><span class="symbol">&amp;gt;</span></span><br><span class="line">p, li &#123; white-space: pre-wrap; &#125;</span><br><span class="line"><span class="symbol">&amp;lt;</span>/style<span class="symbol">&amp;gt;</span><span class="symbol">&amp;lt;</span>/head<span class="symbol">&amp;gt;</span><span class="symbol">&amp;lt;</span>body style=<span class="symbol">&amp;quot;</span> font-family:&#x27;华文楷体&#x27;; font-size:14pt; font-weight:400; font-style:normal;<span class="symbol">&amp;quot;</span><span class="symbol">&amp;gt;</span></span><br><span class="line"><span class="symbol">&amp;lt;</span>p align=<span class="symbol">&amp;quot;</span>center<span class="symbol">&amp;quot;</span> style=<span class="symbol">&amp;quot;</span> margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;<span class="symbol">&amp;quot;</span><span class="symbol">&amp;gt;</span><span class="symbol">&amp;lt;</span>span style=<span class="symbol">&amp;quot;</span> font-family:&#x27;宋体&#x27;; font-size:12pt; font-style:italic;<span class="symbol">&amp;quot;</span><span class="symbol">&amp;gt;</span>文件路径信息<span class="symbol">&amp;lt;</span>/span<span class="symbol">&amp;gt;</span><span class="symbol">&amp;lt;</span>/p<span class="symbol">&amp;gt;</span><span class="symbol">&amp;lt;</span>/body<span class="symbol">&amp;gt;</span><span class="symbol">&amp;lt;</span>/html<span class="symbol">&amp;gt;</span><span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">widget</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">widget</span> <span class="attr">class</span>=<span class="string">&quot;QTableWidget&quot;</span> <span class="attr">name</span>=<span class="string">&quot;FileInfo&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;geometry&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">rect</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">x</span>&gt;</span>0<span class="tag">&lt;/<span class="name">x</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">y</span>&gt;</span>60<span class="tag">&lt;/<span class="name">y</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">width</span>&gt;</span>591<span class="tag">&lt;/<span class="name">width</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">height</span>&gt;</span>191<span class="tag">&lt;/<span class="name">height</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">rect</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">widget</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">widget</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">widget</span> <span class="attr">class</span>=<span class="string">&quot;QTableWidget&quot;</span> <span class="attr">name</span>=<span class="string">&quot;ProcessInfoTable&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;geometry&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">rect</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">x</span>&gt;</span>780<span class="tag">&lt;/<span class="name">x</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">y</span>&gt;</span>10<span class="tag">&lt;/<span class="name">y</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">width</span>&gt;</span>281<span class="tag">&lt;/<span class="name">width</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">height</span>&gt;</span>181<span class="tag">&lt;/<span class="name">height</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">rect</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">widget</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">widget</span> <span class="attr">class</span>=<span class="string">&quot;QSplitter&quot;</span> <span class="attr">name</span>=<span class="string">&quot;splitter&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;geometry&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">rect</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">x</span>&gt;</span>610<span class="tag">&lt;/<span class="name">x</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">y</span>&gt;</span>10<span class="tag">&lt;/<span class="name">y</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">width</span>&gt;</span>161<span class="tag">&lt;/<span class="name">width</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">height</span>&gt;</span>271<span class="tag">&lt;/<span class="name">height</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">rect</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;orientation&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">enum</span>&gt;</span>Qt::Vertical<span class="tag">&lt;/<span class="name">enum</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">widget</span> <span class="attr">class</span>=<span class="string">&quot;QPushButton&quot;</span> <span class="attr">name</span>=<span class="string">&quot;FileOpen&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;font&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">font</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">family</span>&gt;</span>华文行楷<span class="tag">&lt;/<span class="name">family</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">pointsize</span>&gt;</span>12<span class="tag">&lt;/<span class="name">pointsize</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">font</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;text&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">string</span>&gt;</span>选择文件<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;icon&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">iconset</span> <span class="attr">resource</span>=<span class="string">&quot;SoftWareScan.qrc&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">normaloff</span>&gt;</span>:/SoftWareScan/Resources/file.png<span class="tag">&lt;/<span class="name">normaloff</span>&gt;</span>:/SoftWareScan/Resources/file.png<span class="tag">&lt;/<span class="name">iconset</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;iconSize&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">size</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">width</span>&gt;</span>25<span class="tag">&lt;/<span class="name">width</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">height</span>&gt;</span>25<span class="tag">&lt;/<span class="name">height</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">size</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">widget</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">widget</span> <span class="attr">class</span>=<span class="string">&quot;QPushButton&quot;</span> <span class="attr">name</span>=<span class="string">&quot;StartScan&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;font&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">font</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">family</span>&gt;</span>华文行楷<span class="tag">&lt;/<span class="name">family</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">pointsize</span>&gt;</span>12<span class="tag">&lt;/<span class="name">pointsize</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">font</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;text&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">string</span>&gt;</span>开始<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;icon&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">iconset</span> <span class="attr">resource</span>=<span class="string">&quot;SoftWareScan.qrc&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">normaloff</span>&gt;</span>:/SoftWareScan/Resources/start.png<span class="tag">&lt;/<span class="name">normaloff</span>&gt;</span>:/SoftWareScan/Resources/start.png<span class="tag">&lt;/<span class="name">iconset</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;iconSize&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">size</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">width</span>&gt;</span>25<span class="tag">&lt;/<span class="name">width</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">height</span>&gt;</span>25<span class="tag">&lt;/<span class="name">height</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">size</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">widget</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">widget</span> <span class="attr">class</span>=<span class="string">&quot;QPushButton&quot;</span> <span class="attr">name</span>=<span class="string">&quot;StopThread&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;font&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">font</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">family</span>&gt;</span>华文行楷<span class="tag">&lt;/<span class="name">family</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">pointsize</span>&gt;</span>12<span class="tag">&lt;/<span class="name">pointsize</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">font</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;text&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">string</span>&gt;</span>停止<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;icon&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">iconset</span> <span class="attr">resource</span>=<span class="string">&quot;SoftWareScan.qrc&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">normaloff</span>&gt;</span>:/SoftWareScan/Resources/stop.png<span class="tag">&lt;/<span class="name">normaloff</span>&gt;</span>:/SoftWareScan/Resources/stop.png<span class="tag">&lt;/<span class="name">iconset</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;iconSize&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">size</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">width</span>&gt;</span>25<span class="tag">&lt;/<span class="name">width</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">height</span>&gt;</span>25<span class="tag">&lt;/<span class="name">height</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">size</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">widget</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">widget</span> <span class="attr">class</span>=<span class="string">&quot;QPushButton&quot;</span> <span class="attr">name</span>=<span class="string">&quot;CleanInfo&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;font&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">font</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">family</span>&gt;</span>华文行楷<span class="tag">&lt;/<span class="name">family</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">pointsize</span>&gt;</span>12<span class="tag">&lt;/<span class="name">pointsize</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">font</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;text&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">string</span>&gt;</span>清除信息<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;icon&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">iconset</span> <span class="attr">resource</span>=<span class="string">&quot;SoftWareScan.qrc&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">normaloff</span>&gt;</span>:/SoftWareScan/Resources/clean.png<span class="tag">&lt;/<span class="name">normaloff</span>&gt;</span>:/SoftWareScan/Resources/clean.png<span class="tag">&lt;/<span class="name">iconset</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;iconSize&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">size</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">width</span>&gt;</span>25<span class="tag">&lt;/<span class="name">width</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">height</span>&gt;</span>25<span class="tag">&lt;/<span class="name">height</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">size</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">widget</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">widget</span> <span class="attr">class</span>=<span class="string">&quot;QPushButton&quot;</span> <span class="attr">name</span>=<span class="string">&quot;ProcessStatus&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;font&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">font</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">family</span>&gt;</span>华文行楷<span class="tag">&lt;/<span class="name">family</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">pointsize</span>&gt;</span>12<span class="tag">&lt;/<span class="name">pointsize</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">font</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;text&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">string</span>&gt;</span>进程状态<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;icon&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">iconset</span> <span class="attr">resource</span>=<span class="string">&quot;SoftWareScan.qrc&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">normaloff</span>&gt;</span>:/SoftWareScan/Resources/status.png<span class="tag">&lt;/<span class="name">normaloff</span>&gt;</span>:/SoftWareScan/Resources/status.png<span class="tag">&lt;/<span class="name">iconset</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;iconSize&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">size</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">width</span>&gt;</span>30<span class="tag">&lt;/<span class="name">width</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">height</span>&gt;</span>30<span class="tag">&lt;/<span class="name">height</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">size</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">widget</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">widget</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">widget</span> <span class="attr">class</span>=<span class="string">&quot;QWidget&quot;</span> <span class="attr">name</span>=<span class="string">&quot;widget&quot;</span> <span class="attr">native</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;geometry&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">rect</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">x</span>&gt;</span>780<span class="tag">&lt;/<span class="name">x</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">y</span>&gt;</span>0<span class="tag">&lt;/<span class="name">y</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">width</span>&gt;</span>281<span class="tag">&lt;/<span class="name">width</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">height</span>&gt;</span>261<span class="tag">&lt;/<span class="name">height</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">rect</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">widget</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">widget</span> <span class="attr">class</span>=<span class="string">&quot;QTabWidget&quot;</span> <span class="attr">name</span>=<span class="string">&quot;ApiInfo&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;geometry&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">rect</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">x</span>&gt;</span>0<span class="tag">&lt;/<span class="name">x</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">y</span>&gt;</span>560<span class="tag">&lt;/<span class="name">y</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">width</span>&gt;</span>731<span class="tag">&lt;/<span class="name">width</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">height</span>&gt;</span>211<span class="tag">&lt;/<span class="name">height</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">rect</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;font&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">font</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">family</span>&gt;</span>华文楷体<span class="tag">&lt;/<span class="name">family</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">pointsize</span>&gt;</span>14<span class="tag">&lt;/<span class="name">pointsize</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">font</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;layoutDirection&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">enum</span>&gt;</span>Qt::LeftToRight<span class="tag">&lt;/<span class="name">enum</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;currentIndex&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">number</span>&gt;</span>0<span class="tag">&lt;/<span class="name">number</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;iconSize&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">size</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">width</span>&gt;</span>25<span class="tag">&lt;/<span class="name">width</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">height</span>&gt;</span>25<span class="tag">&lt;/<span class="name">height</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">size</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">widget</span> <span class="attr">class</span>=<span class="string">&quot;QWidget&quot;</span> <span class="attr">name</span>=<span class="string">&quot;Page_heap&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">attribute</span> <span class="attr">name</span>=<span class="string">&quot;title&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">string</span>&gt;</span>页<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">attribute</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">widget</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">widget</span> <span class="attr">class</span>=<span class="string">&quot;QWidget&quot;</span> <span class="attr">name</span>=<span class="string">&quot;Page_reg&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">attribute</span> <span class="attr">name</span>=<span class="string">&quot;title&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">string</span>&gt;</span>页<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">attribute</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">widget</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">widget</span> <span class="attr">class</span>=<span class="string">&quot;QWidget&quot;</span> <span class="attr">name</span>=<span class="string">&quot;Page_file&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">attribute</span> <span class="attr">name</span>=<span class="string">&quot;title&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">string</span>&gt;</span>页<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">attribute</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">widget</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">widget</span> <span class="attr">class</span>=<span class="string">&quot;QWidget&quot;</span> <span class="attr">name</span>=<span class="string">&quot;Page_socket&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">attribute</span> <span class="attr">name</span>=<span class="string">&quot;title&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">string</span>&gt;</span>页<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">attribute</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">widget</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">widget</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">widget</span> <span class="attr">class</span>=<span class="string">&quot;QTabWidget&quot;</span> <span class="attr">name</span>=<span class="string">&quot;JieHuo&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;geometry&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">rect</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">x</span>&gt;</span>0<span class="tag">&lt;/<span class="name">x</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">y</span>&gt;</span>300<span class="tag">&lt;/<span class="name">y</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">width</span>&gt;</span>1081<span class="tag">&lt;/<span class="name">width</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">height</span>&gt;</span>261<span class="tag">&lt;/<span class="name">height</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">rect</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;font&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">font</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">family</span>&gt;</span>华文楷体<span class="tag">&lt;/<span class="name">family</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">pointsize</span>&gt;</span>14<span class="tag">&lt;/<span class="name">pointsize</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">font</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;layoutDirection&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">enum</span>&gt;</span>Qt::LeftToRight<span class="tag">&lt;/<span class="name">enum</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;currentIndex&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">number</span>&gt;</span>4<span class="tag">&lt;/<span class="name">number</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;iconSize&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">size</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">width</span>&gt;</span>25<span class="tag">&lt;/<span class="name">width</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">height</span>&gt;</span>25<span class="tag">&lt;/<span class="name">height</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">size</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">widget</span> <span class="attr">class</span>=<span class="string">&quot;QWidget&quot;</span> <span class="attr">name</span>=<span class="string">&quot;message&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">attribute</span> <span class="attr">name</span>=<span class="string">&quot;title&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">string</span>&gt;</span>页<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">attribute</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">widget</span> <span class="attr">class</span>=<span class="string">&quot;QTreeWidget&quot;</span> <span class="attr">name</span>=<span class="string">&quot;MessageBoxInfo&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;geometry&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">rect</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">x</span>&gt;</span>0<span class="tag">&lt;/<span class="name">x</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">y</span>&gt;</span>60<span class="tag">&lt;/<span class="name">y</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">width</span>&gt;</span>491<span class="tag">&lt;/<span class="name">width</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">height</span>&gt;</span>81<span class="tag">&lt;/<span class="name">height</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">rect</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">attribute</span> <span class="attr">name</span>=<span class="string">&quot;headerHighlightSections&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">bool</span>&gt;</span>true<span class="tag">&lt;/<span class="name">bool</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">attribute</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">column</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;text&quot;</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">string</span> <span class="attr">notr</span>=<span class="string">&quot;true&quot;</span>&gt;</span>1<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">column</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">widget</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">widget</span> <span class="attr">class</span>=<span class="string">&quot;QProgressBar&quot;</span> <span class="attr">name</span>=<span class="string">&quot;progress_message&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;geometry&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">rect</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">x</span>&gt;</span>10<span class="tag">&lt;/<span class="name">x</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">y</span>&gt;</span>10<span class="tag">&lt;/<span class="name">y</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">width</span>&gt;</span>81<span class="tag">&lt;/<span class="name">width</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">height</span>&gt;</span>31<span class="tag">&lt;/<span class="name">height</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">rect</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;value&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">number</span>&gt;</span>100<span class="tag">&lt;/<span class="name">number</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">widget</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">widget</span> <span class="attr">class</span>=<span class="string">&quot;QComboBox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;MessageCheckBox&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;geometry&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">rect</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">x</span>&gt;</span>190<span class="tag">&lt;/<span class="name">x</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">y</span>&gt;</span>10<span class="tag">&lt;/<span class="name">y</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">width</span>&gt;</span>150<span class="tag">&lt;/<span class="name">width</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">height</span>&gt;</span>31<span class="tag">&lt;/<span class="name">height</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">rect</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;sizePolicy&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">sizepolicy</span> <span class="attr">hsizetype</span>=<span class="string">&quot;Fixed&quot;</span> <span class="attr">vsizetype</span>=<span class="string">&quot;Fixed&quot;</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">horstretch</span>&gt;</span>0<span class="tag">&lt;/<span class="name">horstretch</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">verstretch</span>&gt;</span>0<span class="tag">&lt;/<span class="name">verstretch</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">sizepolicy</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;minimumSize&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">size</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">width</span>&gt;</span>150<span class="tag">&lt;/<span class="name">width</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">height</span>&gt;</span>30<span class="tag">&lt;/<span class="name">height</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">size</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;currentIndex&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">number</span>&gt;</span>-1<span class="tag">&lt;/<span class="name">number</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">widget</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">widget</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">widget</span> <span class="attr">class</span>=<span class="string">&quot;QWidget&quot;</span> <span class="attr">name</span>=<span class="string">&quot;file&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">attribute</span> <span class="attr">name</span>=<span class="string">&quot;title&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">string</span>&gt;</span>页<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">attribute</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">widget</span> <span class="attr">class</span>=<span class="string">&quot;QTreeWidget&quot;</span> <span class="attr">name</span>=<span class="string">&quot;FileApiInfo&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;geometry&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">rect</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">x</span>&gt;</span>10<span class="tag">&lt;/<span class="name">x</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">y</span>&gt;</span>60<span class="tag">&lt;/<span class="name">y</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">width</span>&gt;</span>471<span class="tag">&lt;/<span class="name">width</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">height</span>&gt;</span>121<span class="tag">&lt;/<span class="name">height</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">rect</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">attribute</span> <span class="attr">name</span>=<span class="string">&quot;headerHighlightSections&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">bool</span>&gt;</span>true<span class="tag">&lt;/<span class="name">bool</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">attribute</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">column</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;text&quot;</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">string</span> <span class="attr">notr</span>=<span class="string">&quot;true&quot;</span>&gt;</span>1<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">column</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">widget</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">widget</span> <span class="attr">class</span>=<span class="string">&quot;QProgressBar&quot;</span> <span class="attr">name</span>=<span class="string">&quot;progress_file&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;geometry&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">rect</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">x</span>&gt;</span>20<span class="tag">&lt;/<span class="name">x</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">y</span>&gt;</span>20<span class="tag">&lt;/<span class="name">y</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">width</span>&gt;</span>81<span class="tag">&lt;/<span class="name">width</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">height</span>&gt;</span>31<span class="tag">&lt;/<span class="name">height</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">rect</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;value&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">number</span>&gt;</span>100<span class="tag">&lt;/<span class="name">number</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">widget</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">widget</span> <span class="attr">class</span>=<span class="string">&quot;QComboBox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;FileCheckBox&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;geometry&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">rect</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">x</span>&gt;</span>220<span class="tag">&lt;/<span class="name">x</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">y</span>&gt;</span>10<span class="tag">&lt;/<span class="name">y</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">width</span>&gt;</span>150<span class="tag">&lt;/<span class="name">width</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">height</span>&gt;</span>31<span class="tag">&lt;/<span class="name">height</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">rect</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;minimumSize&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">size</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">width</span>&gt;</span>150<span class="tag">&lt;/<span class="name">width</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">height</span>&gt;</span>30<span class="tag">&lt;/<span class="name">height</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">size</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;currentIndex&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">number</span>&gt;</span>-1<span class="tag">&lt;/<span class="name">number</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">widget</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">widget</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">widget</span> <span class="attr">class</span>=<span class="string">&quot;QWidget&quot;</span> <span class="attr">name</span>=<span class="string">&quot;heap&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">attribute</span> <span class="attr">name</span>=<span class="string">&quot;title&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">string</span>&gt;</span>页<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">attribute</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">widget</span> <span class="attr">class</span>=<span class="string">&quot;QTreeWidget&quot;</span> <span class="attr">name</span>=<span class="string">&quot;HeapApiInfo&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;geometry&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">rect</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">x</span>&gt;</span>20<span class="tag">&lt;/<span class="name">x</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">y</span>&gt;</span>60<span class="tag">&lt;/<span class="name">y</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">width</span>&gt;</span>451<span class="tag">&lt;/<span class="name">width</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">height</span>&gt;</span>121<span class="tag">&lt;/<span class="name">height</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">rect</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">attribute</span> <span class="attr">name</span>=<span class="string">&quot;headerHighlightSections&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">bool</span>&gt;</span>true<span class="tag">&lt;/<span class="name">bool</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">attribute</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">column</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;text&quot;</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">string</span> <span class="attr">notr</span>=<span class="string">&quot;true&quot;</span>&gt;</span>1<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">column</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">widget</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">widget</span> <span class="attr">class</span>=<span class="string">&quot;QProgressBar&quot;</span> <span class="attr">name</span>=<span class="string">&quot;progress_heap&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;geometry&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">rect</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">x</span>&gt;</span>40<span class="tag">&lt;/<span class="name">x</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">y</span>&gt;</span>20<span class="tag">&lt;/<span class="name">y</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">width</span>&gt;</span>81<span class="tag">&lt;/<span class="name">width</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">height</span>&gt;</span>31<span class="tag">&lt;/<span class="name">height</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">rect</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;value&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">number</span>&gt;</span>100<span class="tag">&lt;/<span class="name">number</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">widget</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">widget</span> <span class="attr">class</span>=<span class="string">&quot;QComboBox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;HeapCheckBox&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;geometry&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">rect</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">x</span>&gt;</span>230<span class="tag">&lt;/<span class="name">x</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">y</span>&gt;</span>20<span class="tag">&lt;/<span class="name">y</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">width</span>&gt;</span>150<span class="tag">&lt;/<span class="name">width</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">height</span>&gt;</span>31<span class="tag">&lt;/<span class="name">height</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">rect</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;minimumSize&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">size</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">width</span>&gt;</span>150<span class="tag">&lt;/<span class="name">width</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">height</span>&gt;</span>30<span class="tag">&lt;/<span class="name">height</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">size</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;currentIndex&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">number</span>&gt;</span>-1<span class="tag">&lt;/<span class="name">number</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">widget</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">widget</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">widget</span> <span class="attr">class</span>=<span class="string">&quot;QWidget&quot;</span> <span class="attr">name</span>=<span class="string">&quot;reg&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">attribute</span> <span class="attr">name</span>=<span class="string">&quot;title&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">string</span>&gt;</span>页<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">attribute</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">widget</span> <span class="attr">class</span>=<span class="string">&quot;QTreeWidget&quot;</span> <span class="attr">name</span>=<span class="string">&quot;RegApiInfo&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;geometry&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">rect</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">x</span>&gt;</span>10<span class="tag">&lt;/<span class="name">x</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">y</span>&gt;</span>50<span class="tag">&lt;/<span class="name">y</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">width</span>&gt;</span>461<span class="tag">&lt;/<span class="name">width</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">height</span>&gt;</span>131<span class="tag">&lt;/<span class="name">height</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">rect</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">attribute</span> <span class="attr">name</span>=<span class="string">&quot;headerHighlightSections&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">bool</span>&gt;</span>true<span class="tag">&lt;/<span class="name">bool</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">attribute</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">column</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;text&quot;</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">string</span> <span class="attr">notr</span>=<span class="string">&quot;true&quot;</span>&gt;</span>1<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">column</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">widget</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">widget</span> <span class="attr">class</span>=<span class="string">&quot;QComboBox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;RegCheckBox&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;geometry&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">rect</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">x</span>&gt;</span>320<span class="tag">&lt;/<span class="name">x</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">y</span>&gt;</span>10<span class="tag">&lt;/<span class="name">y</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">width</span>&gt;</span>150<span class="tag">&lt;/<span class="name">width</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">height</span>&gt;</span>31<span class="tag">&lt;/<span class="name">height</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">rect</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;minimumSize&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">size</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">width</span>&gt;</span>150<span class="tag">&lt;/<span class="name">width</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">height</span>&gt;</span>30<span class="tag">&lt;/<span class="name">height</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">size</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;currentIndex&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">number</span>&gt;</span>-1<span class="tag">&lt;/<span class="name">number</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">widget</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">widget</span> <span class="attr">class</span>=<span class="string">&quot;QProgressBar&quot;</span> <span class="attr">name</span>=<span class="string">&quot;progress_reg&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;geometry&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">rect</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">x</span>&gt;</span>20<span class="tag">&lt;/<span class="name">x</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">y</span>&gt;</span>10<span class="tag">&lt;/<span class="name">y</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">width</span>&gt;</span>81<span class="tag">&lt;/<span class="name">width</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">height</span>&gt;</span>31<span class="tag">&lt;/<span class="name">height</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">rect</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;value&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">number</span>&gt;</span>100<span class="tag">&lt;/<span class="name">number</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">widget</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">widget</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">widget</span> <span class="attr">class</span>=<span class="string">&quot;QWidget&quot;</span> <span class="attr">name</span>=<span class="string">&quot;socket&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">attribute</span> <span class="attr">name</span>=<span class="string">&quot;title&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">string</span>&gt;</span>页<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">attribute</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">widget</span> <span class="attr">class</span>=<span class="string">&quot;QTreeWidget&quot;</span> <span class="attr">name</span>=<span class="string">&quot;SocketApiInfo&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;geometry&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">rect</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">x</span>&gt;</span>180<span class="tag">&lt;/<span class="name">x</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">y</span>&gt;</span>70<span class="tag">&lt;/<span class="name">y</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">width</span>&gt;</span>461<span class="tag">&lt;/<span class="name">width</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">height</span>&gt;</span>131<span class="tag">&lt;/<span class="name">height</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">rect</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">attribute</span> <span class="attr">name</span>=<span class="string">&quot;headerHighlightSections&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">bool</span>&gt;</span>true<span class="tag">&lt;/<span class="name">bool</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">attribute</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">column</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;text&quot;</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">string</span> <span class="attr">notr</span>=<span class="string">&quot;true&quot;</span>&gt;</span>1<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">column</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">widget</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">widget</span> <span class="attr">class</span>=<span class="string">&quot;QProgressBar&quot;</span> <span class="attr">name</span>=<span class="string">&quot;progress_socket&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;geometry&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">rect</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">x</span>&gt;</span>70<span class="tag">&lt;/<span class="name">x</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">y</span>&gt;</span>20<span class="tag">&lt;/<span class="name">y</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">width</span>&gt;</span>81<span class="tag">&lt;/<span class="name">width</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">height</span>&gt;</span>31<span class="tag">&lt;/<span class="name">height</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">rect</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;value&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">number</span>&gt;</span>100<span class="tag">&lt;/<span class="name">number</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">widget</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">widget</span> <span class="attr">class</span>=<span class="string">&quot;QComboBox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;SocketCheckBox&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;geometry&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">rect</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">x</span>&gt;</span>370<span class="tag">&lt;/<span class="name">x</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">y</span>&gt;</span>20<span class="tag">&lt;/<span class="name">y</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">width</span>&gt;</span>150<span class="tag">&lt;/<span class="name">width</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">height</span>&gt;</span>31<span class="tag">&lt;/<span class="name">height</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">rect</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;minimumSize&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">size</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">width</span>&gt;</span>150<span class="tag">&lt;/<span class="name">width</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">height</span>&gt;</span>30<span class="tag">&lt;/<span class="name">height</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">size</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;currentIndex&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">number</span>&gt;</span>-1<span class="tag">&lt;/<span class="name">number</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">widget</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">widget</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">widget</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">widget</span> <span class="attr">class</span>=<span class="string">&quot;QTabWidget&quot;</span> <span class="attr">name</span>=<span class="string">&quot;HeapVerify&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;geometry&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">rect</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">x</span>&gt;</span>730<span class="tag">&lt;/<span class="name">x</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">y</span>&gt;</span>560<span class="tag">&lt;/<span class="name">y</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">width</span>&gt;</span>371<span class="tag">&lt;/<span class="name">width</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">height</span>&gt;</span>211<span class="tag">&lt;/<span class="name">height</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">rect</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;font&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">font</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">family</span>&gt;</span>华文楷体<span class="tag">&lt;/<span class="name">family</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">pointsize</span>&gt;</span>14<span class="tag">&lt;/<span class="name">pointsize</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">font</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;currentIndex&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">number</span>&gt;</span>0<span class="tag">&lt;/<span class="name">number</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">widget</span> <span class="attr">class</span>=<span class="string">&quot;QWidget&quot;</span> <span class="attr">name</span>=<span class="string">&quot;HeapCD&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">attribute</span> <span class="attr">name</span>=<span class="string">&quot;title&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">string</span>&gt;</span>页<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">attribute</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">widget</span> <span class="attr">class</span>=<span class="string">&quot;QListWidget&quot;</span> <span class="attr">name</span>=<span class="string">&quot;HeapCreateAndDestroy&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;geometry&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">rect</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">x</span>&gt;</span>50<span class="tag">&lt;/<span class="name">x</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">y</span>&gt;</span>10<span class="tag">&lt;/<span class="name">y</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">width</span>&gt;</span>256<span class="tag">&lt;/<span class="name">width</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">height</span>&gt;</span>161<span class="tag">&lt;/<span class="name">height</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">rect</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">widget</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">widget</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">widget</span> <span class="attr">class</span>=<span class="string">&quot;QWidget&quot;</span> <span class="attr">name</span>=<span class="string">&quot;HeapMem&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">attribute</span> <span class="attr">name</span>=<span class="string">&quot;title&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">string</span>&gt;</span>页<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">attribute</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">widget</span> <span class="attr">class</span>=<span class="string">&quot;QListWidget&quot;</span> <span class="attr">name</span>=<span class="string">&quot;HeapMemoryBlock&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;geometry&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">rect</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">x</span>&gt;</span>50<span class="tag">&lt;/<span class="name">x</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">y</span>&gt;</span>10<span class="tag">&lt;/<span class="name">y</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">width</span>&gt;</span>256<span class="tag">&lt;/<span class="name">width</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">height</span>&gt;</span>151<span class="tag">&lt;/<span class="name">height</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">rect</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">widget</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">widget</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">widget</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">zorder</span>&gt;</span>ApiInfo<span class="tag">&lt;/<span class="name">zorder</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">zorder</span>&gt;</span>widget<span class="tag">&lt;/<span class="name">zorder</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">zorder</span>&gt;</span>InfoWidget<span class="tag">&lt;/<span class="name">zorder</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">zorder</span>&gt;</span>ProcessInfoTable<span class="tag">&lt;/<span class="name">zorder</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">zorder</span>&gt;</span>splitter<span class="tag">&lt;/<span class="name">zorder</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">zorder</span>&gt;</span>JieHuo<span class="tag">&lt;/<span class="name">zorder</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">zorder</span>&gt;</span>HeapVerify<span class="tag">&lt;/<span class="name">zorder</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">widget</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">layoutdefault</span> <span class="attr">spacing</span>=<span class="string">&quot;6&quot;</span> <span class="attr">margin</span>=<span class="string">&quot;11&quot;</span>/&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">resources</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">include</span> <span class="attr">location</span>=<span class="string">&quot;SoftWareScan.qrc&quot;</span>/&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">connections</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ui</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>主程序<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtext>  </mtext><mi>m</mi><mi>a</mi><mi>i</mi><mi>n</mi><mi mathvariant="normal">.</mi><mi>c</mi><mi>p</mi><mi>p</mi><mtext>  </mtext></mrow><annotation encoding="application/x-tex">\;main.cpp\;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">a</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord">.</span><span class="mord mathdefault">c</span><span class="mord mathdefault">p</span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span></span></span>:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;SoftWareScan.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QtWidgets/QApplication&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> <span class="meta-keyword">warning</span>(disable:4996)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">QApplication <span class="title">a</span><span class="params">(argc, argv)</span></span>;</span><br><span class="line">	SoftWareScan w;</span><br><span class="line">	w.<span class="built_in">show</span>();</span><br><span class="line">	<span class="keyword">return</span> a.<span class="built_in">exec</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtext>  </mtext><mi>S</mi><mi>o</mi><mi>f</mi><mi>t</mi><mi>W</mi><mi>a</mi><mi>r</mi><mi>e</mi><mi>S</mi><mi>c</mi><mi>a</mi><mi>n</mi><mi mathvariant="normal">.</mi><mi>h</mi><mtext>  </mtext></mrow><annotation encoding="application/x-tex">\;SoftWareScan.h\;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:0.13889em;">W</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">c</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord">.</span><span class="mord mathdefault">h</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span></span></span>:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> once</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QtWidgets/QWidget&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;ui_SoftWareScan.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;Windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QCloseEvent&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;thread&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QThread&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unordered_set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;qmetatype.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MESSAGEBOXA 1</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MESSAGEBOXW 2</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CREATEFILE 3</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> WRITEFILE 4</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> READFILE 5</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CLOSEHANDLE 6</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> HEAPCREATE 7</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> HEAPDESTROY 8</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> HEAPFREE 9</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> HEAPALLOC 10</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> REGCREATEKEYEX 11</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> REGSETVALUEEX 12</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> REGCLOSEKEY 13</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> REGOPENKEYEX 14</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> REGDELETEVALUE 15</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> THESOCKET 16</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BIND 17</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SEND 18</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CONNECT 19</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> RECV 20</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> COPYFILEA 21</span></span><br><span class="line"></span><br><span class="line"> <span class="class"><span class="keyword">struct</span> <span class="title">info</span>//消息</span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">	<span class="keyword">int</span> type,Num;<span class="comment">//消息拦截API类型</span></span><br><span class="line">	SYSTEMTIME st;</span><br><span class="line">	<span class="keyword">char</span> Name[<span class="number">10</span>][<span class="number">30</span>] = &#123; <span class="number">0</span> &#125;;<span class="comment">//键</span></span><br><span class="line">	<span class="keyword">char</span> Value[<span class="number">10</span>][<span class="number">70</span>] = &#123; <span class="number">0</span> &#125;;<span class="comment">//值</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"> <span class="comment">//注册自定义类型</span></span><br><span class="line"> <span class="built_in">Q_DECLARE_METATYPE</span>(info);</span><br><span class="line"> <span class="comment">//发现recvinfo作为全局变量在被两个线程使用时会因为时间的关系丢掉一些包</span></span><br><span class="line"> <span class="comment">//于是用信号与槽传递自定义类型参数来解决这个问题</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">QT_BEGIN_NAMESPACE</span><br><span class="line"><span class="keyword">namespace</span> Ui &#123;</span><br><span class="line">	<span class="class"><span class="keyword">class</span> <span class="title">SoftWareScanClass</span>;</span></span><br><span class="line">&#125; <span class="comment">// namespace Ui</span></span><br><span class="line">QT_END_NAMESPACE</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyThread</span> :</span> <span class="keyword">public</span> QThread</span><br><span class="line">&#123;</span><br><span class="line">	Q_OBJECT</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	map&lt;string, <span class="keyword">int</span>&gt; HeapBlock;<span class="comment">//动态记录创建的堆块</span></span><br><span class="line">	map&lt;string, map&lt;string, <span class="keyword">int</span>&gt;&gt; HeapMem;<span class="comment">//动态记录申请的堆内存块</span></span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">StopThread</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">char</span>* filepath)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">GetFileName</span><span class="params">(<span class="keyword">char</span>* filepath, <span class="keyword">char</span>* filename)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">GetStatus</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">ModifyProcessStatus</span><span class="params">(<span class="keyword">bool</span> status)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">checkInfo</span><span class="params">(info tempinfo)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">GetLastFolder</span><span class="params">(<span class="keyword">char</span>* filePath, string&amp; folder)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">GetFileSize</span><span class="params">(<span class="keyword">int</span> size)</span></span>;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="keyword">bool</span> running;</span><br><span class="line">	<span class="keyword">char</span> filePath[<span class="number">256</span>], fileName[<span class="number">128</span>];</span><br><span class="line">	<span class="keyword">int</span> fileSize;<span class="comment">//加载文件的大小，用于判断是否进行自我复制</span></span><br><span class="line">	map&lt;string , string&gt; filemap;</span><br><span class="line">	unordered_set&lt;string&gt; folderset;</span><br><span class="line">	unordered_set&lt;string&gt; filenameset;</span><br><span class="line">	</span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>;</span><br><span class="line">signals:</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">newInfo</span><span class="params">(info recvinfo)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">newStatus</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="comment">//void newProcessInfo(PROCESS_INFORMATION pi);</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">newProcessName</span><span class="params">(QString string)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">newProcessID</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">newProcessHandle</span><span class="params">(QString string)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">newHeapInfo</span><span class="params">(QString string)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">newRegInfo</span><span class="params">(<span class="keyword">int</span> handle, QString string)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">newFileInfo</span><span class="params">(<span class="keyword">int</span> handle, QString string)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">newSocketInfo</span><span class="params">(QString string)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">newHeapBlock</span><span class="params">()</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SoftWareScan</span> :</span> <span class="keyword">public</span> QWidget</span><br><span class="line">&#123;</span><br><span class="line">	Q_OBJECT</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	MyThread threadA;</span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">closeEvent</span><span class="params">(QCloseEvent* event)</span></span>;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">SoftWareScan</span>(QWidget *parent = Q_NULLPTR);</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">InitUI</span><span class="params">()</span></span>;</span><br><span class="line"><span class="keyword">private</span> slots:</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">on_FileOpen_clicked</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">on_StartScan_clicked</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">on_StopThread_clicked</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">on_CleanInfo_clicked</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">FileInfoShow</span><span class="params">(QString filepath)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">FileInfoWindow</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">APIInfoWindow</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">InitCheck</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">InitJieHuo</span><span class="params">()</span></span>;<span class="comment">//截获信息Tab</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">InitExceptionTab</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">ProcessInfoTable</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">on_threadA_newStatus</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">on_threadA_newInfo</span><span class="params">(info recvinfo)</span></span>;</span><br><span class="line">	<span class="comment">//void on_threadA_newProcessInfo(PROCESS_INFORMATION pi);</span></span><br><span class="line">	<span class="comment">//槽函数不能简单的传递结构体</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">on_threadA_newProcessName</span><span class="params">(QString string)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">on_threadA_newProcessID</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">on_threadA_newProcessHandle</span><span class="params">(QString string)</span></span>;</span><br><span class="line">	<span class="comment">//下面列举checkbox发生信号变化时的槽函数</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">State_MessageA</span><span class="params">(<span class="keyword">int</span> state)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">State_MessageB</span><span class="params">(<span class="keyword">int</span> state)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">State_CreateFile</span><span class="params">(<span class="keyword">int</span> state)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">State_WriteFile</span><span class="params">(<span class="keyword">int</span> state)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">State_ReadFile</span><span class="params">(<span class="keyword">int</span> state)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">State_CloseHandle</span><span class="params">(<span class="keyword">int</span> state)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">State_HeapCreate</span><span class="params">(<span class="keyword">int</span> state)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">State_HeapDestroy</span><span class="params">(<span class="keyword">int</span> state)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">State_HeapFree</span><span class="params">(<span class="keyword">int</span> state)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">State_HeapAlloc</span><span class="params">(<span class="keyword">int</span> state)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">State_RegCreateKeyEx</span><span class="params">(<span class="keyword">int</span> state)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">State_RegSetValueEx</span><span class="params">(<span class="keyword">int</span> state)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">State_RegCloseKey</span><span class="params">(<span class="keyword">int</span> state)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">State_RegOpenKeyEx</span><span class="params">(<span class="keyword">int</span> state)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">State_RegDeleteValue</span><span class="params">(<span class="keyword">int</span> state)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">State_socket</span><span class="params">(<span class="keyword">int</span> state)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">State_connect</span><span class="params">(<span class="keyword">int</span> state)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">State_bind</span><span class="params">(<span class="keyword">int</span> state)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">State_send</span><span class="params">(<span class="keyword">int</span> state)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">State_recv</span><span class="params">(<span class="keyword">int</span> state)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">State_copyfilea</span><span class="params">(<span class="keyword">int</span> state)</span></span>;</span><br><span class="line">	<span class="comment">//进度条函数</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">ProgressBar</span><span class="params">(<span class="keyword">int</span> i)</span></span>;</span><br><span class="line">	<span class="comment">//异常记录函数</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">NewHeapInfo</span><span class="params">(QString string)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">NewRegInfo</span><span class="params">(<span class="keyword">int</span> handle, QString string)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">NewFileInfo</span><span class="params">(<span class="keyword">int</span> handle, QString string)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">NewSocketInfo</span><span class="params">(QString string)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">NewHeapBlock</span><span class="params">()</span></span>;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	Ui::SoftWareScanClass ui;</span><br><span class="line">	<span class="comment">//MyThread threadA;</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtext>  </mtext><mi>S</mi><mi>o</mi><mi>f</mi><mi>t</mi><mi>W</mi><mi>a</mi><mi>r</mi><mi>e</mi><mi>S</mi><mi>c</mi><mi>a</mi><mi>n</mi><mi mathvariant="normal">.</mi><mi>c</mi><mi>p</mi><mi>p</mi><mtext>  </mtext></mrow><annotation encoding="application/x-tex">\;SoftWareScan.cpp\;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:0.13889em;">W</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">c</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord">.</span><span class="mord mathdefault">c</span><span class="mord mathdefault">p</span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span></span></span>:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br><span class="line">911</span><br><span class="line">912</span><br><span class="line">913</span><br><span class="line">914</span><br><span class="line">915</span><br><span class="line">916</span><br><span class="line">917</span><br><span class="line">918</span><br><span class="line">919</span><br><span class="line">920</span><br><span class="line">921</span><br><span class="line">922</span><br><span class="line">923</span><br><span class="line">924</span><br><span class="line">925</span><br><span class="line">926</span><br><span class="line">927</span><br><span class="line">928</span><br><span class="line">929</span><br><span class="line">930</span><br><span class="line">931</span><br><span class="line">932</span><br><span class="line">933</span><br><span class="line">934</span><br><span class="line">935</span><br><span class="line">936</span><br><span class="line">937</span><br><span class="line">938</span><br><span class="line">939</span><br><span class="line">940</span><br><span class="line">941</span><br><span class="line">942</span><br><span class="line">943</span><br><span class="line">944</span><br><span class="line">945</span><br><span class="line">946</span><br><span class="line">947</span><br><span class="line">948</span><br><span class="line">949</span><br><span class="line">950</span><br><span class="line">951</span><br><span class="line">952</span><br><span class="line">953</span><br><span class="line">954</span><br><span class="line">955</span><br><span class="line">956</span><br><span class="line">957</span><br><span class="line">958</span><br><span class="line">959</span><br><span class="line">960</span><br><span class="line">961</span><br><span class="line">962</span><br><span class="line">963</span><br><span class="line">964</span><br><span class="line">965</span><br><span class="line">966</span><br><span class="line">967</span><br><span class="line">968</span><br><span class="line">969</span><br><span class="line">970</span><br><span class="line">971</span><br><span class="line">972</span><br><span class="line">973</span><br><span class="line">974</span><br><span class="line">975</span><br><span class="line">976</span><br><span class="line">977</span><br><span class="line">978</span><br><span class="line">979</span><br><span class="line">980</span><br><span class="line">981</span><br><span class="line">982</span><br><span class="line">983</span><br><span class="line">984</span><br><span class="line">985</span><br><span class="line">986</span><br><span class="line">987</span><br><span class="line">988</span><br><span class="line">989</span><br><span class="line">990</span><br><span class="line">991</span><br><span class="line">992</span><br><span class="line">993</span><br><span class="line">994</span><br><span class="line">995</span><br><span class="line">996</span><br><span class="line">997</span><br><span class="line">998</span><br><span class="line">999</span><br><span class="line">1000</span><br><span class="line">1001</span><br><span class="line">1002</span><br><span class="line">1003</span><br><span class="line">1004</span><br><span class="line">1005</span><br><span class="line">1006</span><br><span class="line">1007</span><br><span class="line">1008</span><br><span class="line">1009</span><br><span class="line">1010</span><br><span class="line">1011</span><br><span class="line">1012</span><br><span class="line">1013</span><br><span class="line">1014</span><br><span class="line">1015</span><br><span class="line">1016</span><br><span class="line">1017</span><br><span class="line">1018</span><br><span class="line">1019</span><br><span class="line">1020</span><br><span class="line">1021</span><br><span class="line">1022</span><br><span class="line">1023</span><br><span class="line">1024</span><br><span class="line">1025</span><br><span class="line">1026</span><br><span class="line">1027</span><br><span class="line">1028</span><br><span class="line">1029</span><br><span class="line">1030</span><br><span class="line">1031</span><br><span class="line">1032</span><br><span class="line">1033</span><br><span class="line">1034</span><br><span class="line">1035</span><br><span class="line">1036</span><br><span class="line">1037</span><br><span class="line">1038</span><br><span class="line">1039</span><br><span class="line">1040</span><br><span class="line">1041</span><br><span class="line">1042</span><br><span class="line">1043</span><br><span class="line">1044</span><br><span class="line">1045</span><br><span class="line">1046</span><br><span class="line">1047</span><br><span class="line">1048</span><br><span class="line">1049</span><br><span class="line">1050</span><br><span class="line">1051</span><br><span class="line">1052</span><br><span class="line">1053</span><br><span class="line">1054</span><br><span class="line">1055</span><br><span class="line">1056</span><br><span class="line">1057</span><br><span class="line">1058</span><br><span class="line">1059</span><br><span class="line">1060</span><br><span class="line">1061</span><br><span class="line">1062</span><br><span class="line">1063</span><br><span class="line">1064</span><br><span class="line">1065</span><br><span class="line">1066</span><br><span class="line">1067</span><br><span class="line">1068</span><br><span class="line">1069</span><br><span class="line">1070</span><br><span class="line">1071</span><br><span class="line">1072</span><br><span class="line">1073</span><br><span class="line">1074</span><br><span class="line">1075</span><br><span class="line">1076</span><br><span class="line">1077</span><br><span class="line">1078</span><br><span class="line">1079</span><br><span class="line">1080</span><br><span class="line">1081</span><br><span class="line">1082</span><br><span class="line">1083</span><br><span class="line">1084</span><br><span class="line">1085</span><br><span class="line">1086</span><br><span class="line">1087</span><br><span class="line">1088</span><br><span class="line">1089</span><br><span class="line">1090</span><br><span class="line">1091</span><br><span class="line">1092</span><br><span class="line">1093</span><br><span class="line">1094</span><br><span class="line">1095</span><br><span class="line">1096</span><br><span class="line">1097</span><br><span class="line">1098</span><br><span class="line">1099</span><br><span class="line">1100</span><br><span class="line">1101</span><br><span class="line">1102</span><br><span class="line">1103</span><br><span class="line">1104</span><br><span class="line">1105</span><br><span class="line">1106</span><br><span class="line">1107</span><br><span class="line">1108</span><br><span class="line">1109</span><br><span class="line">1110</span><br><span class="line">1111</span><br><span class="line">1112</span><br><span class="line">1113</span><br><span class="line">1114</span><br><span class="line">1115</span><br><span class="line">1116</span><br><span class="line">1117</span><br><span class="line">1118</span><br><span class="line">1119</span><br><span class="line">1120</span><br><span class="line">1121</span><br><span class="line">1122</span><br><span class="line">1123</span><br><span class="line">1124</span><br><span class="line">1125</span><br><span class="line">1126</span><br><span class="line">1127</span><br><span class="line">1128</span><br><span class="line">1129</span><br><span class="line">1130</span><br><span class="line">1131</span><br><span class="line">1132</span><br><span class="line">1133</span><br><span class="line">1134</span><br><span class="line">1135</span><br><span class="line">1136</span><br><span class="line">1137</span><br><span class="line">1138</span><br><span class="line">1139</span><br><span class="line">1140</span><br><span class="line">1141</span><br><span class="line">1142</span><br><span class="line">1143</span><br><span class="line">1144</span><br><span class="line">1145</span><br><span class="line">1146</span><br><span class="line">1147</span><br><span class="line">1148</span><br><span class="line">1149</span><br><span class="line">1150</span><br><span class="line">1151</span><br><span class="line">1152</span><br><span class="line">1153</span><br><span class="line">1154</span><br><span class="line">1155</span><br><span class="line">1156</span><br><span class="line">1157</span><br><span class="line">1158</span><br><span class="line">1159</span><br><span class="line">1160</span><br><span class="line">1161</span><br><span class="line">1162</span><br><span class="line">1163</span><br><span class="line">1164</span><br><span class="line">1165</span><br><span class="line">1166</span><br><span class="line">1167</span><br><span class="line">1168</span><br><span class="line">1169</span><br><span class="line">1170</span><br><span class="line">1171</span><br><span class="line">1172</span><br><span class="line">1173</span><br><span class="line">1174</span><br><span class="line">1175</span><br><span class="line">1176</span><br><span class="line">1177</span><br><span class="line">1178</span><br><span class="line">1179</span><br><span class="line">1180</span><br><span class="line">1181</span><br><span class="line">1182</span><br><span class="line">1183</span><br><span class="line">1184</span><br><span class="line">1185</span><br><span class="line">1186</span><br><span class="line">1187</span><br><span class="line">1188</span><br><span class="line">1189</span><br><span class="line">1190</span><br><span class="line">1191</span><br><span class="line">1192</span><br><span class="line">1193</span><br><span class="line">1194</span><br><span class="line">1195</span><br><span class="line">1196</span><br><span class="line">1197</span><br><span class="line">1198</span><br><span class="line">1199</span><br><span class="line">1200</span><br><span class="line">1201</span><br><span class="line">1202</span><br><span class="line">1203</span><br><span class="line">1204</span><br><span class="line">1205</span><br><span class="line">1206</span><br><span class="line">1207</span><br><span class="line">1208</span><br><span class="line">1209</span><br><span class="line">1210</span><br><span class="line">1211</span><br><span class="line">1212</span><br><span class="line">1213</span><br><span class="line">1214</span><br><span class="line">1215</span><br><span class="line">1216</span><br><span class="line">1217</span><br><span class="line">1218</span><br><span class="line">1219</span><br><span class="line">1220</span><br><span class="line">1221</span><br><span class="line">1222</span><br><span class="line">1223</span><br><span class="line">1224</span><br><span class="line">1225</span><br><span class="line">1226</span><br><span class="line">1227</span><br><span class="line">1228</span><br><span class="line">1229</span><br><span class="line">1230</span><br><span class="line">1231</span><br><span class="line">1232</span><br><span class="line">1233</span><br><span class="line">1234</span><br><span class="line">1235</span><br><span class="line">1236</span><br><span class="line">1237</span><br><span class="line">1238</span><br><span class="line">1239</span><br><span class="line">1240</span><br><span class="line">1241</span><br><span class="line">1242</span><br><span class="line">1243</span><br><span class="line">1244</span><br><span class="line">1245</span><br><span class="line">1246</span><br><span class="line">1247</span><br><span class="line">1248</span><br><span class="line">1249</span><br><span class="line">1250</span><br><span class="line">1251</span><br><span class="line">1252</span><br><span class="line">1253</span><br><span class="line">1254</span><br><span class="line">1255</span><br><span class="line">1256</span><br><span class="line">1257</span><br><span class="line">1258</span><br><span class="line">1259</span><br><span class="line">1260</span><br><span class="line">1261</span><br><span class="line">1262</span><br><span class="line">1263</span><br><span class="line">1264</span><br><span class="line">1265</span><br><span class="line">1266</span><br><span class="line">1267</span><br><span class="line">1268</span><br><span class="line">1269</span><br><span class="line">1270</span><br><span class="line">1271</span><br><span class="line">1272</span><br><span class="line">1273</span><br><span class="line">1274</span><br><span class="line">1275</span><br><span class="line">1276</span><br><span class="line">1277</span><br><span class="line">1278</span><br><span class="line">1279</span><br><span class="line">1280</span><br><span class="line">1281</span><br><span class="line">1282</span><br><span class="line">1283</span><br><span class="line">1284</span><br><span class="line">1285</span><br><span class="line">1286</span><br><span class="line">1287</span><br><span class="line">1288</span><br><span class="line">1289</span><br><span class="line">1290</span><br><span class="line">1291</span><br><span class="line">1292</span><br><span class="line">1293</span><br><span class="line">1294</span><br><span class="line">1295</span><br><span class="line">1296</span><br><span class="line">1297</span><br><span class="line">1298</span><br><span class="line">1299</span><br><span class="line">1300</span><br><span class="line">1301</span><br><span class="line">1302</span><br><span class="line">1303</span><br><span class="line">1304</span><br><span class="line">1305</span><br><span class="line">1306</span><br><span class="line">1307</span><br><span class="line">1308</span><br><span class="line">1309</span><br><span class="line">1310</span><br><span class="line">1311</span><br><span class="line">1312</span><br><span class="line">1313</span><br><span class="line">1314</span><br><span class="line">1315</span><br><span class="line">1316</span><br><span class="line">1317</span><br><span class="line">1318</span><br><span class="line">1319</span><br><span class="line">1320</span><br><span class="line">1321</span><br><span class="line">1322</span><br><span class="line">1323</span><br><span class="line">1324</span><br><span class="line">1325</span><br><span class="line">1326</span><br><span class="line">1327</span><br><span class="line">1328</span><br><span class="line">1329</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;SoftWareScan.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;ui_SoftWareScan.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QFileDialog&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QtWidgets/QApplication&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;Windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;detours.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QMessageBox&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;qlistwidget.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;qcheckbox.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;qdatetime.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;qtablewidget.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;qlayout.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> comment(lib,<span class="meta-string">&quot;detours.lib&quot;</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> <span class="meta-keyword">warning</span>(disable:4996)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">info recvinfo;</span><br><span class="line">QListWidget* MessageList = <span class="literal">nullptr</span>;</span><br><span class="line">QListWidget* FileList = <span class="literal">nullptr</span>;</span><br><span class="line">QListWidget* HeapList = <span class="literal">nullptr</span>;</span><br><span class="line">QListWidget* RegList = <span class="literal">nullptr</span>; </span><br><span class="line">QListWidget* SocketList = <span class="literal">nullptr</span>;</span><br><span class="line">QListWidget* HeapException;</span><br><span class="line">QListWidget* FileException;</span><br><span class="line">QListWidget* RegException;</span><br><span class="line">QListWidget* SocketException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> typestr[<span class="number">25</span>][<span class="number">20</span>] = &#123; <span class="string">&quot;None&quot;</span>,<span class="string">&quot;MessageBoxA&quot;</span>,<span class="string">&quot;MessageBoxW&quot;</span>,<span class="string">&quot;CreateFile&quot;</span>,<span class="string">&quot;WriteFile&quot;</span>,<span class="string">&quot;ReadFile&quot;</span>,<span class="string">&quot;CloseHandle&quot;</span>,<span class="string">&quot;HeapCreate&quot;</span>,<span class="string">&quot;HeapDestroy&quot;</span>, <span class="string">&quot;HeapFree&quot;</span>,<span class="string">&quot;HeapAlloc&quot;</span>, <span class="string">&quot;RegCreateKeyEx&quot;</span>, <span class="string">&quot;RegSetValueEx&quot;</span>,<span class="string">&quot;RegCloseKey&quot;</span>, <span class="string">&quot;RegOpenKeyEx&quot;</span>, <span class="string">&quot;RegDeleteValue&quot;</span>, <span class="string">&quot;socket&quot;</span>,<span class="string">&quot;bind&quot;</span>, <span class="string">&quot;send&quot;</span>, <span class="string">&quot;connect&quot;</span>, <span class="string">&quot;recv&quot;</span>,<span class="string">&quot;CopyFileA&quot;</span> &#125;;</span><br><span class="line"></span><br><span class="line">SoftWareScan::<span class="built_in">SoftWareScan</span>(QWidget *parent)</span><br><span class="line">	: <span class="built_in">QWidget</span>(parent)</span><br><span class="line">&#123;</span><br><span class="line">	ui.<span class="built_in">setupUi</span>(<span class="keyword">this</span>);  </span><br><span class="line">	<span class="built_in">InitUI</span>();</span><br><span class="line">	qRegisterMetaType&lt;info&gt;(<span class="string">&quot;info&quot;</span>);<span class="comment">//构造函数中初始化注册自定义类型</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SoftWareScan::InitUI</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">//文件信息窗口</span></span><br><span class="line">	<span class="built_in">FileInfoWindow</span>();</span><br><span class="line">	<span class="comment">//API信息窗口</span></span><br><span class="line">	<span class="built_in">APIInfoWindow</span>(); </span><br><span class="line">	<span class="comment">//进程信息窗口</span></span><br><span class="line">	<span class="built_in">ProcessInfoTable</span>();</span><br><span class="line">	<span class="built_in">InitCheck</span>();</span><br><span class="line">	<span class="built_in">InitExceptionTab</span>();</span><br><span class="line">	<span class="built_in">InitJieHuo</span>();</span><br><span class="line"></span><br><span class="line">	<span class="built_in">connect</span>(&amp;threadA, <span class="built_in">SIGNAL</span>(<span class="built_in">newInfo</span>(info)), <span class="keyword">this</span>, <span class="built_in">SLOT</span>(<span class="built_in">on_threadA_newInfo</span>(info)));</span><br><span class="line">	<span class="built_in">connect</span>(&amp;threadA, <span class="built_in">SIGNAL</span>(<span class="built_in">newStatus</span>()), <span class="keyword">this</span>, <span class="built_in">SLOT</span>(<span class="built_in">on_threadA_newStatus</span>()));</span><br><span class="line">	<span class="comment">//connect(&amp;threadA, SIGNAL(newProcessInfo(PROCESS_INFORMATION)), this, SLOT(on_threadA_newProcessInfo(PROCESS_INFORMATION)));</span></span><br><span class="line">	<span class="comment">//connect(this, SIGNAL(BN_CLICKED), this, SLOT(on_Fileopen_pressed));</span></span><br><span class="line">	<span class="built_in">connect</span>(&amp;threadA, <span class="built_in">SIGNAL</span>(<span class="built_in">newProcessName</span>(QString)), <span class="keyword">this</span>, <span class="built_in">SLOT</span>(<span class="built_in">on_threadA_newProcessName</span>(QString)));</span><br><span class="line">	<span class="built_in">connect</span>(&amp;threadA, <span class="built_in">SIGNAL</span>(<span class="built_in">newProcessID</span>(<span class="keyword">int</span>)), <span class="keyword">this</span>, <span class="built_in">SLOT</span>(<span class="built_in">on_threadA_newProcessID</span>(<span class="keyword">int</span>)));</span><br><span class="line">	<span class="built_in">connect</span>(&amp;threadA, <span class="built_in">SIGNAL</span>(<span class="built_in">newProcessHandle</span>(QString)), <span class="keyword">this</span>, <span class="built_in">SLOT</span>(<span class="built_in">on_threadA_newProcessHandle</span>(QString)));</span><br><span class="line">	<span class="built_in">connect</span>(&amp;threadA, <span class="built_in">SIGNAL</span>(<span class="built_in">newHeapInfo</span>(QString)), <span class="keyword">this</span>, <span class="built_in">SLOT</span>(<span class="built_in">NewHeapInfo</span>(QString)));</span><br><span class="line">	<span class="built_in">connect</span>(&amp;threadA, <span class="built_in">SIGNAL</span>(<span class="built_in">newRegInfo</span>(<span class="keyword">int</span>, QString)), <span class="keyword">this</span>, <span class="built_in">SLOT</span>(<span class="built_in">NewRegInfo</span>(<span class="keyword">int</span>, QString)));</span><br><span class="line">	<span class="built_in">connect</span>(&amp;threadA, <span class="built_in">SIGNAL</span>(<span class="built_in">newFileInfo</span>(<span class="keyword">int</span>, QString)), <span class="keyword">this</span>, <span class="built_in">SLOT</span>(<span class="built_in">NewFileInfo</span>(<span class="keyword">int</span>, QString)));</span><br><span class="line">	<span class="built_in">connect</span>(&amp;threadA, <span class="built_in">SIGNAL</span>(<span class="built_in">newSocketInfo</span>(QString)), <span class="keyword">this</span>, <span class="built_in">SLOT</span>(<span class="built_in">NewSocketInfo</span>(QString)));</span><br><span class="line">	<span class="built_in">connect</span>(&amp;threadA, <span class="built_in">SIGNAL</span>(<span class="built_in">newHeapBlock</span>()), <span class="keyword">this</span>, <span class="built_in">SLOT</span>(<span class="built_in">NewHeapBlock</span>()));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SoftWareScan::InitJieHuo</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">//添加Tab</span></span><br><span class="line">	ui.JieHuo-&gt;<span class="built_in">addTab</span>(ui.message,<span class="built_in">QIcon</span>(<span class="string">&quot;./Resources/api_message.png&quot;</span>), QString::<span class="built_in">fromLocal8Bit</span>(<span class="string">&quot;弹窗API截获&quot;</span>));</span><br><span class="line">	ui.JieHuo-&gt;<span class="built_in">addTab</span>(ui.file, <span class="built_in">QIcon</span>(<span class="string">&quot;./Resources/api_file.png&quot;</span>), QString::<span class="built_in">fromLocal8Bit</span>(<span class="string">&quot;文件API截获&quot;</span>));</span><br><span class="line">	ui.JieHuo-&gt;<span class="built_in">addTab</span>(ui.heap, <span class="built_in">QIcon</span>(<span class="string">&quot;./Resources/api_heap.png&quot;</span>), QString::<span class="built_in">fromLocal8Bit</span>(<span class="string">&quot;堆操作API截获&quot;</span>));</span><br><span class="line">	ui.JieHuo-&gt;<span class="built_in">addTab</span>(ui.reg, <span class="built_in">QIcon</span>(<span class="string">&quot;./Resources/api_reg.png&quot;</span>), QString::<span class="built_in">fromLocal8Bit</span>(<span class="string">&quot;注册表API截获&quot;</span>));</span><br><span class="line">	ui.JieHuo-&gt;<span class="built_in">addTab</span>(ui.socket, <span class="built_in">QIcon</span>(<span class="string">&quot;./Resources/api_socket.png&quot;</span>), QString::<span class="built_in">fromLocal8Bit</span>(<span class="string">&quot;网络通信API截获&quot;</span>));</span><br><span class="line">	ui.JieHuo-&gt;<span class="built_in">setTabShape</span>(QTabWidget::Triangular);</span><br><span class="line">	<span class="comment">//弹窗标签页</span></span><br><span class="line">	QHBoxLayout* layout_h_message = <span class="keyword">new</span> <span class="built_in">QHBoxLayout</span>();</span><br><span class="line">	layout_h_message-&gt;<span class="built_in">addWidget</span>(ui.progress_message,<span class="number">0</span>,Qt::AlignCenter|Qt::AlignVCenter);</span><br><span class="line">	layout_h_message-&gt;<span class="built_in">addWidget</span>(ui.MessageCheckBox,<span class="number">0</span>,Qt::AlignCenter|Qt::AlignVCenter);</span><br><span class="line">	QHBoxLayout* layout_v_message = <span class="keyword">new</span> <span class="built_in">QHBoxLayout</span>();</span><br><span class="line">	layout_v_message-&gt;<span class="built_in">addWidget</span>(ui.MessageBoxInfo);</span><br><span class="line">	layout_v_message-&gt;<span class="built_in">setContentsMargins</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">	QVBoxLayout* layout_message = <span class="keyword">new</span> <span class="built_in">QVBoxLayout</span>();</span><br><span class="line">	layout_message-&gt;<span class="built_in">addLayout</span>(layout_h_message);</span><br><span class="line">	layout_message-&gt;<span class="built_in">addLayout</span>(layout_v_message);</span><br><span class="line">	ui.message-&gt;<span class="built_in">setLayout</span>(layout_message);</span><br><span class="line">	<span class="comment">//文件标签页</span></span><br><span class="line">	QHBoxLayout* layout_h_file = <span class="keyword">new</span> <span class="built_in">QHBoxLayout</span>();</span><br><span class="line">	layout_h_file-&gt;<span class="built_in">addWidget</span>(ui.progress_file, <span class="number">0</span>, Qt::AlignCenter | Qt::AlignVCenter);</span><br><span class="line">	layout_h_file-&gt;<span class="built_in">addWidget</span>(ui.FileCheckBox, <span class="number">0</span>, Qt::AlignCenter | Qt::AlignVCenter);</span><br><span class="line">	QHBoxLayout* layout_v_file = <span class="keyword">new</span> <span class="built_in">QHBoxLayout</span>();</span><br><span class="line">	layout_v_file-&gt;<span class="built_in">addWidget</span>(ui.FileApiInfo);</span><br><span class="line">	layout_v_file-&gt;<span class="built_in">setContentsMargins</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">	QVBoxLayout* layout_file = <span class="keyword">new</span> <span class="built_in">QVBoxLayout</span>();</span><br><span class="line">	layout_file-&gt;<span class="built_in">addLayout</span>(layout_h_file);</span><br><span class="line">	layout_file-&gt;<span class="built_in">addLayout</span>(layout_v_file);</span><br><span class="line">	ui.file-&gt;<span class="built_in">setLayout</span>(layout_file);</span><br><span class="line">	<span class="comment">//堆操作标签页</span></span><br><span class="line">	QHBoxLayout* layout_h_heap = <span class="keyword">new</span> <span class="built_in">QHBoxLayout</span>();</span><br><span class="line">	layout_h_heap-&gt;<span class="built_in">addWidget</span>(ui.progress_heap, <span class="number">0</span>, Qt::AlignCenter | Qt::AlignVCenter);</span><br><span class="line">	layout_h_heap-&gt;<span class="built_in">addWidget</span>(ui.HeapCheckBox, <span class="number">0</span>, Qt::AlignCenter | Qt::AlignVCenter);</span><br><span class="line">	QHBoxLayout* layout_v_heap = <span class="keyword">new</span> <span class="built_in">QHBoxLayout</span>();</span><br><span class="line">	layout_v_heap-&gt;<span class="built_in">addWidget</span>(ui.HeapApiInfo);</span><br><span class="line">	layout_v_heap-&gt;<span class="built_in">setContentsMargins</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">	QVBoxLayout* layout_heap = <span class="keyword">new</span> <span class="built_in">QVBoxLayout</span>();</span><br><span class="line">	layout_heap-&gt;<span class="built_in">addLayout</span>(layout_h_heap);</span><br><span class="line">	layout_heap-&gt;<span class="built_in">addLayout</span>(layout_v_heap); </span><br><span class="line">	ui.heap-&gt;<span class="built_in">setLayout</span>(layout_heap);</span><br><span class="line">	<span class="comment">//注册表标签页</span></span><br><span class="line">	QHBoxLayout* layout_h_reg = <span class="keyword">new</span> <span class="built_in">QHBoxLayout</span>();</span><br><span class="line">	layout_h_reg-&gt;<span class="built_in">addWidget</span>(ui.progress_reg, <span class="number">0</span>, Qt::AlignCenter | Qt::AlignVCenter);</span><br><span class="line">	layout_h_reg-&gt;<span class="built_in">addWidget</span>(ui.RegCheckBox, <span class="number">0</span>, Qt::AlignCenter | Qt::AlignVCenter);</span><br><span class="line">	QHBoxLayout* layout_v_reg = <span class="keyword">new</span> <span class="built_in">QHBoxLayout</span>();</span><br><span class="line">	layout_v_reg-&gt;<span class="built_in">addWidget</span>(ui.RegApiInfo);</span><br><span class="line">	layout_v_reg-&gt;<span class="built_in">setContentsMargins</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">	QVBoxLayout* layout_reg = <span class="keyword">new</span> <span class="built_in">QVBoxLayout</span>();</span><br><span class="line">	layout_reg-&gt;<span class="built_in">addLayout</span>(layout_h_reg);</span><br><span class="line">	layout_reg-&gt;<span class="built_in">addLayout</span>(layout_v_reg);</span><br><span class="line">	ui.reg-&gt;<span class="built_in">setLayout</span>(layout_reg);</span><br><span class="line">	<span class="comment">//网络通信标签页</span></span><br><span class="line">	QHBoxLayout* layout_h_socket = <span class="keyword">new</span> <span class="built_in">QHBoxLayout</span>();</span><br><span class="line">	layout_h_socket-&gt;<span class="built_in">addWidget</span>(ui.progress_socket, <span class="number">0</span>, Qt::AlignCenter | Qt::AlignVCenter);</span><br><span class="line">	layout_h_socket-&gt;<span class="built_in">addWidget</span>(ui.SocketCheckBox, <span class="number">0</span>, Qt::AlignCenter | Qt::AlignVCenter);</span><br><span class="line">	QHBoxLayout* layout_v_socket = <span class="keyword">new</span> <span class="built_in">QHBoxLayout</span>();</span><br><span class="line">	layout_v_socket-&gt;<span class="built_in">addWidget</span>(ui.SocketApiInfo);</span><br><span class="line">	layout_v_socket-&gt;<span class="built_in">setContentsMargins</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">	QVBoxLayout* layout_socket = <span class="keyword">new</span> <span class="built_in">QVBoxLayout</span>();</span><br><span class="line">	layout_socket-&gt;<span class="built_in">addLayout</span>(layout_h_socket);</span><br><span class="line">	layout_socket-&gt;<span class="built_in">addLayout</span>(layout_v_socket);</span><br><span class="line">	ui.socket-&gt;<span class="built_in">setLayout</span>(layout_socket);</span><br><span class="line"></span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SoftWareScan::InitExceptionTab</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">//样式？</span></span><br><span class="line">	ui.ApiInfo-&gt;<span class="built_in">setTabShape</span>(QTabWidget::Triangular);</span><br><span class="line">	<span class="comment">//添加Tab</span></span><br><span class="line">	ui.ApiInfo-&gt;<span class="built_in">addTab</span>(ui.Page_heap, <span class="built_in">QIcon</span>(<span class="string">&quot;./Resources/heap.png&quot;</span>), QString::<span class="built_in">fromLocal8Bit</span>(<span class="string">&quot;堆异常记录&quot;</span>));</span><br><span class="line">	ui.ApiInfo-&gt;<span class="built_in">addTab</span>(ui.Page_reg, <span class="built_in">QIcon</span>(<span class="string">&quot;./Resources/reg.png&quot;</span>), QString::<span class="built_in">fromLocal8Bit</span>(<span class="string">&quot;注册表异常记录&quot;</span>));</span><br><span class="line">	ui.ApiInfo-&gt;<span class="built_in">addTab</span>(ui.Page_file, <span class="built_in">QIcon</span>(<span class="string">&quot;./Resources/fileexception.png&quot;</span>), QString::<span class="built_in">fromLocal8Bit</span>(<span class="string">&quot;文件异常记录&quot;</span>));</span><br><span class="line">	ui.ApiInfo-&gt;<span class="built_in">addTab</span>(ui.Page_socket, <span class="built_in">QIcon</span>(<span class="string">&quot;./Resources/socket.png&quot;</span>), QString::<span class="built_in">fromLocal8Bit</span>(<span class="string">&quot;网络通信异常记录&quot;</span>));</span><br><span class="line">	<span class="comment">//堆异常标签页</span></span><br><span class="line">	QHBoxLayout* layout_heap = <span class="keyword">new</span> <span class="built_in">QHBoxLayout</span>();</span><br><span class="line">	HeapException= <span class="keyword">new</span> <span class="built_in">QListWidget</span>(ui.Page_heap);</span><br><span class="line">	HeapException-&gt;<span class="built_in">setObjectName</span>(QString::<span class="built_in">fromUtf8</span>(<span class="string">&quot;HeapException&quot;</span>));</span><br><span class="line">	layout_heap-&gt;<span class="built_in">addWidget</span>(HeapException);</span><br><span class="line">	layout_heap-&gt;<span class="built_in">setContentsMargins</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">	ui.Page_heap-&gt;<span class="built_in">setLayout</span>(layout_heap);</span><br><span class="line">	<span class="comment">//注册表异常标签页</span></span><br><span class="line">	QHBoxLayout* layout_reg = <span class="keyword">new</span> <span class="built_in">QHBoxLayout</span>();</span><br><span class="line">	RegException = <span class="keyword">new</span> <span class="built_in">QListWidget</span>(ui.Page_reg);</span><br><span class="line">	RegException-&gt;<span class="built_in">setObjectName</span>(QString::<span class="built_in">fromUtf8</span>(<span class="string">&quot;RegException&quot;</span>));</span><br><span class="line">	layout_reg-&gt;<span class="built_in">addWidget</span>(RegException);</span><br><span class="line">	layout_reg-&gt;<span class="built_in">setContentsMargins</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">	ui.Page_reg-&gt;<span class="built_in">setLayout</span>(layout_reg);</span><br><span class="line">	<span class="comment">//文件操作异常标签页</span></span><br><span class="line">	QHBoxLayout* layout_file = <span class="keyword">new</span> <span class="built_in">QHBoxLayout</span>();</span><br><span class="line">	FileException = <span class="keyword">new</span> <span class="built_in">QListWidget</span>(ui.Page_file);</span><br><span class="line">	FileException-&gt;<span class="built_in">setObjectName</span>(QString::<span class="built_in">fromLocal8Bit</span>(<span class="string">&quot;FileException&quot;</span>));</span><br><span class="line">	layout_file-&gt;<span class="built_in">addWidget</span>(FileException);</span><br><span class="line">	layout_file-&gt;<span class="built_in">setContentsMargins</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">	ui.Page_file-&gt;<span class="built_in">setLayout</span>(layout_file);</span><br><span class="line">	<span class="comment">//网络通信异常标签页</span></span><br><span class="line">	QHBoxLayout* layout_socket = <span class="keyword">new</span> <span class="built_in">QHBoxLayout</span>();</span><br><span class="line">	SocketException = <span class="keyword">new</span> <span class="built_in">QListWidget</span>(ui.Page_socket);</span><br><span class="line">	SocketException-&gt;<span class="built_in">setObjectName</span>(QString::<span class="built_in">fromLocal8Bit</span>(<span class="string">&quot;SocketException&quot;</span>));</span><br><span class="line">	layout_socket-&gt;<span class="built_in">addWidget</span>(SocketException);</span><br><span class="line">	layout_socket-&gt;<span class="built_in">setContentsMargins</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">	ui.Page_socket-&gt;<span class="built_in">setLayout</span>(layout_socket);</span><br><span class="line"></span><br><span class="line">	ui.HeapVerify-&gt;<span class="built_in">setTabShape</span>(QTabWidget::Triangular);</span><br><span class="line">	<span class="comment">//堆创建和销毁页</span></span><br><span class="line">	ui.HeapVerify-&gt;<span class="built_in">addTab</span>(ui.HeapCD, QString::<span class="built_in">fromLocal8Bit</span>(<span class="string">&quot;现存堆块&quot;</span>));</span><br><span class="line">	ui.HeapVerify-&gt;<span class="built_in">addTab</span>(ui.HeapMem, QString::<span class="built_in">fromLocal8Bit</span>(<span class="string">&quot;现存堆申请内存块&quot;</span>));</span><br><span class="line">	QHBoxLayout* layout_heapcd = <span class="keyword">new</span> <span class="built_in">QHBoxLayout</span>(ui.HeapCD);</span><br><span class="line">	layout_heapcd-&gt;<span class="built_in">addWidget</span>(ui.HeapCreateAndDestroy);</span><br><span class="line">	layout_heapcd-&gt;<span class="built_in">setContentsMargins</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">	ui.HeapCD-&gt;<span class="built_in">setLayout</span>(layout_heapcd);</span><br><span class="line">	QHBoxLayout* layout_heapmem = <span class="keyword">new</span> <span class="built_in">QHBoxLayout</span>(ui.HeapMem);</span><br><span class="line">	layout_heapmem-&gt;<span class="built_in">addWidget</span>(ui.HeapMemoryBlock);</span><br><span class="line">	layout_heapmem-&gt;<span class="built_in">setContentsMargins</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">	ui.HeapMem-&gt;<span class="built_in">setLayout</span>(layout_heapmem);</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SoftWareScan::InitCheck</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">//对于弹窗信息选择</span></span><br><span class="line">	MessageList = <span class="keyword">new</span> <span class="built_in">QListWidget</span>();</span><br><span class="line">	MessageList-&gt;<span class="built_in">setObjectName</span>(<span class="built_in">QString</span>(<span class="string">&quot;listwidget_message&quot;</span>));</span><br><span class="line">	<span class="comment">//接下来定义两个checkbox</span></span><br><span class="line">	QListWidgetItem* item1 = <span class="keyword">new</span> <span class="built_in">QListWidgetItem</span>();</span><br><span class="line">	QListWidgetItem* item2 = <span class="keyword">new</span> <span class="built_in">QListWidgetItem</span>();</span><br><span class="line">	QCheckBox* Message_A = <span class="keyword">new</span> <span class="built_in">QCheckBox</span>();</span><br><span class="line">	QCheckBox* Message_B = <span class="keyword">new</span> <span class="built_in">QCheckBox</span>();</span><br><span class="line">	Message_A-&gt;<span class="built_in">setChecked</span>(<span class="literal">true</span>);</span><br><span class="line">	Message_B-&gt;<span class="built_in">setChecked</span>(<span class="literal">true</span>);</span><br><span class="line">	Message_A-&gt;<span class="built_in">setText</span>(<span class="string">&quot;MessageBoxA&quot;</span>);</span><br><span class="line">	Message_B-&gt;<span class="built_in">setText</span>(<span class="string">&quot;MessageBoxW&quot;</span>);</span><br><span class="line">	<span class="comment">//添加checkbox</span></span><br><span class="line">	MessageList-&gt;<span class="built_in">addItem</span>(item1);</span><br><span class="line">	MessageList-&gt;<span class="built_in">addItem</span>(item2);</span><br><span class="line">	MessageList-&gt;<span class="built_in">setItemWidget</span>(item1, Message_A);</span><br><span class="line">	MessageList-&gt;<span class="built_in">setItemWidget</span>(item2, Message_B);</span><br><span class="line">	<span class="built_in">connect</span>(Message_A, <span class="built_in">SIGNAL</span>(<span class="built_in">stateChanged</span>(<span class="keyword">int</span>)), <span class="keyword">this</span>, <span class="built_in">SLOT</span>(<span class="built_in">State_MessageA</span>(<span class="keyword">int</span>)));</span><br><span class="line">	<span class="built_in">connect</span>(Message_B, <span class="built_in">SIGNAL</span>(<span class="built_in">stateChanged</span>(<span class="keyword">int</span>)), <span class="keyword">this</span>, <span class="built_in">SLOT</span>(<span class="built_in">State_MessageB</span>(<span class="keyword">int</span>)));</span><br><span class="line">	ui.MessageCheckBox-&gt;<span class="built_in">setModel</span>(MessageList-&gt;<span class="built_in">model</span>());</span><br><span class="line">	ui.MessageCheckBox-&gt;<span class="built_in">setView</span>(MessageList);</span><br><span class="line">	<span class="comment">/*ui.Progress_message-&gt;setValue(100);*/</span></span><br><span class="line">	<span class="comment">//ui.MessageCheckBox-&gt;setCurrentIndex(0);</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//对于文件API过滤</span></span><br><span class="line">	FileList = <span class="keyword">new</span> <span class="built_in">QListWidget</span>();</span><br><span class="line">	FileList-&gt;<span class="built_in">setObjectName</span>(<span class="built_in">QString</span>(<span class="string">&quot;listwidget_file&quot;</span>));</span><br><span class="line">	<span class="comment">//五个checkbox</span></span><br><span class="line">	QListWidgetItem* item3 = <span class="keyword">new</span> <span class="built_in">QListWidgetItem</span>();</span><br><span class="line">	QListWidgetItem* item4 = <span class="keyword">new</span> <span class="built_in">QListWidgetItem</span>();</span><br><span class="line">	QListWidgetItem* item5 = <span class="keyword">new</span> <span class="built_in">QListWidgetItem</span>();</span><br><span class="line">	QListWidgetItem* item6 = <span class="keyword">new</span> <span class="built_in">QListWidgetItem</span>();</span><br><span class="line">	QListWidgetItem* item21 = <span class="keyword">new</span> <span class="built_in">QListWidgetItem</span>();</span><br><span class="line">	QCheckBox* File_create = <span class="keyword">new</span> <span class="built_in">QCheckBox</span>();</span><br><span class="line">	QCheckBox* File_write = <span class="keyword">new</span> <span class="built_in">QCheckBox</span>();</span><br><span class="line">	QCheckBox* File_read = <span class="keyword">new</span> <span class="built_in">QCheckBox</span>();</span><br><span class="line">	QCheckBox* File_close = <span class="keyword">new</span> <span class="built_in">QCheckBox</span>();</span><br><span class="line">	QCheckBox* File_copy = <span class="keyword">new</span> <span class="built_in">QCheckBox</span>();</span><br><span class="line">	File_create-&gt;<span class="built_in">setChecked</span>(<span class="literal">true</span>);</span><br><span class="line">	File_write-&gt;<span class="built_in">setChecked</span>(<span class="literal">true</span>);</span><br><span class="line">	File_read-&gt;<span class="built_in">setChecked</span>(<span class="literal">true</span>);</span><br><span class="line">	File_close-&gt;<span class="built_in">setChecked</span>(<span class="literal">true</span>);</span><br><span class="line">	File_copy-&gt;<span class="built_in">setChecked</span>(<span class="literal">true</span>);</span><br><span class="line">	File_create-&gt;<span class="built_in">setText</span>(<span class="string">&quot;CreateFile&quot;</span>);</span><br><span class="line">	File_write-&gt;<span class="built_in">setText</span>(<span class="string">&quot;WriteFile&quot;</span>);</span><br><span class="line">	File_read-&gt;<span class="built_in">setText</span>(<span class="string">&quot;ReadFile&quot;</span>);</span><br><span class="line">	File_close-&gt;<span class="built_in">setText</span>(<span class="string">&quot;CloseHandle&quot;</span>);</span><br><span class="line">	File_copy-&gt;<span class="built_in">setText</span>(<span class="string">&quot;CopyFileA&quot;</span>);</span><br><span class="line">	<span class="comment">//添加checkbox</span></span><br><span class="line">	FileList-&gt;<span class="built_in">addItem</span>(item3);</span><br><span class="line">	FileList-&gt;<span class="built_in">addItem</span>(item4);</span><br><span class="line">	FileList-&gt;<span class="built_in">addItem</span>(item5);</span><br><span class="line">	FileList-&gt;<span class="built_in">addItem</span>(item6);</span><br><span class="line">	FileList-&gt;<span class="built_in">addItem</span>(item21);</span><br><span class="line">	FileList-&gt;<span class="built_in">setItemWidget</span>(item3, File_create);</span><br><span class="line">	FileList-&gt;<span class="built_in">setItemWidget</span>(item4, File_write);</span><br><span class="line">	FileList-&gt;<span class="built_in">setItemWidget</span>(item5, File_read);</span><br><span class="line">	FileList-&gt;<span class="built_in">setItemWidget</span>(item6, File_close);</span><br><span class="line">	FileList-&gt;<span class="built_in">setItemWidget</span>(item21, File_copy);</span><br><span class="line">	<span class="comment">//信号绑定</span></span><br><span class="line">	<span class="built_in">connect</span>(File_create, <span class="built_in">SIGNAL</span>(<span class="built_in">stateChanged</span>(<span class="keyword">int</span>)), <span class="keyword">this</span>, <span class="built_in">SLOT</span>(<span class="built_in">State_CreateFile</span>(<span class="keyword">int</span>)));</span><br><span class="line">	<span class="built_in">connect</span>(File_write, <span class="built_in">SIGNAL</span>(<span class="built_in">stateChanged</span>(<span class="keyword">int</span>)), <span class="keyword">this</span>, <span class="built_in">SLOT</span>(<span class="built_in">State_WriteFile</span>(<span class="keyword">int</span>)));</span><br><span class="line">	<span class="built_in">connect</span>(File_read, <span class="built_in">SIGNAL</span>(<span class="built_in">stateChanged</span>(<span class="keyword">int</span>)), <span class="keyword">this</span>, <span class="built_in">SLOT</span>(<span class="built_in">State_ReadFile</span>(<span class="keyword">int</span>)));</span><br><span class="line">	<span class="built_in">connect</span>(File_close, <span class="built_in">SIGNAL</span>(<span class="built_in">stateChanged</span>(<span class="keyword">int</span>)), <span class="keyword">this</span>, <span class="built_in">SLOT</span>(<span class="built_in">State_CloseHandle</span>(<span class="keyword">int</span>)));</span><br><span class="line">	<span class="built_in">connect</span>(File_copy, <span class="built_in">SIGNAL</span>(<span class="built_in">stateChanged</span>(<span class="keyword">int</span>)), <span class="keyword">this</span>, <span class="built_in">SLOT</span>(<span class="built_in">State_copyfilea</span>(<span class="keyword">int</span>)));</span><br><span class="line">	ui.FileCheckBox-&gt;<span class="built_in">setModel</span>(FileList-&gt;<span class="built_in">model</span>());</span><br><span class="line">	ui.FileCheckBox-&gt;<span class="built_in">setView</span>(FileList);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//对于堆操作API过滤</span></span><br><span class="line">	HeapList = <span class="keyword">new</span> <span class="built_in">QListWidget</span>();</span><br><span class="line">	HeapList-&gt;<span class="built_in">setObjectName</span>(<span class="built_in">QString</span>(<span class="string">&quot;listwidget_heap&quot;</span>));</span><br><span class="line">	<span class="comment">//四个checkbox</span></span><br><span class="line">	QListWidgetItem* item7 = <span class="keyword">new</span> <span class="built_in">QListWidgetItem</span>();</span><br><span class="line">	QListWidgetItem* item8 = <span class="keyword">new</span> <span class="built_in">QListWidgetItem</span>();</span><br><span class="line">	QListWidgetItem* item9 = <span class="keyword">new</span> <span class="built_in">QListWidgetItem</span>();</span><br><span class="line">	QListWidgetItem* item10 = <span class="keyword">new</span> <span class="built_in">QListWidgetItem</span>();</span><br><span class="line">	QCheckBox* Heap_create = <span class="keyword">new</span> <span class="built_in">QCheckBox</span>();</span><br><span class="line">	QCheckBox* Heap_destroy = <span class="keyword">new</span> <span class="built_in">QCheckBox</span>();</span><br><span class="line">	QCheckBox* Heap_free = <span class="keyword">new</span> <span class="built_in">QCheckBox</span>();</span><br><span class="line">	QCheckBox* Heap_alloc = <span class="keyword">new</span> <span class="built_in">QCheckBox</span>();</span><br><span class="line">	Heap_create-&gt;<span class="built_in">setChecked</span>(<span class="literal">true</span>);</span><br><span class="line">	Heap_destroy-&gt;<span class="built_in">setChecked</span>(<span class="literal">true</span>);</span><br><span class="line">	Heap_free-&gt;<span class="built_in">setChecked</span>(<span class="literal">true</span>);</span><br><span class="line">	Heap_alloc-&gt;<span class="built_in">setChecked</span>(<span class="literal">true</span>);</span><br><span class="line">	Heap_create-&gt;<span class="built_in">setText</span>(<span class="string">&quot;HeapCreate&quot;</span>);</span><br><span class="line">	Heap_destroy-&gt;<span class="built_in">setText</span>(<span class="string">&quot;HeapDestroy&quot;</span>);</span><br><span class="line">	Heap_free-&gt;<span class="built_in">setText</span>(<span class="string">&quot;HeapFree&quot;</span>);</span><br><span class="line">	Heap_alloc-&gt;<span class="built_in">setText</span>(<span class="string">&quot;HeapAlloc&quot;</span>);</span><br><span class="line">	<span class="comment">//添加checkbox</span></span><br><span class="line">	HeapList-&gt;<span class="built_in">addItem</span>(item7);</span><br><span class="line">	HeapList-&gt;<span class="built_in">addItem</span>(item8);</span><br><span class="line">	HeapList-&gt;<span class="built_in">addItem</span>(item9);</span><br><span class="line">	HeapList-&gt;<span class="built_in">addItem</span>(item10);</span><br><span class="line">	HeapList-&gt;<span class="built_in">setItemWidget</span>(item7, Heap_create);</span><br><span class="line">	HeapList-&gt;<span class="built_in">setItemWidget</span>(item8, Heap_destroy);</span><br><span class="line">	HeapList-&gt;<span class="built_in">setItemWidget</span>(item9, Heap_free);</span><br><span class="line">	HeapList-&gt;<span class="built_in">setItemWidget</span>(item10, Heap_alloc);</span><br><span class="line">	<span class="comment">//信号绑定</span></span><br><span class="line">	<span class="built_in">connect</span>(Heap_create, <span class="built_in">SIGNAL</span>(<span class="built_in">stateChanged</span>(<span class="keyword">int</span>)), <span class="keyword">this</span>, <span class="built_in">SLOT</span>(<span class="built_in">State_HeapCreate</span>(<span class="keyword">int</span>)));</span><br><span class="line">	<span class="built_in">connect</span>(Heap_destroy, <span class="built_in">SIGNAL</span>(<span class="built_in">stateChanged</span>(<span class="keyword">int</span>)), <span class="keyword">this</span>, <span class="built_in">SLOT</span>(<span class="built_in">State_HeapDestroy</span>(<span class="keyword">int</span>)));</span><br><span class="line">	<span class="built_in">connect</span>(Heap_free, <span class="built_in">SIGNAL</span>(<span class="built_in">stateChanged</span>(<span class="keyword">int</span>)), <span class="keyword">this</span>, <span class="built_in">SLOT</span>(<span class="built_in">State_HeapFree</span>(<span class="keyword">int</span>)));</span><br><span class="line">	<span class="built_in">connect</span>(Heap_alloc, <span class="built_in">SIGNAL</span>(<span class="built_in">stateChanged</span>(<span class="keyword">int</span>)), <span class="keyword">this</span>, <span class="built_in">SLOT</span>(<span class="built_in">State_HeapAlloc</span>(<span class="keyword">int</span>)));</span><br><span class="line">	ui.HeapCheckBox-&gt;<span class="built_in">setModel</span>(HeapList-&gt;<span class="built_in">model</span>());</span><br><span class="line">	ui.HeapCheckBox-&gt;<span class="built_in">setView</span>(HeapList);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//对于注册表API过滤</span></span><br><span class="line">	RegList = <span class="keyword">new</span> <span class="built_in">QListWidget</span>();</span><br><span class="line">	RegList-&gt;<span class="built_in">setObjectName</span>(<span class="built_in">QString</span>(<span class="string">&quot;listwidget_reg&quot;</span>));</span><br><span class="line">	<span class="comment">//5个checkbox</span></span><br><span class="line">	QListWidgetItem* item11 = <span class="keyword">new</span> <span class="built_in">QListWidgetItem</span>();</span><br><span class="line">	QListWidgetItem* item12 = <span class="keyword">new</span> <span class="built_in">QListWidgetItem</span>();</span><br><span class="line">	QListWidgetItem* item13 = <span class="keyword">new</span> <span class="built_in">QListWidgetItem</span>();</span><br><span class="line">	QListWidgetItem* item14 = <span class="keyword">new</span> <span class="built_in">QListWidgetItem</span>();</span><br><span class="line">	QListWidgetItem* item15 = <span class="keyword">new</span> <span class="built_in">QListWidgetItem</span>();</span><br><span class="line">	QCheckBox* Reg_create = <span class="keyword">new</span> <span class="built_in">QCheckBox</span>();</span><br><span class="line">	QCheckBox* Reg_setvalue = <span class="keyword">new</span> <span class="built_in">QCheckBox</span>();</span><br><span class="line">	QCheckBox* Reg_close = <span class="keyword">new</span> <span class="built_in">QCheckBox</span>();</span><br><span class="line">	QCheckBox* Reg_open = <span class="keyword">new</span> <span class="built_in">QCheckBox</span>();</span><br><span class="line">	QCheckBox* Reg_delete = <span class="keyword">new</span> <span class="built_in">QCheckBox</span>();</span><br><span class="line">	<span class="comment">//设置默认选中</span></span><br><span class="line">	Reg_create-&gt;<span class="built_in">setChecked</span>(<span class="literal">true</span>);</span><br><span class="line">	Reg_setvalue-&gt;<span class="built_in">setChecked</span>(<span class="literal">true</span>);</span><br><span class="line">	Reg_close-&gt;<span class="built_in">setChecked</span>(<span class="literal">true</span>);</span><br><span class="line">	Reg_open-&gt;<span class="built_in">setChecked</span>(<span class="literal">true</span>);</span><br><span class="line">	Reg_delete-&gt;<span class="built_in">setChecked</span>(<span class="literal">true</span>);</span><br><span class="line">	<span class="comment">//设置文本内容</span></span><br><span class="line">	Reg_create-&gt;<span class="built_in">setText</span>(<span class="string">&quot;RegCreateKeyEx&quot;</span>);</span><br><span class="line">	Reg_setvalue-&gt;<span class="built_in">setText</span>(<span class="string">&quot;RegSetValueEx&quot;</span>);</span><br><span class="line">	Reg_close-&gt;<span class="built_in">setText</span>(<span class="string">&quot;RegCloseKey&quot;</span>);</span><br><span class="line">	Reg_open-&gt;<span class="built_in">setText</span>(<span class="string">&quot;RegOpenKeyEx&quot;</span>);</span><br><span class="line">	Reg_delete-&gt;<span class="built_in">setText</span>(<span class="string">&quot;RegDeleteValue&quot;</span>);</span><br><span class="line">	<span class="comment">//添加item</span></span><br><span class="line">	RegList-&gt;<span class="built_in">addItem</span>(item11);</span><br><span class="line">	RegList-&gt;<span class="built_in">addItem</span>(item12);</span><br><span class="line">	RegList-&gt;<span class="built_in">addItem</span>(item13);</span><br><span class="line">	RegList-&gt;<span class="built_in">addItem</span>(item14);</span><br><span class="line">	RegList-&gt;<span class="built_in">addItem</span>(item15);</span><br><span class="line">	<span class="comment">//设置checkbox</span></span><br><span class="line">	RegList-&gt;<span class="built_in">setItemWidget</span>(item11, Reg_create);</span><br><span class="line">	RegList-&gt;<span class="built_in">setItemWidget</span>(item12, Reg_setvalue);</span><br><span class="line">	RegList-&gt;<span class="built_in">setItemWidget</span>(item13, Reg_close);</span><br><span class="line">	RegList-&gt;<span class="built_in">setItemWidget</span>(item14, Reg_open);</span><br><span class="line">	RegList-&gt;<span class="built_in">setItemWidget</span>(item15, Reg_delete);</span><br><span class="line">	<span class="comment">//绑定信号</span></span><br><span class="line">	<span class="built_in">connect</span>(Reg_create, <span class="built_in">SIGNAL</span>(<span class="built_in">stateChanged</span>(<span class="keyword">int</span>)), <span class="keyword">this</span>, <span class="built_in">SLOT</span>(<span class="built_in">State_RegCreateKeyEx</span>(<span class="keyword">int</span>)));</span><br><span class="line">	<span class="built_in">connect</span>(Reg_setvalue, <span class="built_in">SIGNAL</span>(<span class="built_in">stateChanged</span>(<span class="keyword">int</span>)), <span class="keyword">this</span>, <span class="built_in">SLOT</span>(<span class="built_in">State_RegSetValueEx</span>(<span class="keyword">int</span>)));</span><br><span class="line">	<span class="built_in">connect</span>(Reg_close, <span class="built_in">SIGNAL</span>(<span class="built_in">stateChanged</span>(<span class="keyword">int</span>)), <span class="keyword">this</span>, <span class="built_in">SLOT</span>(<span class="built_in">State_RegCloseKey</span>(<span class="keyword">int</span>)));</span><br><span class="line">	<span class="built_in">connect</span>(Reg_open, <span class="built_in">SIGNAL</span>(<span class="built_in">stateChanged</span>(<span class="keyword">int</span>)), <span class="keyword">this</span>, <span class="built_in">SLOT</span>(<span class="built_in">State_RegOpenKeyEx</span>(<span class="keyword">int</span>)));</span><br><span class="line">	<span class="built_in">connect</span>(Reg_delete, <span class="built_in">SIGNAL</span>(<span class="built_in">stateChanged</span>(<span class="keyword">int</span>)), <span class="keyword">this</span>, <span class="built_in">SLOT</span>(<span class="built_in">State_RegDeleteValue</span>(<span class="keyword">int</span>)));</span><br><span class="line">	<span class="comment">//修改视图</span></span><br><span class="line">	ui.RegCheckBox-&gt;<span class="built_in">setModel</span>(RegList-&gt;<span class="built_in">model</span>());</span><br><span class="line">	ui.RegCheckBox-&gt;<span class="built_in">setView</span>(RegList);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//对于网络通信</span></span><br><span class="line">	SocketList = <span class="keyword">new</span> <span class="built_in">QListWidget</span>();</span><br><span class="line">	SocketList-&gt;<span class="built_in">setObjectName</span>(<span class="built_in">QString</span>(<span class="string">&quot;listwidget_socket&quot;</span>));</span><br><span class="line">	<span class="comment">//5个checkbox</span></span><br><span class="line">	QListWidgetItem* item16 = <span class="keyword">new</span> <span class="built_in">QListWidgetItem</span>();</span><br><span class="line">	QListWidgetItem* item17 = <span class="keyword">new</span> <span class="built_in">QListWidgetItem</span>();</span><br><span class="line">	QListWidgetItem* item18 = <span class="keyword">new</span> <span class="built_in">QListWidgetItem</span>();</span><br><span class="line">	QListWidgetItem* item19 = <span class="keyword">new</span> <span class="built_in">QListWidgetItem</span>();</span><br><span class="line">	QListWidgetItem* item20 = <span class="keyword">new</span> <span class="built_in">QListWidgetItem</span>();</span><br><span class="line">	QCheckBox* Socket_socket = <span class="keyword">new</span> <span class="built_in">QCheckBox</span>();</span><br><span class="line">	QCheckBox* Socket_bind = <span class="keyword">new</span> <span class="built_in">QCheckBox</span>();</span><br><span class="line">	QCheckBox* Socket_connect = <span class="keyword">new</span> <span class="built_in">QCheckBox</span>();</span><br><span class="line">	QCheckBox* Socket_send = <span class="keyword">new</span> <span class="built_in">QCheckBox</span>();</span><br><span class="line">	QCheckBox* Socket_recv = <span class="keyword">new</span> <span class="built_in">QCheckBox</span>();</span><br><span class="line">	<span class="comment">//设置默认选中</span></span><br><span class="line">	Socket_socket-&gt;<span class="built_in">setChecked</span>(<span class="literal">true</span>);</span><br><span class="line">	Socket_bind-&gt;<span class="built_in">setChecked</span>(<span class="literal">true</span>);</span><br><span class="line">	Socket_connect-&gt;<span class="built_in">setChecked</span>(<span class="literal">true</span>);</span><br><span class="line">	Socket_send-&gt;<span class="built_in">setChecked</span>(<span class="literal">true</span>);</span><br><span class="line">	Socket_recv-&gt;<span class="built_in">setChecked</span>(<span class="literal">true</span>);</span><br><span class="line">	<span class="comment">//设置文本内容</span></span><br><span class="line">	Socket_socket-&gt;<span class="built_in">setText</span>(<span class="string">&quot;socket&quot;</span>);</span><br><span class="line">	Socket_bind-&gt;<span class="built_in">setText</span>(<span class="string">&quot;bind&quot;</span>);</span><br><span class="line">	Socket_connect-&gt;<span class="built_in">setText</span>(<span class="string">&quot;connect&quot;</span>);</span><br><span class="line">	Socket_send-&gt;<span class="built_in">setText</span>(<span class="string">&quot;send&quot;</span>);</span><br><span class="line">	Socket_recv-&gt;<span class="built_in">setText</span>(<span class="string">&quot;recv&quot;</span>);</span><br><span class="line">	<span class="comment">//添加item</span></span><br><span class="line">	SocketList-&gt;<span class="built_in">addItem</span>(item16);</span><br><span class="line">	SocketList-&gt;<span class="built_in">addItem</span>(item17);</span><br><span class="line">	SocketList-&gt;<span class="built_in">addItem</span>(item18);</span><br><span class="line">	SocketList-&gt;<span class="built_in">addItem</span>(item19);</span><br><span class="line">	SocketList-&gt;<span class="built_in">addItem</span>(item20);</span><br><span class="line">	<span class="comment">//设置checkbox</span></span><br><span class="line">	SocketList-&gt;<span class="built_in">setItemWidget</span>(item16,Socket_socket);</span><br><span class="line">	SocketList-&gt;<span class="built_in">setItemWidget</span>(item17,Socket_bind);</span><br><span class="line">	SocketList-&gt;<span class="built_in">setItemWidget</span>(item18,Socket_connect);</span><br><span class="line">	SocketList-&gt;<span class="built_in">setItemWidget</span>(item19,Socket_send);</span><br><span class="line">	SocketList-&gt;<span class="built_in">setItemWidget</span>(item20,Socket_recv);</span><br><span class="line">	<span class="comment">//绑定信号</span></span><br><span class="line">	<span class="built_in">connect</span>(Socket_socket, <span class="built_in">SIGNAL</span>(<span class="built_in">stateChanged</span>(<span class="keyword">int</span>)), <span class="keyword">this</span>, <span class="built_in">SLOT</span>(<span class="built_in">State_socket</span>(<span class="keyword">int</span>)));</span><br><span class="line">	<span class="built_in">connect</span>(Socket_bind, <span class="built_in">SIGNAL</span>(<span class="built_in">stateChanged</span>(<span class="keyword">int</span>)), <span class="keyword">this</span>, <span class="built_in">SLOT</span>(<span class="built_in">State_bind</span>(<span class="keyword">int</span>)));</span><br><span class="line">	<span class="built_in">connect</span>(Socket_connect, <span class="built_in">SIGNAL</span>(<span class="built_in">stateChanged</span>(<span class="keyword">int</span>)), <span class="keyword">this</span>, <span class="built_in">SLOT</span>(<span class="built_in">State_connect</span>(<span class="keyword">int</span>)));</span><br><span class="line">	<span class="built_in">connect</span>(Socket_send, <span class="built_in">SIGNAL</span>(<span class="built_in">stateChanged</span>(<span class="keyword">int</span>)), <span class="keyword">this</span>, <span class="built_in">SLOT</span>(<span class="built_in">State_send</span>(<span class="keyword">int</span>)));</span><br><span class="line">	<span class="built_in">connect</span>(Socket_recv, <span class="built_in">SIGNAL</span>(<span class="built_in">stateChanged</span>(<span class="keyword">int</span>)), <span class="keyword">this</span>, <span class="built_in">SLOT</span>(<span class="built_in">State_recv</span>(<span class="keyword">int</span>)));</span><br><span class="line">	<span class="comment">//修改视图</span></span><br><span class="line">	ui.SocketCheckBox-&gt;<span class="built_in">setModel</span>(SocketList-&gt;<span class="built_in">model</span>());</span><br><span class="line">	ui.SocketCheckBox-&gt;<span class="built_in">setView</span>(SocketList);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SoftWareScan::on_threadA_newStatus</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (threadA.<span class="built_in">GetStatus</span>())</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">//进程在运行</span></span><br><span class="line">		ui.ProcessStatus-&gt;<span class="built_in">setIconSize</span>(<span class="built_in">QSize</span>(<span class="number">32</span>, <span class="number">32</span>));</span><br><span class="line">		ui.ProcessStatus-&gt;<span class="built_in">setIcon</span>(<span class="built_in">QIcon</span>(<span class="string">&quot;./Resources/running.png&quot;</span>));</span><br><span class="line">		ui.ProcessStatus-&gt;<span class="built_in">setText</span>(QString::<span class="built_in">fromLocal8Bit</span>(<span class="string">&quot;进程正在运行！&quot;</span>));</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="comment">//进程停止运行</span></span><br><span class="line">		ui.ProcessStatus-&gt;<span class="built_in">setIconSize</span>(<span class="built_in">QSize</span>(<span class="number">32</span>, <span class="number">32</span>));</span><br><span class="line">		ui.ProcessStatus-&gt;<span class="built_in">setIcon</span>(<span class="built_in">QIcon</span>(<span class="string">&quot;./Resources/notrun.png&quot;</span>));</span><br><span class="line">		ui.ProcessStatus-&gt;<span class="built_in">setText</span>(QString::<span class="built_in">fromLocal8Bit</span>(<span class="string">&quot;进程停止运行！&quot;</span>));</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SoftWareScan::on_FileOpen_clicked</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	QFileDialog* f = <span class="keyword">new</span> <span class="built_in">QFileDialog</span>(<span class="keyword">this</span>);</span><br><span class="line">	f-&gt;<span class="built_in">setWindowTitle</span>(<span class="string">&quot;Select EXE File&quot;</span>);</span><br><span class="line">	f-&gt;<span class="built_in">setNameFilter</span>(<span class="string">&quot;*.exe&quot;</span>);</span><br><span class="line">	f-&gt;<span class="built_in">setViewMode</span>(QFileDialog::Detail);</span><br><span class="line"></span><br><span class="line">	QString filePath;</span><br><span class="line">	<span class="keyword">if</span> (f-&gt;<span class="built_in">exec</span>() == QDialog::Accepted)</span><br><span class="line">		filePath = f-&gt;<span class="built_in">selectedFiles</span>()[<span class="number">0</span>];</span><br><span class="line">	<span class="keyword">if</span> (filePath.<span class="built_in">isEmpty</span>())</span><br><span class="line">	&#123;</span><br><span class="line">		QMessageBox mesg;</span><br><span class="line">		mesg.<span class="built_in">warning</span>(<span class="keyword">this</span>, <span class="string">&quot;warning&quot;</span>, <span class="string">&quot;open file failed!&quot;</span>);</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		ui.FilePathShow-&gt;<span class="built_in">setText</span>(filePath);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">FileInfoShow</span>(filePath);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SoftWareScan::on_StartScan_clicked</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	QByteArray temp = ui.FilePathShow-&gt;<span class="built_in">toPlainText</span>().<span class="built_in">toLatin1</span>();</span><br><span class="line">	threadA.<span class="built_in">init</span>(temp.<span class="built_in">data</span>());</span><br><span class="line">	threadA.<span class="built_in">ModifyProcessStatus</span>(<span class="literal">true</span>);</span><br><span class="line">	threadA.<span class="built_in">start</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SoftWareScan::on_CleanInfo_clicked</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	ui.MessageBoxInfo-&gt;<span class="built_in">clear</span>();</span><br><span class="line">	ui.FileApiInfo-&gt;<span class="built_in">clear</span>();</span><br><span class="line">	ui.HeapApiInfo-&gt;<span class="built_in">clear</span>();</span><br><span class="line">	ui.RegApiInfo-&gt;<span class="built_in">clear</span>();</span><br><span class="line">	ui.SocketApiInfo-&gt;<span class="built_in">clear</span>();</span><br><span class="line">	HeapException-&gt;<span class="built_in">clear</span>();</span><br><span class="line">	RegException-&gt;<span class="built_in">clear</span>();</span><br><span class="line">	FileException-&gt;<span class="built_in">clear</span>();</span><br><span class="line">	SocketException-&gt;<span class="built_in">clear</span>();</span><br><span class="line">	ui.HeapCreateAndDestroy-&gt;<span class="built_in">clear</span>();</span><br><span class="line">	ui.HeapMemoryBlock-&gt;<span class="built_in">clear</span>();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SoftWareScan::closeEvent</span><span class="params">(QCloseEvent* event)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (threadA.<span class="built_in">isRunning</span>())</span><br><span class="line">	&#123;</span><br><span class="line">		threadA.<span class="built_in">StopThread</span>();</span><br><span class="line">		threadA.<span class="built_in">wait</span>();</span><br><span class="line">	&#125;</span><br><span class="line">	event-&gt;<span class="built_in">accept</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SoftWareScan::on_StopThread_clicked</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	threadA.<span class="built_in">StopThread</span>();</span><br><span class="line">	ui.ProcessInfoTable-&gt;<span class="built_in">item</span>(<span class="number">2</span>, <span class="number">1</span>)-&gt;<span class="built_in">setText</span>(<span class="string">&quot;NULL&quot;</span>);</span><br><span class="line">	ui.ProcessInfoTable-&gt;<span class="built_in">item</span>(<span class="number">3</span>, <span class="number">1</span>)-&gt;<span class="built_in">setText</span>(<span class="string">&quot;NULL&quot;</span>);</span><br><span class="line">	ui.ProcessInfoTable-&gt;<span class="built_in">item</span>(<span class="number">4</span>, <span class="number">1</span>)-&gt;<span class="built_in">setText</span>(<span class="string">&quot;NULL&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SoftWareScan::FileInfoWindow</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	ui.FileInfo-&gt;<span class="built_in">horizontalHeader</span>()-&gt;<span class="built_in">hide</span>();</span><br><span class="line">	ui.FileInfo-&gt;<span class="built_in">verticalHeader</span>()-&gt;<span class="built_in">hide</span>();</span><br><span class="line">	ui.FileInfo-&gt;<span class="built_in">setColumnCount</span>(<span class="number">2</span>);</span><br><span class="line">	ui.FileInfo-&gt;<span class="built_in">setColumnWidth</span>(<span class="number">0</span>, <span class="number">200</span>);</span><br><span class="line">	ui.FileInfo-&gt;<span class="built_in">setColumnWidth</span>(<span class="number">1</span>, <span class="number">400</span>);</span><br><span class="line">	ui.FileInfo-&gt;<span class="built_in">setRowCount</span>(<span class="number">6</span>);</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//ui.FileInfo-&gt;item(0, 0)-&gt;setText(&quot;File  Info  Table&quot;);</span></span><br><span class="line">	ui.FileInfo-&gt;<span class="built_in">setItem</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="keyword">new</span> <span class="built_in">QTableWidgetItem</span>(<span class="string">&quot;File  Info  Table&quot;</span>));</span><br><span class="line">	ui.FileInfo-&gt;<span class="built_in">item</span>(<span class="number">0</span>, <span class="number">0</span>)-&gt;<span class="built_in">setTextAlignment</span>(Qt::AlignCenter | Qt::AlignHCenter);</span><br><span class="line">	ui.FileInfo-&gt;<span class="built_in">item</span>(<span class="number">0</span>,<span class="number">0</span>)-&gt;<span class="built_in">setFont</span>(<span class="built_in">QFont</span>(<span class="string">&quot;song&quot;</span>, <span class="number">12</span>));</span><br><span class="line">	ui.FileInfo-&gt;<span class="built_in">item</span>(<span class="number">0</span>,<span class="number">0</span>)-&gt;<span class="built_in">setBackgroundColor</span>(Qt::gray);</span><br><span class="line"></span><br><span class="line">	ui.FileInfo-&gt;<span class="built_in">setItem</span>(<span class="number">1</span>, <span class="number">0</span>, <span class="keyword">new</span> <span class="built_in">QTableWidgetItem</span>(<span class="string">&quot;Key&quot;</span>));</span><br><span class="line">	ui.FileInfo-&gt;<span class="built_in">item</span>(<span class="number">1</span>, <span class="number">0</span>)-&gt;<span class="built_in">setTextAlignment</span>(Qt::AlignCenter | Qt::AlignHCenter);</span><br><span class="line">	ui.FileInfo-&gt;<span class="built_in">setItem</span>(<span class="number">1</span>, <span class="number">1</span>, <span class="keyword">new</span> <span class="built_in">QTableWidgetItem</span>(<span class="string">&quot;Value&quot;</span>));</span><br><span class="line">	ui.FileInfo-&gt;<span class="built_in">item</span>(<span class="number">1</span>, <span class="number">1</span>)-&gt;<span class="built_in">setTextAlignment</span>(Qt::AlignCenter | Qt::AlignHCenter);</span><br><span class="line"></span><br><span class="line">	ui.FileInfo-&gt;<span class="built_in">setEditTriggers</span>(QAbstractItemView::NoEditTriggers);</span><br><span class="line"></span><br><span class="line">	ui.FileInfo-&gt;<span class="built_in">setSpan</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SoftWareScan::FileInfoShow</span><span class="params">(QString filepath)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">QFileInfo <span class="title">info</span><span class="params">(filepath)</span></span>;</span><br><span class="line">	<span class="comment">//QTableWidget* FileInfo = new QTableWidget(5, 2);</span></span><br><span class="line">	<span class="comment">//FileInfo-&gt;resize(300, 300);</span></span><br><span class="line">	<span class="comment">//FileInfo-&gt;show();</span></span><br><span class="line">	<span class="keyword">int</span> column = ui.FileInfo-&gt;<span class="built_in">columnCount</span>();</span><br><span class="line">	<span class="keyword">int</span> row = ui.FileInfo-&gt;<span class="built_in">rowCount</span>();</span><br><span class="line"></span><br><span class="line">	QString filename = info.<span class="built_in">fileName</span>();</span><br><span class="line">	ui.FileInfo-&gt;<span class="built_in">setItem</span>(<span class="number">2</span>, <span class="number">0</span>, <span class="keyword">new</span> <span class="built_in">QTableWidgetItem</span>(<span class="string">&quot;File  Name&quot;</span>));</span><br><span class="line">	ui.FileInfo-&gt;<span class="built_in">setItem</span>(<span class="number">2</span>, <span class="number">1</span>, <span class="keyword">new</span> <span class="built_in">QTableWidgetItem</span>(filename));</span><br><span class="line">	ui.FileInfo-&gt;<span class="built_in">setItem</span>(<span class="number">3</span>, <span class="number">0</span>, <span class="keyword">new</span> <span class="built_in">QTableWidgetItem</span>(<span class="string">&quot;File  Size&quot;</span>));</span><br><span class="line">	ui.FileInfo-&gt;<span class="built_in">setItem</span>(<span class="number">3</span>, <span class="number">1</span>, <span class="keyword">new</span> <span class="built_in">QTableWidgetItem</span>(<span class="built_in">tr</span>(<span class="string">&quot;%1&quot;</span>).<span class="built_in">arg</span>(info.<span class="built_in">size</span>())));</span><br><span class="line">	threadA.<span class="built_in">GetFileSize</span>(info.<span class="built_in">size</span>());</span><br><span class="line"></span><br><span class="line">	ui.FileInfo-&gt;<span class="built_in">setItem</span>(<span class="number">4</span>, <span class="number">0</span>, <span class="keyword">new</span> <span class="built_in">QTableWidgetItem</span>(<span class="string">&quot;Create Time&quot;</span>));</span><br><span class="line">	QDateTime time = info.<span class="built_in">created</span>();</span><br><span class="line">	ui.FileInfo-&gt;<span class="built_in">setItem</span>(<span class="number">4</span>, <span class="number">1</span>, <span class="keyword">new</span> <span class="built_in">QTableWidgetItem</span>(<span class="built_in">QString</span>(<span class="string">&quot;%1&quot;</span>).<span class="built_in">arg</span>(time.<span class="built_in">toString</span>(<span class="string">&quot;yyyy-MM-dd  hh:mm:ss&quot;</span>))));</span><br><span class="line">	ui.FileInfo-&gt;<span class="built_in">setItem</span>(<span class="number">5</span>, <span class="number">0</span>, <span class="keyword">new</span> <span class="built_in">QTableWidgetItem</span>(<span class="string">&quot;Modify  Time&quot;</span>));</span><br><span class="line">	time = info.<span class="built_in">lastModified</span>();</span><br><span class="line">	ui.FileInfo-&gt;<span class="built_in">setItem</span>(<span class="number">5</span>, <span class="number">1</span>, <span class="keyword">new</span> <span class="built_in">QTableWidgetItem</span>(<span class="built_in">QString</span>(<span class="string">&quot;%1&quot;</span>).<span class="built_in">arg</span>(time.<span class="built_in">toString</span>(<span class="string">&quot;yyyy-MM-dd  hh:mm:ss&quot;</span>))));</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; row; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; column; j++)</span><br><span class="line">		&#123;</span><br><span class="line">			ui.FileInfo-&gt;<span class="built_in">item</span>(i, j)-&gt;<span class="built_in">setTextAlignment</span>(Qt::AlignCenter | Qt::AlignHCenter);</span><br><span class="line">			ui.FileInfo-&gt;<span class="built_in">item</span>(i, j)-&gt;<span class="built_in">setFont</span>(<span class="built_in">QFont</span>(<span class="string">&quot;song&quot;</span>, <span class="number">12</span>));</span><br><span class="line">			<span class="comment">//ui.FileInfo-&gt;item(i, j)-&gt;setBackgroundColor(Qt::gray);</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SoftWareScan::APIInfoWindow</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	ui.MessageBoxInfo-&gt;<span class="built_in">setColumnCount</span>(<span class="number">2</span>);</span><br><span class="line">	ui.MessageBoxInfo-&gt;<span class="built_in">setHeaderLabels</span>(<span class="built_in">QStringList</span>() &lt;&lt; <span class="string">&quot;Key&quot;</span> &lt;&lt; <span class="string">&quot;Value&quot;</span>);</span><br><span class="line"></span><br><span class="line">	ui.MessageBoxInfo-&gt;<span class="built_in">setEditTriggers</span>(QTreeView::NoEditTriggers);			<span class="comment">//单元格不能编辑</span></span><br><span class="line">	ui.MessageBoxInfo-&gt;<span class="built_in">setSelectionBehavior</span>(QTreeView::SelectRows);			<span class="comment">//一次选中整行</span></span><br><span class="line">	ui.MessageBoxInfo-&gt;<span class="built_in">setSelectionMode</span>(QTreeView::SingleSelection);        <span class="comment">//单选，配合上面的整行就是一次选单行</span></span><br><span class="line">	ui.MessageBoxInfo-&gt;<span class="built_in">setAlternatingRowColors</span>(<span class="literal">true</span>);                       <span class="comment">//每间隔一行颜色不一样，当有qss时该属性无效</span></span><br><span class="line">	ui.MessageBoxInfo-&gt;<span class="built_in">setFocusPolicy</span>(Qt::NoFocus);</span><br><span class="line">	ui.MessageBoxInfo-&gt;<span class="built_in">setColumnWidth</span>(<span class="number">0</span>, <span class="number">300</span>);</span><br><span class="line"></span><br><span class="line">	ui.MessageBoxInfo-&gt;<span class="built_in">header</span>()-&gt;<span class="built_in">setStretchLastSection</span>(<span class="literal">true</span>);               <span class="comment">//最后一列自适应宽度</span></span><br><span class="line">	ui.MessageBoxInfo-&gt;<span class="built_in">header</span>()-&gt;<span class="built_in">setDefaultAlignment</span>(Qt::AlignCenter);      <span class="comment">//列头文字默认居中对齐</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//ui.MessageBoxHeader-&gt;setText(QString::fromLocal8Bit(&quot;弹窗信息栏&quot;));</span></span><br><span class="line">	ui.FileApiInfo-&gt;<span class="built_in">setColumnCount</span>(<span class="number">2</span>);</span><br><span class="line">	ui.FileApiInfo-&gt;<span class="built_in">setHeaderLabels</span>(<span class="built_in">QStringList</span>() &lt;&lt; <span class="string">&quot;Key&quot;</span> &lt;&lt; <span class="string">&quot;Value&quot;</span>);</span><br><span class="line">	ui.FileApiInfo-&gt;<span class="built_in">setEditTriggers</span>(QTreeView::NoEditTriggers);			<span class="comment">//单元格不能编辑</span></span><br><span class="line">	ui.FileApiInfo-&gt;<span class="built_in">setSelectionBehavior</span>(QTreeView::SelectRows);			<span class="comment">//一次选中整行</span></span><br><span class="line">	ui.FileApiInfo-&gt;<span class="built_in">setSelectionMode</span>(QTreeView::SingleSelection);        <span class="comment">//单选，配合上面的整行就是一次选单行</span></span><br><span class="line">	ui.FileApiInfo-&gt;<span class="built_in">setAlternatingRowColors</span>(<span class="literal">true</span>);                       <span class="comment">//每间隔一行颜色不一样，当有qss时该属性无效</span></span><br><span class="line">	ui.FileApiInfo-&gt;<span class="built_in">setFocusPolicy</span>(Qt::NoFocus);</span><br><span class="line">	ui.FileApiInfo-&gt;<span class="built_in">setColumnWidth</span>(<span class="number">0</span>, <span class="number">300</span>);</span><br><span class="line">	ui.FileApiInfo-&gt;<span class="built_in">header</span>()-&gt;<span class="built_in">setStretchLastSection</span>(<span class="literal">true</span>);               <span class="comment">//最后一列自适应宽度</span></span><br><span class="line">	ui.FileApiInfo-&gt;<span class="built_in">header</span>()-&gt;<span class="built_in">setDefaultAlignment</span>(Qt::AlignCenter);      <span class="comment">//列头文字默认居中对齐</span></span><br><span class="line">	</span><br><span class="line">	ui.HeapApiInfo-&gt;<span class="built_in">setColumnCount</span>(<span class="number">2</span>);</span><br><span class="line">	ui.HeapApiInfo-&gt;<span class="built_in">setHeaderLabels</span>(<span class="built_in">QStringList</span>() &lt;&lt; <span class="string">&quot;Key&quot;</span> &lt;&lt; <span class="string">&quot;Value&quot;</span>);</span><br><span class="line">	ui.HeapApiInfo-&gt;<span class="built_in">setEditTriggers</span>(QTreeView::NoEditTriggers);			<span class="comment">//单元格不能编辑</span></span><br><span class="line">	ui.HeapApiInfo-&gt;<span class="built_in">setSelectionBehavior</span>(QTreeView::SelectRows);			<span class="comment">//一次选中整行</span></span><br><span class="line">	ui.HeapApiInfo-&gt;<span class="built_in">setSelectionMode</span>(QTreeView::SingleSelection);        <span class="comment">//单选，配合上面的整行就是一次选单行</span></span><br><span class="line">	ui.HeapApiInfo-&gt;<span class="built_in">setAlternatingRowColors</span>(<span class="literal">true</span>);                       <span class="comment">//每间隔一行颜色不一样，当有qss时该属性无效</span></span><br><span class="line">	ui.HeapApiInfo-&gt;<span class="built_in">setFocusPolicy</span>(Qt::NoFocus);</span><br><span class="line">	ui.HeapApiInfo-&gt;<span class="built_in">setColumnWidth</span>(<span class="number">0</span>, <span class="number">300</span>);</span><br><span class="line">	ui.HeapApiInfo-&gt;<span class="built_in">header</span>()-&gt;<span class="built_in">setStretchLastSection</span>(<span class="literal">true</span>);               <span class="comment">//最后一列自适应宽度</span></span><br><span class="line">	ui.HeapApiInfo-&gt;<span class="built_in">header</span>()-&gt;<span class="built_in">setDefaultAlignment</span>(Qt::AlignCenter);      <span class="comment">//列头文字默认居中对齐</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	ui.RegApiInfo-&gt;<span class="built_in">setColumnCount</span>(<span class="number">2</span>);</span><br><span class="line">	ui.RegApiInfo-&gt;<span class="built_in">setHeaderLabels</span>(<span class="built_in">QStringList</span>() &lt;&lt; <span class="string">&quot;Key&quot;</span> &lt;&lt; <span class="string">&quot;Value&quot;</span>);</span><br><span class="line">	ui.RegApiInfo-&gt;<span class="built_in">setEditTriggers</span>(QTreeView::NoEditTriggers);			<span class="comment">//单元格不能编辑</span></span><br><span class="line">	ui.RegApiInfo-&gt;<span class="built_in">setSelectionBehavior</span>(QTreeView::SelectRows);			<span class="comment">//一次选中整行</span></span><br><span class="line">	ui.RegApiInfo-&gt;<span class="built_in">setSelectionMode</span>(QTreeView::SingleSelection);        <span class="comment">//单选，配合上面的整行就是一次选单行</span></span><br><span class="line">	ui.RegApiInfo-&gt;<span class="built_in">setAlternatingRowColors</span>(<span class="literal">true</span>);                       <span class="comment">//每间隔一行颜色不一样，当有qss时该属性无效</span></span><br><span class="line">	ui.RegApiInfo-&gt;<span class="built_in">setFocusPolicy</span>(Qt::NoFocus);</span><br><span class="line">	ui.RegApiInfo-&gt;<span class="built_in">setColumnWidth</span>(<span class="number">0</span>, <span class="number">300</span>);</span><br><span class="line">	ui.RegApiInfo-&gt;<span class="built_in">header</span>()-&gt;<span class="built_in">setStretchLastSection</span>(<span class="literal">true</span>);               <span class="comment">//最后一列自适应宽度</span></span><br><span class="line">	ui.RegApiInfo-&gt;<span class="built_in">header</span>()-&gt;<span class="built_in">setDefaultAlignment</span>(Qt::AlignCenter);      <span class="comment">//列头文字默认居中对齐</span></span><br><span class="line"></span><br><span class="line">	ui.SocketApiInfo-&gt;<span class="built_in">setColumnCount</span>(<span class="number">2</span>);</span><br><span class="line">	ui.SocketApiInfo-&gt;<span class="built_in">setHeaderLabels</span>(<span class="built_in">QStringList</span>() &lt;&lt; <span class="string">&quot;Key&quot;</span> &lt;&lt; <span class="string">&quot;Value&quot;</span>);</span><br><span class="line">	ui.SocketApiInfo-&gt;<span class="built_in">setEditTriggers</span>(QTreeView::NoEditTriggers);			<span class="comment">//单元格不能编辑</span></span><br><span class="line">	ui.SocketApiInfo-&gt;<span class="built_in">setSelectionBehavior</span>(QTreeView::SelectRows);			<span class="comment">//一次选中整行</span></span><br><span class="line">	ui.SocketApiInfo-&gt;<span class="built_in">setSelectionMode</span>(QTreeView::SingleSelection);        <span class="comment">//单选，配合上面的整行就是一次选单行</span></span><br><span class="line">	ui.SocketApiInfo-&gt;<span class="built_in">setAlternatingRowColors</span>(<span class="literal">true</span>);                       <span class="comment">//每间隔一行颜色不一样，当有qss时该属性无效</span></span><br><span class="line">	ui.SocketApiInfo-&gt;<span class="built_in">setFocusPolicy</span>(Qt::NoFocus);</span><br><span class="line">	ui.SocketApiInfo-&gt;<span class="built_in">setColumnWidth</span>(<span class="number">0</span>, <span class="number">300</span>);</span><br><span class="line">	ui.SocketApiInfo-&gt;<span class="built_in">header</span>()-&gt;<span class="built_in">setStretchLastSection</span>(<span class="literal">true</span>);               <span class="comment">//最后一列自适应宽度</span></span><br><span class="line">	ui.SocketApiInfo-&gt;<span class="built_in">header</span>()-&gt;<span class="built_in">setDefaultAlignment</span>(Qt::AlignCenter);      <span class="comment">//列头文字默认居中对齐</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SoftWareScan::ProcessInfoTable</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> column = <span class="number">2</span>;</span><br><span class="line">	<span class="keyword">int</span> row = <span class="number">5</span>;</span><br><span class="line">	ui.ProcessInfoTable-&gt;<span class="built_in">setColumnCount</span>(column);</span><br><span class="line">	ui.ProcessInfoTable-&gt;<span class="built_in">setRowCount</span>(row);</span><br><span class="line">	ui.ProcessInfoTable-&gt;<span class="built_in">verticalHeader</span>()-&gt;<span class="built_in">hide</span>();</span><br><span class="line">	ui.ProcessInfoTable-&gt;<span class="built_in">horizontalHeader</span>()-&gt;<span class="built_in">hide</span>();</span><br><span class="line">	ui.ProcessInfoTable-&gt;<span class="built_in">setColumnWidth</span>(<span class="number">0</span>, <span class="number">100</span>);</span><br><span class="line">	ui.ProcessInfoTable-&gt;<span class="built_in">setColumnWidth</span>(<span class="number">1</span>, <span class="number">200</span>);</span><br><span class="line"></span><br><span class="line">	ui.ProcessInfoTable-&gt;<span class="built_in">setItem</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="keyword">new</span> <span class="built_in">QTableWidgetItem</span>(QString::<span class="built_in">fromLocal8Bit</span>(<span class="string">&quot;进程信息栏&quot;</span>)));</span><br><span class="line">	ui.ProcessInfoTable-&gt;<span class="built_in">item</span>(<span class="number">0</span>, <span class="number">0</span>)-&gt;<span class="built_in">setTextAlignment</span>(Qt::AlignCenter | Qt::AlignHCenter);</span><br><span class="line">	ui.ProcessInfoTable-&gt;<span class="built_in">item</span>(<span class="number">0</span>, <span class="number">0</span>)-&gt;<span class="built_in">setBackgroundColor</span>(Qt::gray);</span><br><span class="line">	ui.ProcessInfoTable-&gt;<span class="built_in">setSpan</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">	ui.ProcessInfoTable-&gt;<span class="built_in">setItem</span>(<span class="number">1</span>, <span class="number">0</span>, <span class="keyword">new</span> <span class="built_in">QTableWidgetItem</span>(<span class="string">&quot;Key&quot;</span>));</span><br><span class="line">	ui.ProcessInfoTable-&gt;<span class="built_in">setItem</span>(<span class="number">1</span>, <span class="number">1</span>, <span class="keyword">new</span> <span class="built_in">QTableWidgetItem</span>(<span class="string">&quot;Value&quot;</span>));</span><br><span class="line">	ui.ProcessInfoTable-&gt;<span class="built_in">item</span>(<span class="number">1</span>, <span class="number">0</span>)-&gt;<span class="built_in">setTextAlignment</span>(Qt::AlignCenter | Qt::AlignHCenter);</span><br><span class="line">	ui.ProcessInfoTable-&gt;<span class="built_in">item</span>(<span class="number">1</span>,<span class="number">1</span>)-&gt;<span class="built_in">setTextAlignment</span>(Qt::AlignCenter | Qt::AlignHCenter);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//进程信息窗口中Key栏</span></span><br><span class="line">	ui.ProcessInfoTable-&gt;<span class="built_in">setItem</span>(<span class="number">2</span>, <span class="number">0</span>, <span class="keyword">new</span> <span class="built_in">QTableWidgetItem</span>(QString::<span class="built_in">fromLocal8Bit</span>(<span class="string">&quot;进程名称&quot;</span>)));</span><br><span class="line">	ui.ProcessInfoTable-&gt;<span class="built_in">setItem</span>(<span class="number">3</span>, <span class="number">0</span>, <span class="keyword">new</span> <span class="built_in">QTableWidgetItem</span>(QString::<span class="built_in">fromLocal8Bit</span>(<span class="string">&quot;进程句柄&quot;</span>)));</span><br><span class="line">	ui.ProcessInfoTable-&gt;<span class="built_in">setItem</span>(<span class="number">4</span>, <span class="number">0</span>, <span class="keyword">new</span> <span class="built_in">QTableWidgetItem</span>(QString::<span class="built_in">fromLocal8Bit</span>(<span class="string">&quot;进程ID&quot;</span>)));</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; row; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		ui.ProcessInfoTable-&gt;<span class="built_in">item</span>(i, <span class="number">0</span>)-&gt;<span class="built_in">setTextAlignment</span>(Qt::AlignCenter | Qt::AlignHCenter);</span><br><span class="line">		ui.ProcessInfoTable-&gt;<span class="built_in">setItem</span>(i, <span class="number">1</span>, <span class="keyword">new</span> <span class="built_in">QTableWidgetItem</span>(<span class="string">&quot;NULL&quot;</span>));</span><br><span class="line">		ui.ProcessInfoTable-&gt;<span class="built_in">item</span>(i, <span class="number">1</span>)-&gt;<span class="built_in">setTextAlignment</span>(Qt::AlignCenter | Qt::AlignHCenter);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SoftWareScan::on_threadA_newInfo</span><span class="params">(info tempInfo)</span><span class="comment">//往窗口中写入信息</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">//从recvinfo中提取信息并创建树形结构</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//测试</span></span><br><span class="line">	<span class="comment">/*FILE* f = fopen(&quot;log.txt&quot;, &quot;a+&quot;);</span></span><br><span class="line"><span class="comment">	fprintf(f, &quot;%s:%s\n%s:%s\n%s:%s\n%s:%s\n&quot;, recvinfo.Name[0], recvinfo.Value[0], recvinfo.Name[1], recvinfo.Value[1], recvinfo.Name[2], recvinfo.Value[2], recvinfo.Name[3], recvinfo.Value[3]);</span></span><br><span class="line"><span class="comment">	fclose(f);*/</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//定义局部变量来接受recvinfo</span></span><br><span class="line">	<span class="comment">//info tempInfo= recvinfo;</span></span><br><span class="line">	QTreeWidgetItem* t = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>();</span><br><span class="line">	t-&gt;<span class="built_in">setData</span>(<span class="number">0</span>, <span class="number">0</span>, typestr[tempInfo.type]);</span><br><span class="line">	<span class="comment">//t-&gt;setData(0, 0, &quot;TEST&quot;);</span></span><br><span class="line">	<span class="keyword">char</span> time[<span class="number">128</span>] = <span class="string">&quot;&quot;</span>;</span><br><span class="line">	<span class="built_in">sprintf</span>(time, <span class="string">&quot;%d-%d-%d %-02d:%-02d:%-d:%-ds&quot;</span>, tempInfo.st.wYear, tempInfo.st.wMonth, tempInfo.st.wDay, tempInfo.st.wHour, tempInfo.st.wMinute, tempInfo.st.wSecond, tempInfo.st.wMilliseconds);</span><br><span class="line">	t-&gt;<span class="built_in">setData</span>(<span class="number">1</span>, <span class="number">0</span>, time);</span><br><span class="line">	t-&gt;<span class="built_in">setTextAlignment</span>(<span class="number">1</span>, Qt::AlignCenter | Qt::AlignHCenter);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tempInfo.Num; i++)</span><br><span class="line">	&#123;<span class="comment">//遍历其所有参数进行添加</span></span><br><span class="line">		QTreeWidgetItem* item = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>();</span><br><span class="line">		item-&gt;<span class="built_in">setData</span>(<span class="number">0</span>, <span class="number">0</span>, QString::<span class="built_in">fromLocal8Bit</span>(tempInfo.Name[i]));</span><br><span class="line">		item-&gt;<span class="built_in">setData</span>(<span class="number">1</span>, <span class="number">0</span>, QString::<span class="built_in">fromLocal8Bit</span>(tempInfo.Value[i]));</span><br><span class="line">		item-&gt;<span class="built_in">setTextAlignment</span>(<span class="number">0</span>,Qt::AlignCenter | Qt::AlignHCenter);</span><br><span class="line">		item-&gt;<span class="built_in">setTextAlignment</span>(<span class="number">1</span>, Qt::AlignCenter | Qt::AlignHCenter);</span><br><span class="line"></span><br><span class="line">		t-&gt;<span class="built_in">addChild</span>(item);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">int</span> temp = tempInfo.type;</span><br><span class="line">	<span class="comment">//判断是何种信息</span></span><br><span class="line">	<span class="keyword">if</span> ((temp == MESSAGEBOXA) || (temp == MESSAGEBOXW))</span><br><span class="line">	&#123;</span><br><span class="line">		ui.MessageBoxInfo-&gt;<span class="built_in">addTopLevelItem</span>(t);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span>((temp==CREATEFILE)||(temp==WRITEFILE)||(temp==READFILE)|| (temp==CLOSEHANDLE)||(temp==COPYFILEA))</span><br><span class="line">	&#123;</span><br><span class="line">		ui.FileApiInfo-&gt;<span class="built_in">addTopLevelItem</span>(t);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span> ((temp == HEAPCREATE)||(temp==HEAPDESTROY)||(temp==HEAPFREE)||(temp==HEAPALLOC))</span><br><span class="line">	&#123;</span><br><span class="line">		ui.HeapApiInfo-&gt;<span class="built_in">addTopLevelItem</span>(t);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span> ((temp == REGCREATEKEYEX) || (temp == REGCLOSEKEY) || (temp == REGSETVALUEEX) || (temp == REGOPENKEYEX) || (temp == REGDELETEVALUE))</span><br><span class="line">	&#123;</span><br><span class="line">		ui.RegApiInfo-&gt;<span class="built_in">addTopLevelItem</span>(t);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span>((temp==THESOCKET)||(temp==BIND)||(temp==SEND)||(temp==CONNECT)||(temp==RECV))</span><br><span class="line">	<span class="comment">/*else*/</span></span><br><span class="line">	&#123;<span class="comment">//test</span></span><br><span class="line">		<span class="comment">/*FILE* f = fopen(&quot;test.txt&quot;, &quot;a+&quot;);</span></span><br><span class="line"><span class="comment">		fprintf(f, &quot;%d\n&quot;, temp);</span></span><br><span class="line"><span class="comment">		fclose(f);*/</span></span><br><span class="line">		<span class="comment">//20210915  11:30无法收到recv和send的数据包</span></span><br><span class="line">		ui.SocketApiInfo-&gt;<span class="built_in">addTopLevelItem</span>(t);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SoftWareScan::on_threadA_newProcessName</span><span class="params">(QString str)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	ui.ProcessInfoTable-&gt;<span class="built_in">item</span>(<span class="number">2</span>, <span class="number">1</span>)-&gt;<span class="built_in">setText</span>(str);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SoftWareScan::on_threadA_newProcessID</span><span class="params">(<span class="keyword">int</span> id)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	ui.ProcessInfoTable-&gt;<span class="built_in">item</span>(<span class="number">4</span>, <span class="number">1</span>)-&gt;<span class="built_in">setText</span>(QString::<span class="built_in">number</span>(id));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SoftWareScan::on_threadA_newProcessHandle</span><span class="params">(QString str)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	ui.ProcessInfoTable-&gt;<span class="built_in">item</span>(<span class="number">3</span>, <span class="number">1</span>)-&gt;<span class="built_in">setText</span>(str);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//关于checkbox信号变化的函数</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SoftWareScan::State_MessageA</span><span class="params">(<span class="keyword">int</span> state)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">//test</span></span><br><span class="line">	<span class="comment">/*FILE* f = fopen(&quot;test.txt&quot;, &quot;a+&quot;);</span></span><br><span class="line"><span class="comment">	fprintf(f, &quot;成功到达槽函数！&quot;);</span></span><br><span class="line"><span class="comment">	fclose(f);*/</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//拿到该checkbox</span></span><br><span class="line">	<span class="comment">/*QObject* object = QObject::sender();</span></span><br><span class="line"><span class="comment">	QCheckBox* pSenderCheckBox = static_cast&lt;QCheckBox*&gt;(object);</span></span><br><span class="line"><span class="comment">	QListWidgetItem* item = MessageList-&gt;item(0);</span></span><br><span class="line"><span class="comment">	QWidget* pwidget = MessageList-&gt;itemWidget(item);</span></span><br><span class="line"><span class="comment">	QCheckBox* ckb = (QCheckBox*)pwidget;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	QTreeWidgetItemIterator it(ui.MessageBoxInfo);</span></span><br><span class="line"><span class="comment">	while (*it)</span></span><br><span class="line"><span class="comment">	&#123;</span></span><br><span class="line"><span class="comment">		if ((*it)-&gt;text(0) == &quot;MessageBoxA&quot;)</span></span><br><span class="line"><span class="comment">		&#123;</span></span><br><span class="line"><span class="comment">			if (ckb-&gt;isChecked()) &#123;</span></span><br><span class="line"><span class="comment">				(*it)-&gt;setHidden(false);</span></span><br><span class="line"><span class="comment">			&#125;</span></span><br><span class="line"><span class="comment">			else &#123;</span></span><br><span class="line"><span class="comment">				(*it)-&gt;setHidden(true);</span></span><br><span class="line"><span class="comment">			&#125;</span></span><br><span class="line"><span class="comment">		&#125;</span></span><br><span class="line"><span class="comment">		++it;</span></span><br><span class="line"><span class="comment">	&#125;*/</span></span><br><span class="line">	<span class="function">QTreeWidgetItemIterator <span class="title">it</span><span class="params">(ui.MessageBoxInfo)</span></span>;</span><br><span class="line">	<span class="keyword">while</span> (*it)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> ((*it)-&gt;<span class="built_in">text</span>(<span class="number">0</span>) == <span class="string">&quot;MessageBoxA&quot;</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> (state == Qt::Checked)</span><br><span class="line">			&#123;</span><br><span class="line">				(*it)-&gt;<span class="built_in">setHidden</span>(<span class="literal">false</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> &#123;</span><br><span class="line">				(*it)-&gt;<span class="built_in">setHidden</span>(<span class="literal">true</span>);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		++it;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">ProgressBar</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SoftWareScan::State_MessageB</span><span class="params">(<span class="keyword">int</span> state)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">QTreeWidgetItemIterator <span class="title">it</span><span class="params">(ui.MessageBoxInfo)</span></span>;</span><br><span class="line">	<span class="keyword">while</span> (*it)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> ((*it)-&gt;<span class="built_in">text</span>(<span class="number">0</span>) == <span class="string">&quot;MessageBoxW&quot;</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> (state==Qt::Checked) &#123;</span><br><span class="line">				(*it)-&gt;<span class="built_in">setHidden</span>(<span class="literal">false</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> &#123;</span><br><span class="line">				(*it)-&gt;<span class="built_in">setHidden</span>(<span class="literal">true</span>);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		++it;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">ProgressBar</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SoftWareScan::State_CreateFile</span><span class="params">(<span class="keyword">int</span> state)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">QTreeWidgetItemIterator <span class="title">it</span><span class="params">(ui.FileApiInfo)</span></span>;</span><br><span class="line">	<span class="keyword">while</span> (*it)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> ((*it)-&gt;<span class="built_in">text</span>(<span class="number">0</span>) == <span class="string">&quot;CreateFile&quot;</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> (state == Qt::Checked)</span><br><span class="line">			&#123;</span><br><span class="line">				(*it)-&gt;<span class="built_in">setHidden</span>(<span class="literal">false</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> &#123;</span><br><span class="line">				(*it)-&gt;<span class="built_in">setHidden</span>(<span class="literal">true</span>);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		++it;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">ProgressBar</span>(<span class="number">2</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SoftWareScan::State_WriteFile</span><span class="params">(<span class="keyword">int</span> state)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">QTreeWidgetItemIterator <span class="title">it</span><span class="params">(ui.FileApiInfo)</span></span>;</span><br><span class="line">	<span class="keyword">while</span> (*it)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> ((*it)-&gt;<span class="built_in">text</span>(<span class="number">0</span>) == <span class="string">&quot;WriteFile&quot;</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> (state == Qt::Checked)</span><br><span class="line">			&#123;</span><br><span class="line">				(*it)-&gt;<span class="built_in">setHidden</span>(<span class="literal">false</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> &#123;</span><br><span class="line">				(*it)-&gt;<span class="built_in">setHidden</span>(<span class="literal">true</span>);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		++it;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">ProgressBar</span>(<span class="number">2</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SoftWareScan::State_ReadFile</span><span class="params">(<span class="keyword">int</span> state)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">QTreeWidgetItemIterator <span class="title">it</span><span class="params">(ui.FileApiInfo)</span></span>;</span><br><span class="line">	<span class="keyword">while</span> (*it)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> ((*it)-&gt;<span class="built_in">text</span>(<span class="number">0</span>) == <span class="string">&quot;ReadFile&quot;</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> (state == Qt::Checked)</span><br><span class="line">			&#123;</span><br><span class="line">				(*it)-&gt;<span class="built_in">setHidden</span>(<span class="literal">false</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> &#123;</span><br><span class="line">				(*it)-&gt;<span class="built_in">setHidden</span>(<span class="literal">true</span>);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		++it;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">ProgressBar</span>(<span class="number">2</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SoftWareScan::State_CloseHandle</span><span class="params">(<span class="keyword">int</span> state)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">QTreeWidgetItemIterator <span class="title">it</span><span class="params">(ui.FileApiInfo)</span></span>;</span><br><span class="line">	<span class="keyword">while</span> (*it)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> ((*it)-&gt;<span class="built_in">text</span>(<span class="number">0</span>) == <span class="string">&quot;CloseHandle&quot;</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> (state == Qt::Checked)</span><br><span class="line">			&#123;</span><br><span class="line">				(*it)-&gt;<span class="built_in">setHidden</span>(<span class="literal">false</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> &#123;</span><br><span class="line">				(*it)-&gt;<span class="built_in">setHidden</span>(<span class="literal">true</span>);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		++it;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">ProgressBar</span>(<span class="number">2</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SoftWareScan::State_copyfilea</span><span class="params">(<span class="keyword">int</span> state)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">QTreeWidgetItemIterator <span class="title">it</span><span class="params">(ui.FileApiInfo)</span></span>;</span><br><span class="line">	<span class="keyword">while</span> (*it)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> ((*it)-&gt;<span class="built_in">text</span>(<span class="number">0</span>) == <span class="string">&quot;CopyFileA&quot;</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> (state == Qt::Checked)</span><br><span class="line">			&#123;</span><br><span class="line">				(*it)-&gt;<span class="built_in">setHidden</span>(<span class="literal">false</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> &#123;</span><br><span class="line">				(*it)-&gt;<span class="built_in">setHidden</span>(<span class="literal">true</span>);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		++it;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">ProgressBar</span>(<span class="number">2</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SoftWareScan::State_HeapCreate</span><span class="params">(<span class="keyword">int</span> state)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">QTreeWidgetItemIterator <span class="title">it</span><span class="params">(ui.HeapApiInfo)</span></span>;</span><br><span class="line">	<span class="keyword">while</span> (*it)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> ((*it)-&gt;<span class="built_in">text</span>(<span class="number">0</span>) == <span class="string">&quot;HeapCreate&quot;</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> (state == Qt::Checked)</span><br><span class="line">				(*it)-&gt;<span class="built_in">setHidden</span>(<span class="literal">false</span>);</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">				(*it)-&gt;<span class="built_in">setHidden</span>(<span class="literal">true</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		++it;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">ProgressBar</span>(<span class="number">3</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SoftWareScan::State_HeapDestroy</span><span class="params">(<span class="keyword">int</span> state)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">QTreeWidgetItemIterator <span class="title">it</span><span class="params">(ui.HeapApiInfo)</span></span>;</span><br><span class="line">	<span class="keyword">while</span> (*it)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> ((*it)-&gt;<span class="built_in">text</span>(<span class="number">0</span>) == <span class="string">&quot;HeapDestroy&quot;</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> (state == Qt::Checked)</span><br><span class="line">				(*it)-&gt;<span class="built_in">setHidden</span>(<span class="literal">false</span>);</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">				(*it)-&gt;<span class="built_in">setHidden</span>(<span class="literal">true</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		++it;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">ProgressBar</span>(<span class="number">3</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SoftWareScan::State_HeapFree</span><span class="params">(<span class="keyword">int</span> state)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">QTreeWidgetItemIterator <span class="title">it</span><span class="params">(ui.HeapApiInfo)</span></span>;</span><br><span class="line">	<span class="keyword">while</span> (*it)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> ((*it)-&gt;<span class="built_in">text</span>(<span class="number">0</span>) == <span class="string">&quot;HeapFree&quot;</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> (state == Qt::Checked)</span><br><span class="line">				(*it)-&gt;<span class="built_in">setHidden</span>(<span class="literal">false</span>);</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">				(*it)-&gt;<span class="built_in">setHidden</span>(<span class="literal">true</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		++it;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">ProgressBar</span>(<span class="number">3</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SoftWareScan::State_HeapAlloc</span><span class="params">(<span class="keyword">int</span> state)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">QTreeWidgetItemIterator <span class="title">it</span><span class="params">(ui.HeapApiInfo)</span></span>;</span><br><span class="line">	<span class="keyword">while</span> (*it)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> ((*it)-&gt;<span class="built_in">text</span>(<span class="number">0</span>) == <span class="string">&quot;HeapAlloc&quot;</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> (state == Qt::Checked)</span><br><span class="line">				(*it)-&gt;<span class="built_in">setHidden</span>(<span class="literal">false</span>);</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">				(*it)-&gt;<span class="built_in">setHidden</span>(<span class="literal">true</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		++it;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">ProgressBar</span>(<span class="number">3</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SoftWareScan::State_RegCreateKeyEx</span><span class="params">(<span class="keyword">int</span> state)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">QTreeWidgetItemIterator <span class="title">it</span><span class="params">(ui.RegApiInfo)</span></span>;</span><br><span class="line">	<span class="keyword">while</span> (*it)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> ((*it)-&gt;<span class="built_in">text</span>(<span class="number">0</span>) == <span class="string">&quot;RegCreateKeyEx&quot;</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> (state == Qt::Checked)</span><br><span class="line">				(*it)-&gt;<span class="built_in">setHidden</span>(<span class="literal">false</span>);</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">				(*it)-&gt;<span class="built_in">setHidden</span>(<span class="literal">true</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		++it;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">ProgressBar</span>(<span class="number">4</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SoftWareScan::State_RegCloseKey</span><span class="params">(<span class="keyword">int</span> state)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">QTreeWidgetItemIterator <span class="title">it</span><span class="params">(ui.RegApiInfo)</span></span>;</span><br><span class="line">	<span class="keyword">while</span> (*it)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> ((*it)-&gt;<span class="built_in">text</span>(<span class="number">0</span>) == <span class="string">&quot;RegCloseKey&quot;</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> (state == Qt::Checked)</span><br><span class="line">				(*it)-&gt;<span class="built_in">setHidden</span>(<span class="literal">false</span>);</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">				(*it)-&gt;<span class="built_in">setHidden</span>(<span class="literal">true</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		++it;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">ProgressBar</span>(<span class="number">4</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SoftWareScan::State_RegSetValueEx</span><span class="params">(<span class="keyword">int</span> state)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">QTreeWidgetItemIterator <span class="title">it</span><span class="params">(ui.RegApiInfo)</span></span>;</span><br><span class="line">	<span class="keyword">while</span> (*it)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> ((*it)-&gt;<span class="built_in">text</span>(<span class="number">0</span>) == <span class="string">&quot;RegSetValueEx&quot;</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> (state == Qt::Checked)</span><br><span class="line">				(*it)-&gt;<span class="built_in">setHidden</span>(<span class="literal">false</span>);</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">				(*it)-&gt;<span class="built_in">setHidden</span>(<span class="literal">true</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		++it;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">ProgressBar</span>(<span class="number">4</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SoftWareScan::State_RegDeleteValue</span><span class="params">(<span class="keyword">int</span> state)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">QTreeWidgetItemIterator <span class="title">it</span><span class="params">(ui.RegApiInfo)</span></span>;</span><br><span class="line">	<span class="keyword">while</span> (*it)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> ((*it)-&gt;<span class="built_in">text</span>(<span class="number">0</span>) == <span class="string">&quot;RegDeleteValue&quot;</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> (state == Qt::Checked)</span><br><span class="line">				(*it)-&gt;<span class="built_in">setHidden</span>(<span class="literal">false</span>);</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">				(*it)-&gt;<span class="built_in">setHidden</span>(<span class="literal">true</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		++it;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">ProgressBar</span>(<span class="number">4</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SoftWareScan::State_RegOpenKeyEx</span><span class="params">(<span class="keyword">int</span> state)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">QTreeWidgetItemIterator <span class="title">it</span><span class="params">(ui.RegApiInfo)</span></span>;</span><br><span class="line">	<span class="keyword">while</span> (*it)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> ((*it)-&gt;<span class="built_in">text</span>(<span class="number">0</span>) == <span class="string">&quot;RegOpenKeyEx&quot;</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> (state == Qt::Checked)</span><br><span class="line">				(*it)-&gt;<span class="built_in">setHidden</span>(<span class="literal">false</span>);</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">				(*it)-&gt;<span class="built_in">setHidden</span>(<span class="literal">true</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		++it;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">ProgressBar</span>(<span class="number">4</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SoftWareScan::State_socket</span><span class="params">(<span class="keyword">int</span> state)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">QTreeWidgetItemIterator <span class="title">it</span><span class="params">(ui.SocketApiInfo)</span></span>;</span><br><span class="line">	<span class="keyword">while</span> (*it)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> ((*it)-&gt;<span class="built_in">text</span>(<span class="number">0</span>) == <span class="string">&quot;socket&quot;</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> (state == Qt::Checked)</span><br><span class="line">				(*it)-&gt;<span class="built_in">setHidden</span>(<span class="literal">false</span>);</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">				(*it)-&gt;<span class="built_in">setHidden</span>(<span class="literal">true</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		++it;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">ProgressBar</span>(<span class="number">5</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SoftWareScan::State_bind</span><span class="params">(<span class="keyword">int</span> state)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">QTreeWidgetItemIterator <span class="title">it</span><span class="params">(ui.SocketApiInfo)</span></span>;</span><br><span class="line">	<span class="keyword">while</span> (*it)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> ((*it)-&gt;<span class="built_in">text</span>(<span class="number">0</span>) == <span class="string">&quot;bind&quot;</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> (state == Qt::Checked)</span><br><span class="line">				(*it)-&gt;<span class="built_in">setHidden</span>(<span class="literal">false</span>);</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">				(*it)-&gt;<span class="built_in">setHidden</span>(<span class="literal">true</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		++it;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">ProgressBar</span>(<span class="number">5</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SoftWareScan::State_send</span><span class="params">(<span class="keyword">int</span> state)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">QTreeWidgetItemIterator <span class="title">it</span><span class="params">(ui.SocketApiInfo)</span></span>;</span><br><span class="line">	<span class="keyword">while</span> (*it)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> ((*it)-&gt;<span class="built_in">text</span>(<span class="number">0</span>) == <span class="string">&quot;send&quot;</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> (state == Qt::Checked)</span><br><span class="line">				(*it)-&gt;<span class="built_in">setHidden</span>(<span class="literal">false</span>);</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">				(*it)-&gt;<span class="built_in">setHidden</span>(<span class="literal">true</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		++it;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">ProgressBar</span>(<span class="number">5</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SoftWareScan::State_connect</span><span class="params">(<span class="keyword">int</span> state)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">QTreeWidgetItemIterator <span class="title">it</span><span class="params">(ui.SocketApiInfo)</span></span>;</span><br><span class="line">	<span class="keyword">while</span> (*it)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> ((*it)-&gt;<span class="built_in">text</span>(<span class="number">0</span>) == <span class="string">&quot;connect&quot;</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> (state == Qt::Checked)</span><br><span class="line">				(*it)-&gt;<span class="built_in">setHidden</span>(<span class="literal">false</span>);</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">				(*it)-&gt;<span class="built_in">setHidden</span>(<span class="literal">true</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		++it;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">ProgressBar</span>(<span class="number">5</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SoftWareScan::State_recv</span><span class="params">(<span class="keyword">int</span> state)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">QTreeWidgetItemIterator <span class="title">it</span><span class="params">(ui.SocketApiInfo)</span></span>;</span><br><span class="line">	<span class="keyword">while</span> (*it)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> ((*it)-&gt;<span class="built_in">text</span>(<span class="number">0</span>) == <span class="string">&quot;recv&quot;</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> (state == Qt::Checked)</span><br><span class="line">				(*it)-&gt;<span class="built_in">setHidden</span>(<span class="literal">false</span>);</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">				(*it)-&gt;<span class="built_in">setHidden</span>(<span class="literal">true</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		++it;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">ProgressBar</span>(<span class="number">5</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//计算显示条</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SoftWareScan::ProgressBar</span><span class="params">(<span class="keyword">int</span> i)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> count, Num;</span><br><span class="line">	<span class="function">QTreeWidgetItemIterator <span class="title">message</span><span class="params">(ui.MessageBoxInfo, QTreeWidgetItemIterator::HasChildren)</span></span>;</span><br><span class="line">	<span class="function">QTreeWidgetItemIterator <span class="title">file</span><span class="params">(ui.FileApiInfo, QTreeWidgetItemIterator::HasChildren)</span></span>;</span><br><span class="line">	<span class="function">QTreeWidgetItemIterator <span class="title">heap</span><span class="params">(ui.HeapApiInfo, QTreeWidgetItemIterator::HasChildren)</span></span>;</span><br><span class="line">	<span class="function">QTreeWidgetItemIterator <span class="title">reg</span><span class="params">(ui.RegApiInfo, QTreeWidgetItemIterator::HasChildren)</span></span>;</span><br><span class="line">	<span class="function">QTreeWidgetItemIterator <span class="title">thesocket</span><span class="params">(ui.SocketApiInfo, QTreeWidgetItemIterator::HasChildren)</span></span>;</span><br><span class="line">	<span class="built_in"><span class="keyword">switch</span></span> (i)</span><br><span class="line">	&#123;</span><br><span class="line">	<span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">		count = <span class="number">0</span>;</span><br><span class="line">		Num = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">while</span> (*message)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> ((*message)-&gt;<span class="built_in">isHidden</span>() == TRUE)</span><br><span class="line">			&#123;</span><br><span class="line">				Num++;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> &#123;</span><br><span class="line">				Num++;</span><br><span class="line">				count++;</span><br><span class="line">			&#125;</span><br><span class="line">			++message;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (Num != <span class="number">0</span>) &#123;</span><br><span class="line">			ui.progress_message-&gt;<span class="built_in">setValue</span>((<span class="keyword">int</span>)(count * <span class="number">100</span> / Num));</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			ui.progress_message-&gt;<span class="built_in">setValue</span>(<span class="number">100</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">		count = <span class="number">0</span>;</span><br><span class="line">		Num = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">while</span> (*file)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> ((*file)-&gt;<span class="built_in">isHidden</span>())</span><br><span class="line">			&#123;</span><br><span class="line">				Num++;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> &#123;</span><br><span class="line">				Num++;</span><br><span class="line">				count++;</span><br><span class="line">			&#125;</span><br><span class="line">			++file;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//ui.progress_file-&gt;setValue((int)(count * 100 / Num));</span></span><br><span class="line">		<span class="keyword">if</span> (Num != <span class="number">0</span>) &#123;</span><br><span class="line">			ui.progress_file-&gt;<span class="built_in">setValue</span>((<span class="keyword">int</span>)(count * <span class="number">100</span> / Num));</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			ui.progress_file-&gt;<span class="built_in">setValue</span>(<span class="number">100</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">		count = <span class="number">0</span>;</span><br><span class="line">		Num = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">while</span> (*heap)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> ((*heap)-&gt;<span class="built_in">isHidden</span>())</span><br><span class="line">			&#123;</span><br><span class="line">				Num++;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> &#123;</span><br><span class="line">				Num++;</span><br><span class="line">				count++;</span><br><span class="line">			&#125;</span><br><span class="line">			++heap;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//ui.progress_heap-&gt;setValue((int)(count * 100 / Num));</span></span><br><span class="line">		<span class="keyword">if</span> (Num != <span class="number">0</span>) &#123;</span><br><span class="line">			ui.progress_heap-&gt;<span class="built_in">setValue</span>((<span class="keyword">int</span>)(count * <span class="number">100</span> / Num));</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			ui.progress_heap-&gt;<span class="built_in">setValue</span>(<span class="number">100</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">		count = <span class="number">0</span>;</span><br><span class="line">		Num = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">while</span> (*reg)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> ((*reg)-&gt;<span class="built_in">isHidden</span>())</span><br><span class="line">				Num++;</span><br><span class="line">			<span class="keyword">else</span> &#123;</span><br><span class="line">				Num++;</span><br><span class="line">				count++;</span><br><span class="line">			&#125;</span><br><span class="line">			++reg;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//ui.progress_reg-&gt;setValue((int)(count * 100 / Num));</span></span><br><span class="line">		<span class="keyword">if</span> (Num != <span class="number">0</span>) &#123;</span><br><span class="line">			ui.progress_reg-&gt;<span class="built_in">setValue</span>((<span class="keyword">int</span>)(count * <span class="number">100</span> / Num));</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			ui.progress_reg-&gt;<span class="built_in">setValue</span>(<span class="number">100</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">		count = <span class="number">0</span>;</span><br><span class="line">		Num = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">while</span> (*thesocket)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> ((*thesocket)-&gt;<span class="built_in">isHidden</span>())</span><br><span class="line">			&#123;</span><br><span class="line">				Num++;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> &#123;</span><br><span class="line">				count++;</span><br><span class="line">				Num++;</span><br><span class="line">			&#125;</span><br><span class="line">			++thesocket;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (Num != <span class="number">0</span>) &#123;</span><br><span class="line">			ui.progress_socket-&gt;<span class="built_in">setValue</span>((<span class="keyword">int</span>)(count * <span class="number">100</span> / Num));</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			ui.progress_socket-&gt;<span class="built_in">setValue</span>(<span class="number">100</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">default</span>:</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//异常记录函数</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SoftWareScan::NewHeapInfo</span><span class="params">( QString string)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	QListWidgetItem* item = <span class="keyword">new</span> <span class="built_in">QListWidgetItem</span>();</span><br><span class="line">	SYSTEMTIME st;</span><br><span class="line">	<span class="built_in">GetLocalTime</span>(&amp;st);</span><br><span class="line">	<span class="keyword">char</span> temp[<span class="number">150</span>];</span><br><span class="line">	<span class="keyword">char</span> hd[<span class="number">20</span>];</span><br><span class="line">	<span class="built_in">sprintf</span>(temp, <span class="string">&quot;当前时间：%d:%d:%d &quot;</span>, st.wMinute, st.wSecond, st.wMilliseconds);</span><br><span class="line">	QString str = QString::<span class="built_in">fromLocal8Bit</span>(temp);</span><br><span class="line">	item-&gt;<span class="built_in">setText</span>(<span class="built_in">QString</span>( str+ string));</span><br><span class="line">	<span class="comment">//ui.HeapException-&gt;clear();</span></span><br><span class="line">	HeapException-&gt;<span class="built_in">addItem</span>(item);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SoftWareScan::NewRegInfo</span><span class="params">(<span class="keyword">int</span> handle, QString string)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">//接收到注册键的句柄</span></span><br><span class="line">	QListWidgetItem* item = <span class="keyword">new</span> <span class="built_in">QListWidgetItem</span>();</span><br><span class="line">	SYSTEMTIME st;</span><br><span class="line">	<span class="built_in">GetLocalTime</span>(&amp;st);</span><br><span class="line">	<span class="keyword">char</span> temp[<span class="number">150</span>];</span><br><span class="line">	<span class="keyword">char</span> hd[<span class="number">20</span>];</span><br><span class="line">	<span class="built_in">itoa</span>(handle, hd, <span class="number">16</span>);</span><br><span class="line">	<span class="built_in">sprintf</span>(temp, <span class="string">&quot;当前时间：%d:%d:%d  注册键句柄：%08X\n&quot;</span>, st.wMinute, st.wSecond, st.wMilliseconds, hd);</span><br><span class="line">	QString str = QString::<span class="built_in">fromLocal8Bit</span>(temp);</span><br><span class="line">	item-&gt;<span class="built_in">setText</span>(<span class="built_in">QString</span>(str + string));</span><br><span class="line">	<span class="comment">//ui.HeapException-&gt;clear();</span></span><br><span class="line">	RegException-&gt;<span class="built_in">addItem</span>(item);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SoftWareScan::NewFileInfo</span><span class="params">(<span class="keyword">int</span> handle, QString string)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">//接收到文件句柄</span></span><br><span class="line">	QListWidgetItem* item = <span class="keyword">new</span> <span class="built_in">QListWidgetItem</span>();</span><br><span class="line">	SYSTEMTIME st;</span><br><span class="line">	<span class="built_in">GetLocalTime</span>(&amp;st);</span><br><span class="line">	<span class="keyword">char</span> temp[<span class="number">150</span>];</span><br><span class="line">	<span class="keyword">char</span> hd[<span class="number">20</span>];</span><br><span class="line">	<span class="built_in">itoa</span>(handle, hd, <span class="number">16</span>);</span><br><span class="line">	<span class="built_in">sprintf</span>(temp, <span class="string">&quot;当前时间：%d:%d:%d  文件句柄：%08X\n&quot;</span>, st.wMinute, st.wSecond, st.wMilliseconds, hd);</span><br><span class="line">	QString str = QString::<span class="built_in">fromLocal8Bit</span>(temp);</span><br><span class="line">	item-&gt;<span class="built_in">setText</span>(<span class="built_in">QString</span>(str + string));</span><br><span class="line">	<span class="comment">//ui.HeapException-&gt;clear();</span></span><br><span class="line">	FileException-&gt;<span class="built_in">addItem</span>(item);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SoftWareScan::NewSocketInfo</span><span class="params">(QString string)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	QListWidgetItem* item = <span class="keyword">new</span> <span class="built_in">QListWidgetItem</span>();</span><br><span class="line">	SYSTEMTIME st;</span><br><span class="line">	<span class="built_in">GetLocalTime</span>(&amp;st);</span><br><span class="line">	<span class="keyword">char</span> temp[<span class="number">150</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">	<span class="built_in">sprintf</span>(temp, <span class="string">&quot;当前时间：%d:%d:%d \n&quot;</span>, st.wMinute, st.wSecond, st.wMilliseconds);</span><br><span class="line">	QString str = QString::<span class="built_in">fromLocal8Bit</span>(temp);</span><br><span class="line">	item-&gt;<span class="built_in">setText</span>(<span class="built_in">QString</span>(str + string));</span><br><span class="line">	SocketException-&gt;<span class="built_in">addItem</span>(item);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SoftWareScan::NewHeapBlock</span><span class="params">()</span><span class="comment">//刷新现在界面上的堆信息</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">//刷新前先清空</span></span><br><span class="line">	ui.HeapCreateAndDestroy-&gt;<span class="built_in">clear</span>();</span><br><span class="line">	ui.HeapMemoryBlock-&gt;<span class="built_in">clear</span>();</span><br><span class="line">	<span class="comment">//处理堆块</span></span><br><span class="line">	map&lt;string, <span class="keyword">int</span>&gt;::iterator m1;</span><br><span class="line">	<span class="keyword">for</span> (m1 = threadA.HeapBlock.<span class="built_in">begin</span>(); m1 != threadA.HeapBlock.<span class="built_in">end</span>(); m1++)</span><br><span class="line">	&#123;</span><br><span class="line">		QListWidgetItem* item = <span class="keyword">new</span> QListWidgetItem;</span><br><span class="line">		<span class="keyword">char</span> str[<span class="number">200</span>];</span><br><span class="line">		<span class="built_in">memset</span>(str, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(str));</span><br><span class="line">		<span class="built_in">sprintf</span>(str, <span class="string">&quot;堆块句柄：%s   堆块剩余大小：%d\n&quot;</span>, (*m1).first.<span class="built_in">c_str</span>(), (*m1).second);</span><br><span class="line">		item-&gt;<span class="built_in">setText</span>(QString::<span class="built_in">fromLocal8Bit</span>(str));</span><br><span class="line">		ui.HeapCreateAndDestroy-&gt;<span class="built_in">addItem</span>(item);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//处理堆内存块</span></span><br><span class="line">	map&lt;string, map&lt;string, <span class="keyword">int</span>&gt;&gt;::iterator m2;</span><br><span class="line">	<span class="keyword">for</span> (m2 = threadA.HeapMem.<span class="built_in">begin</span>(); m2 != threadA.HeapMem.<span class="built_in">end</span>(); m2++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span> (m1 = (*m2).second.<span class="built_in">begin</span>(); m1 != (*m2).second.<span class="built_in">end</span>(); m1++)</span><br><span class="line">		&#123;</span><br><span class="line">			QListWidgetItem* item = <span class="keyword">new</span> QListWidgetItem;</span><br><span class="line">			<span class="keyword">char</span> str[<span class="number">200</span>];</span><br><span class="line">			<span class="built_in">memset</span>(str, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(str));</span><br><span class="line">			<span class="built_in">sprintf</span>(str, <span class="string">&quot;内存块首地址：%s 所属堆块：%s 大小为：%d\n&quot;</span>, (*m2).first.<span class="built_in">c_str</span>(), (*m1).first.<span class="built_in">c_str</span>(), (*m1).second);</span><br><span class="line">			item-&gt;<span class="built_in">setText</span>(QString::<span class="built_in">fromLocal8Bit</span>(str));</span><br><span class="line">			ui.HeapMemoryBlock-&gt;<span class="built_in">addItem</span>(item);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtext>  </mtext><mi>M</mi><mi>y</mi><mi>T</mi><mi>h</mi><mi>r</mi><mi>e</mi><mi>a</mi><mi>d</mi><mi mathvariant="normal">.</mi><mi>c</mi><mi>p</mi><mi>p</mi><mtext>  </mtext></mrow><annotation encoding="application/x-tex">\;MyThread.cpp\;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mord mathdefault">h</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">e</span><span class="mord mathdefault">a</span><span class="mord mathdefault">d</span><span class="mord">.</span><span class="mord mathdefault">c</span><span class="mord mathdefault">p</span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span></span></span>:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;SoftWareScan.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;ui_SoftWareScan.h&quot;</span></span></span><br><span class="line"><span class="keyword">extern</span> info recvinfo;</span><br><span class="line"><span class="keyword">extern</span> <span class="keyword">char</span> typestr[<span class="number">25</span>][<span class="number">20</span>];</span><br><span class="line"><span class="comment">//extern int lastType;</span></span><br><span class="line"><span class="comment">//extern SYSTEMTIME lastST;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">MyThread::run</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> lastType = <span class="number">-1</span>;</span><br><span class="line">	SYSTEMTIME lastST;</span><br><span class="line">	<span class="comment">//GetLocalTime(&amp;lastST);</span></span><br><span class="line">	HANDLE hSemaphore = <span class="built_in">CreateSemaphore</span>(<span class="literal">NULL</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="string">L&quot;mySemaphore&quot;</span>);</span><br><span class="line">	HANDLE hMapFile = <span class="built_in">CreateFileMapping</span>(INVALID_HANDLE_VALUE, <span class="literal">NULL</span>, PAGE_READWRITE, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(info), <span class="string">L&quot;ShareMemory&quot;</span>);</span><br><span class="line">	LPVOID lpBase = <span class="built_in">MapViewOfFile</span>(hMapFile, FILE_MAP_ALL_ACCESS, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">	STARTUPINFOA startupInfo = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">	PROCESS_INFORMATION processInformation = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">	<span class="comment">//启动注射器</span></span><br><span class="line">	<span class="comment">/*BOOL bSuccess = CreateProcessA(&quot;C:\\Users\\15242\\source\\repos\\SoftWareScan\\Debug\\App.exe&quot;, filePath, NULL, NULL, FALSE, CREATE_NEW_CONSOLE, NULL, NULL, &amp;startupInfo, &amp;processInformation);*/</span></span><br><span class="line">	BOOL bSuccess = <span class="built_in">CreateProcessA</span>(<span class="string">&quot;App.exe&quot;</span>, filePath, <span class="literal">NULL</span>, <span class="literal">NULL</span>, FALSE, CREATE_NEW_CONSOLE, <span class="literal">NULL</span>, <span class="literal">NULL</span>, &amp;startupInfo, &amp;processInformation);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//emit newProcessInfo(processInformation);</span></span><br><span class="line">	<span class="function">emit <span class="title">newProcessName</span><span class="params">(QString(fileName))</span></span>;</span><br><span class="line">	<span class="comment">//emit newProcessID(QString::number(processInformation.dwProcessId));</span></span><br><span class="line">	<span class="comment">//emit newProcessHandle(QString::number(processInformation.hProcess));</span></span><br><span class="line">	<span class="keyword">char</span> temp[<span class="number">512</span>];</span><br><span class="line">	<span class="comment">//sprintf(temp, &quot;%d&quot;, processInformation.dwProcessId);</span></span><br><span class="line">	<span class="function">emit <span class="title">newProcessID</span><span class="params">(processInformation.dwProcessId)</span></span>;</span><br><span class="line">	<span class="built_in">memset</span>(temp, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(temp));</span><br><span class="line">	<span class="built_in">sprintf</span>(temp, <span class="string">&quot;%08X&quot;</span>, processInformation.hProcess);</span><br><span class="line">	<span class="function">emit <span class="title">newProcessHandle</span><span class="params">(QString(QLatin1String(temp)))</span></span>;</span><br><span class="line">	<span class="function">emit <span class="title">newStatus</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="built_in">msleep</span>(<span class="number">1500</span>);</span><br><span class="line">	<span class="keyword">while</span> (running)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (<span class="built_in">WaitForSingleObject</span>(hSemaphore, <span class="number">10</span>) == WAIT_OBJECT_0)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">memcpy</span>(&amp;recvinfo, lpBase, <span class="built_in"><span class="keyword">sizeof</span></span>(info));</span><br><span class="line">			<span class="keyword">if</span> (lastST.wMilliseconds == recvinfo.st.wMilliseconds &amp;&amp; lastST.wSecond == recvinfo.st.wSecond &amp;&amp; lastType == recvinfo.type)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="comment">//说明该信息已经接受过，不再添加该信息</span></span><br><span class="line">				<span class="keyword">continue</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="comment">//对收到的消息进行测试</span></span><br><span class="line">			<span class="comment">/*FILE* f = fopen(&quot;test.txt&quot;, &quot;a+&quot;);</span></span><br><span class="line"><span class="comment">			fprintf(f, &quot;%s\n&quot;, typestr[recvinfo.type]);</span></span><br><span class="line"><span class="comment">			fclose(f);*/</span></span><br><span class="line"></span><br><span class="line">			lastST = recvinfo.st;</span><br><span class="line">			lastType = recvinfo.type;</span><br><span class="line">			<span class="comment">//emit newInfo(recvinfo);</span></span><br><span class="line">			<span class="comment">//审核信息作出判断</span></span><br><span class="line">			<span class="built_in">checkInfo</span>(recvinfo);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function">emit <span class="title">newStatus</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="built_in">quit</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">MyThread::StopThread</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">//当点击进程停止后，需要将thread类里面的变量进行重新的设置</span></span><br><span class="line">	running = <span class="literal">false</span>;</span><br><span class="line">	folderset.<span class="built_in">clear</span>();</span><br><span class="line">	filenameset.<span class="built_in">clear</span>();</span><br><span class="line">	filemap.<span class="built_in">clear</span>();</span><br><span class="line">	HeapBlock.<span class="built_in">clear</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">MyThread::init</span><span class="params">(<span class="keyword">char</span>* path)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	running = <span class="literal">false</span>;</span><br><span class="line">	<span class="built_in">memset</span>(filePath, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(filePath));</span><br><span class="line">	<span class="built_in">memset</span>(fileName, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(fileName));</span><br><span class="line">	<span class="built_in">strcpy</span>(filePath, path);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; filePath[i] != <span class="number">0</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (filePath[i] == <span class="string">&#x27;/&#x27;</span>) &#123;</span><br><span class="line">			filePath[i] = <span class="string">&#x27;\\&#x27;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">GetFileName</span>(filePath, fileName);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">MyThread::GetFileName</span><span class="params">(<span class="keyword">char</span>* filepath, <span class="keyword">char</span>* filename)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> len = <span class="built_in">strlen</span>(filepath);</span><br><span class="line">	<span class="keyword">while</span> (filepath[len<span class="number">-1</span>]!=<span class="string">&#x27;\\&#x27;</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		len--;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">strcpy</span>(filename, filepath + len);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">MyThread::GetStatus</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> running;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">MyThread::ModifyProcessStatus</span><span class="params">(<span class="keyword">bool</span> status)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	running = status;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">MyThread::checkInfo</span><span class="params">(info tempInfo)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">//局部变量</span></span><br><span class="line">	<span class="keyword">int</span> type = tempInfo.type;</span><br><span class="line">	<span class="keyword">unsigned</span> heapHandle;</span><br><span class="line">	<span class="keyword">int</span> handle;</span><br><span class="line">	<span class="keyword">char</span> str[<span class="number">150</span>];</span><br><span class="line">	<span class="keyword">char</span> filename[<span class="number">100</span>];</span><br><span class="line">	<span class="keyword">char</span> filepath[<span class="number">100</span>];</span><br><span class="line">	string copyfolder, s1, s2;</span><br><span class="line">	<span class="keyword">unsigned</span> dwDesiredAccess;</span><br><span class="line">	FILE* f;</span><br><span class="line"></span><br><span class="line">	<span class="built_in"><span class="keyword">switch</span></span> (type)</span><br><span class="line">	&#123;</span><br><span class="line">	<span class="keyword">case</span> MESSAGEBOXA:</span><br><span class="line">		<span class="function">emit <span class="title">newInfo</span><span class="params">(tempInfo)</span></span>;</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> MESSAGEBOXW:</span><br><span class="line">		<span class="function">emit <span class="title">newInfo</span><span class="params">(tempInfo)</span></span>;</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> HEAPCREATE:</span><br><span class="line">		<span class="comment">/*f = fopen(&quot;test.txt&quot;, &quot;a+&quot;);</span></span><br><span class="line"><span class="comment">		fprintf(f, &quot;成功收到了heapcreate的包！\n&quot;);</span></span><br><span class="line"><span class="comment">		fclose(f);*/</span></span><br><span class="line">		<span class="comment">//创建堆，记录堆句柄和堆大小</span></span><br><span class="line">		s1 = tempInfo.Value[<span class="number">3</span>];<span class="comment">//句柄</span></span><br><span class="line">		handle = <span class="built_in">strtoul</span>(tempInfo.Value[<span class="number">1</span>], <span class="literal">NULL</span>, <span class="number">16</span>);<span class="comment">//大小</span></span><br><span class="line">		HeapBlock.<span class="built_in">insert</span>(pair&lt;string, <span class="keyword">int</span>&gt;(s1, handle));</span><br><span class="line">		<span class="built_in">memset</span>(str, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(str));</span><br><span class="line">		<span class="built_in">sprintf</span>(str, <span class="string">&quot;创建了新的堆，堆句柄为 %s  初始大小为  %d&quot;</span>, s1.<span class="built_in">c_str</span>(), handle);</span><br><span class="line">		<span class="function">emit <span class="title">newHeapInfo</span><span class="params">(QString::fromLocal8Bit(str))</span></span>;</span><br><span class="line">		<span class="function">emit <span class="title">newHeapBlock</span><span class="params">()</span></span>;<span class="comment">//刷新界面信号</span></span><br><span class="line">		<span class="function">emit <span class="title">newInfo</span><span class="params">(tempInfo)</span></span>;</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> HEAPFREE:</span><br><span class="line">		s1 = tempInfo.Value[<span class="number">0</span>];<span class="comment">//句柄</span></span><br><span class="line">		s2 = tempInfo.Value[<span class="number">2</span>];<span class="comment">//内存块首地址</span></span><br><span class="line">		<span class="built_in">memset</span>(str, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(str));</span><br><span class="line">		<span class="keyword">if</span> (HeapMem.<span class="built_in">find</span>(s2) == HeapMem.<span class="built_in">end</span>())</span><br><span class="line">		&#123;<span class="comment">//没找到，出错</span></span><br><span class="line">			<span class="built_in">sprintf</span>(str, <span class="string">&quot;内存块首地址为 %s 的堆发生了重复释放！\n&quot;</span>,s2.<span class="built_in">c_str</span>());</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="comment">//找到进行释放并更新堆块大小</span></span><br><span class="line">			map&lt;string, <span class="keyword">int</span>&gt; temp2 = (*HeapMem.<span class="built_in">find</span>(s2)).second;</span><br><span class="line">			<span class="keyword">if</span> (temp2.<span class="built_in">find</span>(s1) != temp2.<span class="built_in">end</span>())</span><br><span class="line">			&#123;</span><br><span class="line">				handle = (*temp2.<span class="built_in">find</span>(s1)).second;</span><br><span class="line">				(*HeapBlock.<span class="built_in">find</span>(s1)).second += handle;<span class="comment">//更新堆块大小</span></span><br><span class="line">				HeapMem.<span class="built_in">erase</span>(HeapMem.<span class="built_in">find</span>(s2));</span><br><span class="line">				<span class="built_in">sprintf</span>(str, <span class="string">&quot;成功释放内存块首地址为 %s 的堆区内存！\n&quot;</span>, s2.<span class="built_in">c_str</span>());</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="function">emit <span class="title">newInfo</span><span class="params">(tempInfo)</span></span>;</span><br><span class="line">		<span class="function">emit <span class="title">newHeapBlock</span><span class="params">()</span></span>;</span><br><span class="line">		<span class="function">emit <span class="title">newHeapInfo</span><span class="params">(QString::fromLocal8Bit(str))</span></span>;</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> HEAPDESTROY:</span><br><span class="line">		s1 = tempInfo.Value[<span class="number">0</span>];<span class="comment">//句柄</span></span><br><span class="line">		<span class="built_in">memset</span>(str, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(str));</span><br><span class="line">		<span class="keyword">if</span> (HeapBlock.<span class="built_in">find</span>(s1) == HeapBlock.<span class="built_in">end</span>())</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">strcat</span>(str, <span class="string">&quot;销毁堆出错，待销毁的堆不存在！\n&quot;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			HeapBlock.<span class="built_in">erase</span>(s1);</span><br><span class="line">			<span class="built_in">sprintf</span>(str, <span class="string">&quot;句柄为  %s  的堆块已经被销毁！\n&quot;</span>, s1.<span class="built_in">c_str</span>());</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="function">emit <span class="title">newInfo</span><span class="params">(tempInfo)</span></span>;</span><br><span class="line">		<span class="function">emit <span class="title">newHeapBlock</span><span class="params">()</span></span>;</span><br><span class="line">		<span class="function">emit <span class="title">newHeapInfo</span><span class="params">(QString::fromLocal8Bit(str))</span></span>;</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> HEAPALLOC:</span><br><span class="line">		s1 = tempInfo.Value[<span class="number">0</span>];<span class="comment">//句柄</span></span><br><span class="line">		s2 = tempInfo.Value[<span class="number">3</span>];<span class="comment">//内存块首地址</span></span><br><span class="line">		handle = <span class="built_in">strtoul</span>(tempInfo.Value[<span class="number">2</span>], <span class="literal">NULL</span>, <span class="number">16</span>);<span class="comment">//内存块大小</span></span><br><span class="line">		<span class="built_in">memset</span>(str, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(str));</span><br><span class="line">		<span class="keyword">if</span> (HeapBlock.<span class="built_in">find</span>(s1) == HeapBlock.<span class="built_in">end</span>())</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="comment">//没找到说明申请出错</span></span><br><span class="line">			<span class="comment">//sprintf(str, &quot;句柄为  %s  的堆块不存在！\n&quot;, s1.c_str());</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> &#123;<span class="comment">//找到就加入heapmem并对堆块大小变化</span></span><br><span class="line">			(*HeapBlock.<span class="built_in">find</span>(s1)).second -= handle;</span><br><span class="line">			map&lt;string, <span class="keyword">int</span>&gt; temp;</span><br><span class="line">			temp.<span class="built_in">insert</span>(pair&lt;string, <span class="keyword">int</span>&gt;(s1, handle));</span><br><span class="line">			HeapMem.<span class="built_in">insert</span>(<span class="built_in">make_pair</span>(s2,temp));</span><br><span class="line">			<span class="built_in">sprintf</span>(str, <span class="string">&quot;已从句柄为 %s 的堆块中申请了 %d 的空间，首地址为 %s\n&quot;</span>, s1.<span class="built_in">c_str</span>(), handle, s2.<span class="built_in">c_str</span>());</span><br><span class="line">			<span class="function">emit <span class="title">newInfo</span><span class="params">(tempInfo)</span></span>;</span><br><span class="line">			<span class="function">emit <span class="title">newHeapBlock</span><span class="params">()</span></span>;</span><br><span class="line">			<span class="function">emit <span class="title">newHeapInfo</span><span class="params">(QString::fromLocal8Bit(str))</span></span>;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> REGCREATEKEYEX:</span><br><span class="line">		handle = <span class="built_in">strtoul</span>(tempInfo.Value[<span class="number">0</span>], <span class="literal">NULL</span>, <span class="number">16</span>);</span><br><span class="line">		<span class="keyword">if</span> ((handle == <span class="number">0x80000001</span>) &amp;&amp; (<span class="built_in">strstr</span>(tempInfo.Value[<span class="number">1</span>], <span class="string">&quot;SOFTWARE\Microsoft\Windows\CurrentVersion\Run&quot;</span>)))</span><br><span class="line">		&#123;</span><br><span class="line">			handle = <span class="built_in">strtoul</span>(tempInfo.Value[<span class="number">7</span>], <span class="literal">NULL</span>, <span class="number">16</span>);</span><br><span class="line">			<span class="function">emit <span class="title">newRegInfo</span><span class="params">(handle, QString::fromLocal8Bit(<span class="string">&quot;创建了新的注册键，主键为HKEY_CURRENT_USER，为自启动目录下的注册键！&quot;</span>))</span></span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span>((handle==<span class="number">0x80000002</span>)&amp;&amp;(<span class="built_in">strstr</span>(tempInfo.Value[<span class="number">1</span>],<span class="string">&quot;SOFTWARE\Microsoft\Windows\CurrentVersion\Run&quot;</span>)))</span><br><span class="line">		&#123;</span><br><span class="line">			handle = <span class="built_in">strtoul</span>(tempInfo.Value[<span class="number">7</span>], <span class="literal">NULL</span>, <span class="number">16</span>);</span><br><span class="line">			<span class="function">emit <span class="title">newRegInfo</span><span class="params">(handle, QString::fromLocal8Bit(<span class="string">&quot;创建了新的注册键，主键为HKEY_CURRENT_MACHINE，为自启动目录下的注册键！&quot;</span>))</span></span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			handle = <span class="built_in">strtoul</span>(tempInfo.Value[<span class="number">7</span>], <span class="literal">NULL</span>, <span class="number">16</span>);</span><br><span class="line">			<span class="function">emit <span class="title">newRegInfo</span><span class="params">(handle, QString::fromLocal8Bit(<span class="string">&quot;创建了新的注册键，非自启动！&quot;</span>))</span></span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="function">emit <span class="title">newInfo</span><span class="params">(tempInfo)</span></span>;</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> REGSETVALUEEX:</span><br><span class="line">		handle = <span class="built_in">strtoul</span>(tempInfo.Value[<span class="number">0</span>], <span class="literal">NULL</span>, <span class="number">16</span>);</span><br><span class="line">		<span class="built_in">sprintf</span>(str, <span class="string">&quot;修改了该键的名称，修改后的名称为 %s&quot;</span>, tempInfo.Value[<span class="number">1</span>]);</span><br><span class="line">		<span class="function">emit <span class="title">newRegInfo</span><span class="params">(handle, QString::fromLocal8Bit(str))</span></span>;</span><br><span class="line">		<span class="function">emit <span class="title">newInfo</span><span class="params">(tempInfo)</span></span>;</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> REGOPENKEYEX:</span><br><span class="line">		<span class="keyword">if</span> (<span class="built_in">strstr</span>(tempInfo.Value[<span class="number">1</span>], <span class="string">&quot;SOFTWARE\Microsoft\Windows\CurrentVersion\Run&quot;</span>))</span><br><span class="line">		&#123;</span><br><span class="line">			handle = <span class="built_in">strtoul</span>(tempInfo.Value[<span class="number">4</span>], <span class="literal">NULL</span>, <span class="number">16</span>);</span><br><span class="line">			<span class="built_in">sprintf</span>(str, <span class="string">&quot;创建或者打开了注册键  %s  ，位于自启动目录下！&quot;</span>, tempInfo.Value[<span class="number">1</span>]);</span><br><span class="line">			<span class="function">emit <span class="title">newRegInfo</span><span class="params">(handle, QString::fromLocal8Bit(str))</span></span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="function">emit <span class="title">newInfo</span><span class="params">(tempInfo)</span></span>;</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> REGDELETEVALUE:</span><br><span class="line">		handle = <span class="built_in">strtoul</span>(tempInfo.Value[<span class="number">0</span>], <span class="literal">NULL</span>, <span class="number">16</span>);</span><br><span class="line">		<span class="built_in">sprintf</span>(str, <span class="string">&quot;已将值为 %s 的键删除！&quot;</span>, tempInfo.Value[<span class="number">1</span>]);</span><br><span class="line">		<span class="function">emit <span class="title">newRegInfo</span><span class="params">(handle, QString::fromLocal8Bit(str))</span></span>;</span><br><span class="line">		<span class="function">emit <span class="title">newInfo</span><span class="params">(tempInfo)</span></span>;</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> REGCLOSEKEY:</span><br><span class="line">		<span class="function">emit <span class="title">newInfo</span><span class="params">(tempInfo)</span></span>;</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> CREATEFILE:</span><br><span class="line">		handle = <span class="built_in">strtoul</span>(tempInfo.Value[<span class="number">7</span>], <span class="literal">NULL</span>, <span class="number">16</span>);<span class="comment">//创建文件的句柄</span></span><br><span class="line">		<span class="built_in">GetFileName</span>(tempInfo.Value[<span class="number">0</span>], filename);</span><br><span class="line">		<span class="comment">//strcpy(filename, tempInfo.Value[0]);//文件名称</span></span><br><span class="line">		s1 = tempInfo.Value[<span class="number">7</span>];</span><br><span class="line">		<span class="keyword">if</span> (filemap.<span class="built_in">find</span>(s1) == filemap.<span class="built_in">end</span>())</span><br><span class="line">		&#123;<span class="comment">//记录文件句柄和名称</span></span><br><span class="line">			<span class="function">string <span class="title">s2</span><span class="params">(filename)</span></span>;</span><br><span class="line">			filemap.<span class="built_in">insert</span>(pair&lt;string, string&gt;(s1,s2 ));</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//Test,测试是否将文件名称和对应句柄存入</span></span><br><span class="line">		<span class="comment">/*f = fopen(&quot;Test.txt&quot;, &quot;a+&quot;);</span></span><br><span class="line"><span class="comment">		for (auto i = filemap.begin(); i != filemap.end(); i++)</span></span><br><span class="line"><span class="comment">		&#123;</span></span><br><span class="line"><span class="comment">			fprintf(f, &quot;%d   %s\n&quot;, (*i).first, (*i).second.c_str());</span></span><br><span class="line"><span class="comment">		&#125;</span></span><br><span class="line"><span class="comment">		fprintf(f, &quot;\n&quot;);</span></span><br><span class="line"><span class="comment">		fclose(f);*/</span></span><br><span class="line">		<span class="comment">//结论：成功写入map中，但是读写文件靠的是句柄，每次打开文件句柄不同！但是又要过滤</span></span><br><span class="line"></span><br><span class="line">		<span class="built_in">GetLastFolder</span>(tempInfo.Value[<span class="number">0</span>], copyfolder);</span><br><span class="line">		<span class="comment">//判断是否多文件夹操作</span></span><br><span class="line">		<span class="keyword">if</span> (folderset.<span class="built_in">find</span>(copyfolder) == folderset.<span class="built_in">end</span>())</span><br><span class="line">		&#123;<span class="comment">//未找到该文件夹</span></span><br><span class="line">			folderset.<span class="built_in">insert</span>(copyfolder);</span><br><span class="line">		&#125;</span><br><span class="line">		dwDesiredAccess = <span class="built_in">strtoul</span>(tempInfo.Value[<span class="number">1</span>], <span class="literal">NULL</span>, <span class="number">16</span>);</span><br><span class="line">		<span class="built_in">memset</span>(str, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(str));</span><br><span class="line">		<span class="built_in">strcat</span>(str, <span class="string">&quot;创建了文件对象，名称为&quot;</span>);</span><br><span class="line">		<span class="comment">//temp = &quot;创建了文件对象，名称为&quot;;</span></span><br><span class="line">		<span class="comment">//temp2 = filename;</span></span><br><span class="line">		<span class="comment">//temp += temp2;</span></span><br><span class="line">		<span class="comment">//temp += &#x27;\n&#x27;;//加入文件名称信息</span></span><br><span class="line">		<span class="built_in">strcat</span>(str, filename);</span><br><span class="line">		<span class="built_in">strcat</span>(str, <span class="string">&quot;\n&quot;</span>);</span><br><span class="line">		<span class="comment">//判断该文件的操作是否涉及自我复制</span></span><br><span class="line">		<span class="comment">//首先set里面是否存在该名称，没有的话就添加，有的话就可能在自我复制</span></span><br><span class="line">		<span class="comment">//if (filenameset.find(filename) == filenameset.end())</span></span><br><span class="line">		<span class="comment">//&#123;</span></span><br><span class="line">		<span class="comment">//	filenameset.insert(filename);//没有找到就加入该文件名称</span></span><br><span class="line">		<span class="comment">//&#125;</span></span><br><span class="line">		<span class="comment">//else &#123;</span></span><br><span class="line">		<span class="comment">//	//找到该文件后添加提示信息</span></span><br><span class="line">		<span class="comment">//	strcat(str, &quot;该操作存在文件的重复操作，可能是自我复制！\n&quot;);</span></span><br><span class="line">		<span class="comment">//&#125;</span></span><br><span class="line">		<span class="keyword">if</span> (dwDesiredAccess &amp; GENERIC_READ) &#123;</span><br><span class="line">			<span class="keyword">if</span> (<span class="built_in">strcmp</span>(fileName, filename) == <span class="number">0</span>) &#123;</span><br><span class="line">				<span class="built_in">strcat</span>(str, <span class="string">&quot;该操作可能进行文件自我复制！\n&quot;</span>);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (dwDesiredAccess &amp; GENERIC_WRITE) &#123;</span><br><span class="line">			<span class="keyword">if</span> (<span class="built_in">strstr</span>(filename, <span class="string">&quot;.exe&quot;</span>) || <span class="built_in">strstr</span>(filename, <span class="string">&quot;.dll&quot;</span>) || <span class="built_in">strstr</span>(filename, <span class="string">&quot;.ocx&quot;</span>)) &#123;</span><br><span class="line">				<span class="built_in">strcat</span>(str, <span class="string">&quot;该操作创建了可执行文件！\n&quot;</span>);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (folderset.<span class="built_in">size</span>() &gt;= <span class="number">2</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="comment">//temp+=&quot;当前操作范围有多个文件夹！&quot;;</span></span><br><span class="line">			<span class="built_in">strcat</span>(str, <span class="string">&quot;当前操作范围有多个文件夹！&quot;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//strcpy(str, temp.c_str());</span></span><br><span class="line">		<span class="function">emit <span class="title">newInfo</span><span class="params">(tempInfo)</span></span>;</span><br><span class="line">		<span class="function">emit <span class="title">newFileInfo</span><span class="params">(handle, QString::fromLocal8Bit(str))</span></span>;</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> COPYFILEA:</span><br><span class="line">		<span class="built_in">memset</span>(str, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(str));</span><br><span class="line">		<span class="built_in">strcpy</span>(str, tempInfo.Value[<span class="number">0</span>]);</span><br><span class="line">		<span class="keyword">if</span> (<span class="built_in">strstr</span>(str, fileName))</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">memset</span>(str, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(str));</span><br><span class="line">			<span class="built_in">sprintf</span>(str, <span class="string">&quot;该操作(CopyFileA)表明文件自我复制！\n&quot;</span>);</span><br><span class="line">			<span class="function">emit <span class="title">newFileInfo</span><span class="params">(<span class="number">0</span>,QString::fromLocal8Bit(str))</span></span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="function">emit <span class="title">newInfo</span><span class="params">(tempInfo)</span></span>;</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> WRITEFILE:</span><br><span class="line">		handle = <span class="built_in">strtoul</span>(tempInfo.Value[<span class="number">0</span>], <span class="literal">NULL</span>, <span class="number">16</span>);<span class="comment">//写的文件句柄</span></span><br><span class="line">		<span class="comment">/*f = fopen(&quot;test.txt&quot;, &quot;a+&quot;);</span></span><br><span class="line"><span class="comment">		fprintf(f, &quot;%d&quot;, handle);</span></span><br><span class="line"><span class="comment">		fclose(f);*/</span></span><br><span class="line">		<span class="comment">/*emit newInfo(tempInfo);*/</span></span><br><span class="line">		s1=tempInfo.Value[<span class="number">0</span>];<span class="comment">//文件句柄转string</span></span><br><span class="line">		<span class="built_in">memset</span>(str, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(str));</span><br><span class="line">		<span class="keyword">if</span> (filemap.<span class="built_in">find</span>(s1) == filemap.<span class="built_in">end</span>())</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="comment">//未曾创建过该文件，则不将修改信息打印出来</span></span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			string s = (*filemap.<span class="built_in">find</span>(s1)).second;<span class="comment">//文件名称</span></span><br><span class="line">			<span class="comment">//memcpy(str, s.data(), sizeof(s));</span></span><br><span class="line">			<span class="keyword">if</span> (<span class="built_in">strstr</span>(s.<span class="built_in">data</span>(), <span class="string">&quot;.exe&quot;</span>) || <span class="built_in">strstr</span>(s.<span class="built_in">data</span>(), <span class="string">&quot;.dll&quot;</span>) || <span class="built_in">strstr</span>(s.<span class="built_in">data</span>(), <span class="string">&quot;.ocx&quot;</span>))</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="built_in">memset</span>(str, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(str));</span><br><span class="line">				<span class="built_in">strcat</span>(str, <span class="string">&quot;该函数修改了可执行程序文件(exe,dll或cox)!\n&quot;</span>);</span><br><span class="line">				<span class="function">emit <span class="title">newFileInfo</span><span class="params">(handle, QString::fromLocal8Bit(str))</span></span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="comment">//莫名其妙总是提示会自我复制，filesize没有正确拿到值？确实啊，难顶</span></span><br><span class="line">			<span class="comment">//判断文件是否会进行自我复制</span></span><br><span class="line">			<span class="comment">//通过要写的字节数和文件自身大小进行比较？设定一个范围？假设范围为+-100字节</span></span><br><span class="line">			<span class="keyword">int</span> bytes = <span class="built_in">strtoul</span>(tempInfo.Value[<span class="number">2</span>], <span class="literal">NULL</span>, <span class="number">16</span>);</span><br><span class="line">			<span class="comment">//int filesize = GetFileSize(fileName,NULL);</span></span><br><span class="line">			<span class="keyword">if</span> ((bytes &lt;= fileSize + <span class="number">100</span>) &amp;&amp; (bytes &gt;= fileSize - <span class="number">100</span>))</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="built_in">strcat</span>(str, <span class="string">&quot;通过大小表明该程序可能进行自我复制！\n&quot;</span>);</span><br><span class="line">				<span class="function">emit <span class="title">newFileInfo</span><span class="params">(handle, QString::fromLocal8Bit(str))</span></span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="function">emit <span class="title">newInfo</span><span class="params">(tempInfo)</span></span>;</span><br><span class="line">			</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> READFILE:</span><br><span class="line">		handle = <span class="built_in">strtoul</span>(tempInfo.Value[<span class="number">0</span>], <span class="literal">NULL</span>,<span class="number">16</span>);</span><br><span class="line">		s1 = tempInfo.Value[<span class="number">0</span>];</span><br><span class="line">		<span class="keyword">if</span> (filemap.<span class="built_in">find</span>(s1) == filemap.<span class="built_in">end</span>())</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			string s = (*filemap.<span class="built_in">find</span>(s1)).second;</span><br><span class="line">			<span class="comment">//memcpy(str, s.data(), sizeof(s));</span></span><br><span class="line">			<span class="keyword">if</span> (<span class="built_in">strstr</span>(s.<span class="built_in">data</span>(), <span class="string">&quot;.exe&quot;</span>) || <span class="built_in">strstr</span>(s.<span class="built_in">data</span>(), <span class="string">&quot;.dll&quot;</span>) || <span class="built_in">strstr</span>(s.<span class="built_in">data</span>(), <span class="string">&quot;.ocx&quot;</span>))</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="built_in">memset</span>(str, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(str));</span><br><span class="line">				<span class="built_in">strcat</span>(str, <span class="string">&quot;该函数读取了可执行程序文件(exe,dll或cox)!&quot;</span>);</span><br><span class="line">				<span class="function">emit <span class="title">newFileInfo</span><span class="params">(handle, QString::fromLocal8Bit(str))</span></span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="function">emit <span class="title">newInfo</span><span class="params">(tempInfo)</span></span>;	</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> CLOSEHANDLE:</span><br><span class="line">		<span class="comment">//由于创建文件获得的句柄都以string存储在filemap中，而这里的closehandle只针对文件类</span></span><br><span class="line">		s1 = tempInfo.Value[<span class="number">0</span>];</span><br><span class="line">		<span class="keyword">if</span> (filemap.<span class="built_in">find</span>(s1) == filemap.<span class="built_in">end</span>())</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			emit <span class="built_in">newInfo</span>(tempInfo);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> THESOCKET:</span><br><span class="line">		heapHandle= <span class="built_in">strtoul</span>(tempInfo.Value[<span class="number">2</span>], <span class="literal">NULL</span>, <span class="number">10</span>);</span><br><span class="line">		<span class="built_in">memset</span>(str, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(str));</span><br><span class="line">		<span class="keyword">if</span> (heapHandle == IPPROTO_IP) &#123; <span class="built_in">strcat</span>(str, <span class="string">&quot;使用IP协议传输！\n&quot;</span>); &#125;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (heapHandle == IPPROTO_TCP) &#123; <span class="built_in">strcat</span>(str, <span class="string">&quot;使用TCP协议传输！\n&quot;</span>); &#125;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (heapHandle == IPPROTO_UDP) &#123; <span class="built_in">strcat</span>(str, <span class="string">&quot;使用UDP协议传输！\n&quot;</span>); &#125;</span><br><span class="line">		<span class="function">emit <span class="title">newInfo</span><span class="params">(tempInfo)</span></span>;</span><br><span class="line">		<span class="function">emit <span class="title">newSocketInfo</span><span class="params">(QString::fromLocal8Bit(str))</span></span>;</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> BIND:</span><br><span class="line">		<span class="built_in">memset</span>(str, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(str));</span><br><span class="line">		<span class="built_in">strcat</span>(str, <span class="string">&quot;绑定IP地址为： &quot;</span>);</span><br><span class="line">		<span class="built_in">strcat</span>(str, tempInfo.Value[<span class="number">3</span>]);</span><br><span class="line">		<span class="built_in">strcat</span>(str, <span class="string">&quot;      端口号为：   &quot;</span>);</span><br><span class="line">		<span class="built_in">strcat</span>(str, tempInfo.Value[<span class="number">4</span>]);</span><br><span class="line">		<span class="function">emit <span class="title">newSocketInfo</span><span class="params">(QString::fromLocal8Bit(str))</span></span>;</span><br><span class="line">		<span class="function">emit <span class="title">newInfo</span><span class="params">(tempInfo)</span></span>;</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> SEND:</span><br><span class="line">		<span class="built_in">memset</span>(str, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(str));</span><br><span class="line">		<span class="built_in">strcat</span>(str, <span class="string">&quot;发送数据为：  &quot;</span>);</span><br><span class="line">		<span class="built_in">strcat</span>(str, tempInfo.Value[<span class="number">4</span>]);</span><br><span class="line">		<span class="function">emit <span class="title">newInfo</span><span class="params">(tempInfo)</span></span>;</span><br><span class="line">		<span class="function">emit <span class="title">newSocketInfo</span><span class="params">(QString::fromLocal8Bit(str))</span></span>;</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> CONNECT:</span><br><span class="line">		<span class="built_in">memset</span>(str, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(str));</span><br><span class="line">		<span class="built_in">strcat</span>(str, <span class="string">&quot;连接IP地址为:   &quot;</span>);</span><br><span class="line">		<span class="built_in">strcat</span>(str, tempInfo.Value[<span class="number">3</span>]);</span><br><span class="line">		<span class="built_in">strcat</span>(str, <span class="string">&quot;      端口号为：   &quot;</span>);</span><br><span class="line">		<span class="built_in">strcat</span>(str, tempInfo.Value[<span class="number">4</span>]);</span><br><span class="line">		<span class="function">emit <span class="title">newInfo</span><span class="params">(tempInfo)</span></span>;</span><br><span class="line">		<span class="function">emit <span class="title">newSocketInfo</span><span class="params">(QString::fromLocal8Bit(str))</span></span>;</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> RECV:</span><br><span class="line">		<span class="built_in">memset</span>(str, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(str));</span><br><span class="line">		<span class="built_in">strcat</span>(str, <span class="string">&quot;接收数据为：   &quot;</span>);</span><br><span class="line">		<span class="built_in">strcat</span>(str, tempInfo.Value[<span class="number">4</span>]);</span><br><span class="line">		<span class="function">emit <span class="title">newInfo</span><span class="params">(tempInfo)</span></span>;</span><br><span class="line">		<span class="function">emit <span class="title">newSocketInfo</span><span class="params">(QString::fromLocal8Bit(str))</span></span>;</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">default</span>:</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">MyThread::GetLastFolder</span><span class="params">(<span class="keyword">char</span>* filePath, string&amp; folder)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> index = <span class="built_in">strlen</span>(filePath);</span><br><span class="line">	<span class="comment">// 去除文件名</span></span><br><span class="line">	<span class="keyword">while</span> (filePath[index - <span class="number">1</span>] != <span class="string">&#x27;\\&#x27;</span>) &#123;</span><br><span class="line">		index--;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// 去除斜杠</span></span><br><span class="line">	<span class="keyword">while</span> (filePath[index - <span class="number">1</span>] == <span class="string">&#x27;\\&#x27;</span>) &#123;</span><br><span class="line">		index--;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// 得到文件夹</span></span><br><span class="line">	<span class="keyword">while</span> (filePath[index - <span class="number">1</span>] != <span class="string">&#x27;\\&#x27;</span>) &#123;</span><br><span class="line">		index--;</span><br><span class="line">	&#125;</span><br><span class="line">	index++;</span><br><span class="line">	<span class="keyword">while</span> (filePath[index - <span class="number">1</span>] != <span class="string">&#x27;\\&#x27;</span>) &#123;</span><br><span class="line">		folder.<span class="built_in">push_back</span>(filePath[index - <span class="number">1</span>]);</span><br><span class="line">		index++;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">MyThread::GetFileSize</span><span class="params">(<span class="keyword">int</span> size)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	fileSize = size;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="测试程序testcode"><a class="markdownIt-Anchor" href="#测试程序testcode"></a> 测试程序TestCode</h3>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtext>  </mtext><mi>S</mi><mi>o</mi><mi>u</mi><mi>r</mi><mi>c</mi><mi>e</mi><mi mathvariant="normal">.</mi><mi>c</mi><mi>p</mi><mi>p</mi><mtext>  </mtext></mrow><annotation encoding="application/x-tex">\;Source.cpp\;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">o</span><span class="mord mathdefault">u</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">c</span><span class="mord mathdefault">e</span><span class="mord">.</span><span class="mord mathdefault">c</span><span class="mord mathdefault">p</span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span></span></span>:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;exception&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;fstream&gt;</span></span></span><br><span class="line"><span class="comment">//#include &lt;WinSock2.h&gt;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> comment(lib, <span class="meta-string">&quot;ws2_32.lib&quot;</span>)  <span class="comment">//加载 ws2_32.dll</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> <span class="meta-keyword">warning</span>(disable:4996)</span></span><br><span class="line"><span class="comment">//#include &lt;wchar.h&gt;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PAGE_SIZE	4096</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="comment">//全局变量</span></span><br><span class="line">HANDLE filehandle,filehandle2,filehandle3;</span><br><span class="line"><span class="comment">//自定义函数</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">showMenu</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">createfile</span><span class="params">(<span class="keyword">int</span> i)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">writefile</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">readfile</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">HeapCreateAndFree</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">HeapRepeadFree</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">RegCreateAndSet</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SendSocket</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">RecvSocket</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SelfCopy</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> op = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span> (<span class="number">1</span>) </span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">showMenu</span>();</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;op);</span><br><span class="line">		<span class="built_in"><span class="keyword">switch</span></span> (op)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="comment">// exit</span></span><br><span class="line">		<span class="keyword">case</span> <span class="number">0</span>: &#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;See You !\n&quot;</span>);</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">1</span>: &#123;</span><br><span class="line">			<span class="built_in">MessageBoxA</span>(<span class="literal">NULL</span>, <span class="string">&quot;不像我只会心疼哥哥(OvO)&quot;</span>, <span class="string">&quot;MessageBoxA&quot;</span>, MB_OK);</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">2</span>: &#123;</span><br><span class="line">			<span class="built_in">MessageBoxW</span>(<span class="literal">NULL</span>, <span class="string">L&quot;以手册之力击碎黑暗！&quot;</span>, <span class="string">L&quot;MessageBoxW&quot;</span>, MB_OK);</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;请选择创建类型：1、创建普通文件  2、创建可执行文件   3、涉及操作多个文件夹\n&quot;</span>);</span><br><span class="line">			<span class="keyword">int</span> i;</span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;i);</span><br><span class="line">			<span class="built_in">createfile</span>(i);</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">			<span class="built_in">writefile</span>();</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">			<span class="built_in">readfile</span>();</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">6</span>:</span><br><span class="line">			<span class="built_in">HeapCreateAndFree</span>();</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">7</span>:</span><br><span class="line">			<span class="built_in">HeapRepeadFree</span>();</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">8</span>:</span><br><span class="line">			<span class="built_in">RegCreateAndSet</span>();</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">9</span>:</span><br><span class="line">			<span class="built_in">SendSocket</span>();</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">10</span>:</span><br><span class="line">			<span class="built_in">RecvSocket</span>();</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">11</span>:</span><br><span class="line">			<span class="built_in">SelfCopy</span>();</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">default</span>:</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">// exit</span></span><br><span class="line">		<span class="keyword">if</span> (op == <span class="number">0</span>) &#123;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">system</span>(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">		<span class="built_in">system</span>(<span class="string">&quot;cls&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">showMenu</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n*************************************************************************************\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;--------------------------------选择操作--------------------------------\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;1.弹窗MessageBoxA      2.弹窗MessageBoxW      3.创建文件CreateFile\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;4.写文件WriteFile      5.读文件ReadFile       6.创建堆、释放堆、销毁堆\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;7.堆重复释放           8.注册键操作           9.网络通信之发消息\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;10.网络通信之收消息    11.文件自我复制\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n*************************************************************************************\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">createfile</span><span class="params">(<span class="keyword">int</span> i)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in"><span class="keyword">switch</span></span> (i)</span><br><span class="line">	&#123;</span><br><span class="line">	<span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">		filehandle = <span class="built_in">CreateFile</span>(<span class="string">L&quot;.\\TempFile\\001.txt&quot;</span>, GENERIC_READ | GENERIC_WRITE, FILE_SHARE_READ, <span class="literal">NULL</span>, CREATE_ALWAYS, <span class="literal">NULL</span>, <span class="literal">NULL</span>);</span><br><span class="line">		<span class="keyword">if</span> (filehandle == INVALID_HANDLE_VALUE)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;文件创建失败！&quot;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;文件创建成功！&quot;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> <span class="number">2</span>:<span class="comment">//创建可执行文件</span></span><br><span class="line">		filehandle = <span class="built_in">CreateFile</span>(<span class="string">L&quot;.\\TempFile\\002.exe&quot;</span>, GENERIC_READ | GENERIC_WRITE, FILE_SHARE_READ, <span class="literal">NULL</span>, CREATE_ALWAYS, <span class="literal">NULL</span>, <span class="literal">NULL</span>);</span><br><span class="line">		<span class="keyword">if</span> (filehandle == INVALID_HANDLE_VALUE)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;文件创建失败！&quot;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;文件创建成功！&quot;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">		filehandle= <span class="built_in">CreateFile</span>(<span class="string">L&quot;.\\TempFile\\003.exe&quot;</span>, GENERIC_READ | GENERIC_WRITE, FILE_SHARE_READ, <span class="literal">NULL</span>, CREATE_ALWAYS, <span class="literal">NULL</span>, <span class="literal">NULL</span>);</span><br><span class="line">		filehandle2 = <span class="built_in">CreateFile</span>(<span class="string">L&quot;.\\TempFile\\004.dll&quot;</span>, GENERIC_READ | GENERIC_WRITE, FILE_SHARE_READ, <span class="literal">NULL</span>, CREATE_ALWAYS, <span class="literal">NULL</span>, <span class="literal">NULL</span>);</span><br><span class="line">		filehandle3 = <span class="built_in">CreateFile</span>(<span class="string">L&quot;.\\TempFile2\\005.ocx&quot;</span>, GENERIC_READ | GENERIC_WRITE, FILE_SHARE_READ, <span class="literal">NULL</span>, CREATE_ALWAYS, <span class="literal">NULL</span>, <span class="literal">NULL</span>);</span><br><span class="line">		<span class="keyword">if</span> ((filehandle == INVALID_HANDLE_VALUE) || (filehandle2 == INVALID_HANDLE_VALUE) || (filehandle3 == INVALID_HANDLE_VALUE))</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;创建多个文件夹中的文件失败！&quot;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;创建成功！&quot;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">default</span>:</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">CloseHandle</span>(filehandle);</span><br><span class="line">	<span class="built_in">CloseHandle</span>(filehandle2);</span><br><span class="line">	<span class="built_in">CloseHandle</span>(filehandle3);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">writefile</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	filehandle = <span class="built_in">CreateFile</span>(<span class="string">L&quot;.\\TempFile\\007.txt&quot;</span>, GENERIC_READ | GENERIC_WRITE, FILE_SHARE_READ, <span class="literal">NULL</span>, CREATE_ALWAYS, <span class="literal">NULL</span>, <span class="literal">NULL</span>);</span><br><span class="line">	CHAR* pBuffer;</span><br><span class="line">	<span class="keyword">int</span> fileSize = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">char</span> writeString[<span class="number">100</span>] = <span class="string">&quot;总有人间一两风，填我十万八千梦！&quot;</span>;</span><br><span class="line">	<span class="keyword">bool</span> flag;</span><br><span class="line">	<span class="keyword">if</span> (filehandle == INVALID_HANDLE_VALUE)</span><br><span class="line">	&#123;</span><br><span class="line">		filehandle = <span class="literal">NULL</span>;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;打开文件失败！\n&quot;</span>);</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;成功打开文件\n&quot;</span>);</span><br><span class="line">	flag = <span class="built_in">WriteFile</span>(filehandle, writeString, <span class="built_in">strlen</span>(writeString), <span class="literal">NULL</span>, <span class="literal">NULL</span>);</span><br><span class="line">	<span class="keyword">if</span> (flag) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;成功写入文件\n&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">FlushFileBuffers</span>(filehandle);</span><br><span class="line">	<span class="built_in">CloseHandle</span>(filehandle);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">readfile</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	 filehandle = <span class="built_in">CreateFile</span>(<span class="string">L&quot;.\\TempFile\\007.txt&quot;</span>, GENERIC_READ | GENERIC_WRITE, FILE_SHARE_READ, <span class="literal">NULL</span>, CREATE_ALWAYS, <span class="literal">NULL</span>, <span class="literal">NULL</span>);</span><br><span class="line">	CHAR* pBuffer;</span><br><span class="line">	<span class="keyword">int</span> fileSize = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">bool</span> flag;</span><br><span class="line">	<span class="keyword">if</span> (filehandle == INVALID_HANDLE_VALUE)</span><br><span class="line">	&#123;</span><br><span class="line">		filehandle = <span class="literal">NULL</span>;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;打开文件失败！\n&quot;</span>);</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;成功打开文件！\n&quot;</span>);</span><br><span class="line">	fileSize = <span class="built_in">GetFileSize</span>(filehandle, <span class="literal">NULL</span>);</span><br><span class="line">	pBuffer = (<span class="keyword">char</span>*)<span class="built_in">malloc</span>((fileSize + <span class="number">1</span>) * <span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">char</span>));</span><br><span class="line">	flag = <span class="built_in">ReadFile</span>(filehandle, pBuffer, fileSize, <span class="literal">NULL</span>, <span class="literal">NULL</span>);</span><br><span class="line">	pBuffer[fileSize] = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">if</span> (flag) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;成功读取字符串!\n&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">free</span>(pBuffer);</span><br><span class="line">	<span class="built_in">CloseHandle</span>(filehandle);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">HeapCreateAndFree</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;按下任意键创建堆！\n\n&quot;</span>);</span><br><span class="line">	<span class="built_in">getchar</span>();</span><br><span class="line">	HANDLE hHeap = <span class="built_in">HeapCreate</span>(HEAP_NO_SERIALIZE, PAGE_SIZE * <span class="number">10</span>, PAGE_SIZE * <span class="number">100</span>);</span><br><span class="line">	<span class="built_in">getchar</span>();</span><br><span class="line">	<span class="keyword">int</span>* pArr = (<span class="keyword">int</span>*)<span class="built_in">HeapAlloc</span>(hHeap, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">int</span>) * <span class="number">30</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;堆创建成功！\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;按下任意键释放堆！\n\n&quot;</span>);</span><br><span class="line">	<span class="built_in">getchar</span>();</span><br><span class="line">	<span class="built_in">HeapFree</span>(hHeap, <span class="number">0</span>, pArr);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;堆释放成功！\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;按下任意键销毁堆！\n\n&quot;</span>);</span><br><span class="line">	<span class="built_in">getchar</span>();</span><br><span class="line">	<span class="built_in">HeapDestroy</span>(hHeap);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;堆销毁成功！\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">HeapRepeadFree</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;按下任意键开始重复创建堆！\n&quot;</span>);</span><br><span class="line">	<span class="built_in">getchar</span>();</span><br><span class="line">	HANDLE hHeap = <span class="built_in">HeapCreate</span>(HEAP_NO_SERIALIZE, PAGE_SIZE * <span class="number">10</span>, PAGE_SIZE * <span class="number">100</span>);</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">int</span>* pArr = (<span class="keyword">int</span>*)<span class="built_in">HeapAlloc</span>(hHeap, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">int</span>) * <span class="number">30</span>);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">30</span>; ++i)</span><br><span class="line">	&#123;</span><br><span class="line">		pArr[i] = i + <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;堆创建成功！\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;开始第一次释放堆！\n&quot;</span>);</span><br><span class="line">	<span class="built_in">getchar</span>();</span><br><span class="line">	<span class="built_in">HeapFree</span>(hHeap, <span class="number">0</span>, pArr);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;开始第二次释放堆！\n&quot;</span>);</span><br><span class="line">	<span class="built_in">getchar</span>();</span><br><span class="line">	<span class="built_in">HeapFree</span>(hHeap, <span class="number">0</span>, pArr);</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;按任意键销毁堆！\n&quot;</span>);</span><br><span class="line">	<span class="built_in">getchar</span>();</span><br><span class="line">	<span class="built_in">HeapDestroy</span>(hHeap);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">RegCreateAndSet</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">// 创建注册表并设置键值</span></span><br><span class="line">	HKEY hKey = <span class="literal">NULL</span>;</span><br><span class="line">	TCHAR Data[<span class="number">254</span>];</span><br><span class="line">	<span class="built_in">memset</span>(Data, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(Data));</span><br><span class="line">	<span class="built_in">wcsncpy_s</span>(Data, <span class="built_in">TEXT</span>(<span class="string">&quot;https://www.baidu.com&quot;</span>), <span class="number">254</span>);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">size_t</span> lRet = <span class="built_in">RegCreateKeyEx</span>(HKEY_CURRENT_USER, (LPWSTR)<span class="string">L&quot;SOFTWARE\Microsoft\Windows\CurrentVersion\Run\MyRegKey&quot;</span>, <span class="number">0</span>, <span class="literal">NULL</span>, REG_OPTION_NON_VOLATILE,</span><br><span class="line">		KEY_ALL_ACCESS, <span class="literal">NULL</span>, &amp;hKey, <span class="literal">NULL</span>);</span><br><span class="line">	<span class="keyword">if</span> (lRet == ERROR_SUCCESS) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;注册表自启动键创建成功！\n&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;注册表自启动键创建失败！\n&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// 修改注册表键值，没有则创建它</span></span><br><span class="line">	<span class="keyword">size_t</span> iLen = <span class="built_in">wcslen</span>(Data);</span><br><span class="line">	<span class="comment">// 设置键值</span></span><br><span class="line">	lRet = <span class="built_in">RegSetValueEx</span>(hKey, <span class="string">L&quot;Changpeng&quot;</span>, <span class="number">0</span>, REG_SZ, (CONST BYTE*)Data, <span class="built_in"><span class="keyword">sizeof</span></span>(TCHAR) * iLen);</span><br><span class="line">	<span class="keyword">if</span> (lRet == ERROR_SUCCESS)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;注册键修改值成功！\n&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;修改注册键值失败！\n&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;按任意键关闭注册键！\n&quot;</span>);</span><br><span class="line">	<span class="built_in">getchar</span>();</span><br><span class="line">	<span class="built_in">getchar</span>();</span><br><span class="line">	<span class="built_in">RegCloseKey</span>(hKey);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;按任意键再次打开注册键！\n&quot;</span>);</span><br><span class="line">	<span class="built_in">getchar</span>();</span><br><span class="line">	lRet = <span class="built_in">RegOpenKeyEx</span>(HKEY_CURRENT_USER, (LPWSTR)<span class="string">L&quot;SOFTWARE\Microsoft\Windows\CurrentVersion\Run\MyRegKey&quot;</span>, <span class="number">0</span>, KEY_ALL_ACCESS, &amp;hKey);</span><br><span class="line">	<span class="keyword">if</span> (lRet == ERROR_SUCCESS) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;注册键打开成功！\n&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;注册键打开失败！\n&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;按任意键删除键值！\n&quot;</span>);</span><br><span class="line">	<span class="built_in">getchar</span>();</span><br><span class="line">	lRet = <span class="built_in">RegDeleteValue</span>(hKey, <span class="string">L&quot;Changpeng&quot;</span>);</span><br><span class="line">	<span class="keyword">if</span> (lRet == ERROR_SUCCESS) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;注册键删除成功！\n&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;注册键删除失败！\n&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">RegCloseKey</span>(hKey);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SendSocket</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">//初始化 DLL</span></span><br><span class="line">	WSADATA wsaData;</span><br><span class="line">	<span class="built_in">WSAStartup</span>(<span class="built_in">MAKEWORD</span>(<span class="number">2</span>, <span class="number">2</span>), &amp;wsaData);</span><br><span class="line">	<span class="comment">//创建套接字</span></span><br><span class="line">	SOCKET servSock = <span class="built_in">socket</span>(PF_INET, SOCK_STREAM, IPPROTO_TCP);</span><br><span class="line">	<span class="comment">//绑定套接字</span></span><br><span class="line">	sockaddr_in sockAddr;</span><br><span class="line">	<span class="built_in">memset</span>(&amp;sockAddr, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(sockAddr));  <span class="comment">//每个字节都用0填充</span></span><br><span class="line">	sockAddr.sin_family = PF_INET;  <span class="comment">//使用IPv4地址</span></span><br><span class="line">	sockAddr.sin_addr.s_addr = <span class="built_in">inet_addr</span>(<span class="string">&quot;127.0.0.1&quot;</span>);  <span class="comment">//具体的IP地址</span></span><br><span class="line">	sockAddr.sin_port = <span class="built_in">htons</span>(<span class="number">8888</span>);  <span class="comment">//端口</span></span><br><span class="line">	<span class="built_in">bind</span>(servSock, (SOCKADDR*)&amp;sockAddr, <span class="built_in"><span class="keyword">sizeof</span></span>(SOCKADDR));</span><br><span class="line">	<span class="comment">//进入监听状态</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;正在等待连接......\n&quot;</span>);</span><br><span class="line">	<span class="built_in">listen</span>(servSock, <span class="number">20</span>);</span><br><span class="line">	<span class="comment">//接收客户端请求</span></span><br><span class="line">	SOCKADDR clntAddr;</span><br><span class="line">	<span class="keyword">int</span> nSize = <span class="built_in"><span class="keyword">sizeof</span></span>(SOCKADDR);</span><br><span class="line">	SOCKET clntSock = <span class="built_in">accept</span>(servSock, (SOCKADDR*)&amp;clntAddr, &amp;nSize);</span><br><span class="line">	<span class="comment">//向客户端发送数据</span></span><br><span class="line">	<span class="keyword">char</span> str[<span class="number">32</span>] = <span class="string">&quot;你好，我是发送端！&quot;</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;正在发送数据......\n&quot;</span>);</span><br><span class="line">	<span class="built_in">send</span>(clntSock, str, <span class="built_in">strlen</span>(str) + <span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">char</span>), <span class="literal">NULL</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;成功发送数据！\n&quot;</span>);</span><br><span class="line">	<span class="comment">//关闭套接字</span></span><br><span class="line">	<span class="built_in">closesocket</span>(clntSock);</span><br><span class="line">	<span class="built_in">closesocket</span>(servSock);</span><br><span class="line">	<span class="comment">//终止 DLL 的使用</span></span><br><span class="line">	<span class="built_in">WSACleanup</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">RecvSocket</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">//初始化DLL</span></span><br><span class="line">	WSADATA wsaData;</span><br><span class="line">	<span class="built_in">WSAStartup</span>(<span class="built_in">MAKEWORD</span>(<span class="number">2</span>, <span class="number">2</span>), &amp;wsaData);</span><br><span class="line">	<span class="comment">//创建套接字</span></span><br><span class="line">	SOCKET sock = <span class="built_in">socket</span>(PF_INET, SOCK_STREAM, IPPROTO_TCP);</span><br><span class="line">	<span class="comment">//向服务器发起请求</span></span><br><span class="line">	sockaddr_in sockAddr;</span><br><span class="line">	<span class="built_in">memset</span>(&amp;sockAddr, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(sockAddr));  <span class="comment">//每个字节都用0填充</span></span><br><span class="line">	sockAddr.sin_family = PF_INET;</span><br><span class="line">	sockAddr.sin_addr.s_addr = <span class="built_in">inet_addr</span>(<span class="string">&quot;127.0.0.1&quot;</span>);</span><br><span class="line">	sockAddr.sin_port = <span class="built_in">htons</span>(<span class="number">8888</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;正在尝试连接......\n&quot;</span>);</span><br><span class="line">	<span class="built_in">connect</span>(sock, (SOCKADDR*)&amp;sockAddr, <span class="built_in"><span class="keyword">sizeof</span></span>(SOCKADDR));</span><br><span class="line">	<span class="built_in">Sleep</span>(<span class="number">500</span>);</span><br><span class="line">	<span class="comment">//接收服务器传回的数据</span></span><br><span class="line">	<span class="keyword">char</span> szBuffer[MAXBYTE] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;正在接受数据......\n&quot;</span>);</span><br><span class="line">	<span class="built_in">recv</span>(sock, szBuffer, MAXBYTE, <span class="literal">NULL</span>);</span><br><span class="line">	<span class="comment">//输出接收到的数据</span></span><br><span class="line">	<span class="keyword">if</span> (szBuffer[<span class="number">0</span>] != <span class="string">&#x27;\0&#x27;</span>) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;成功收到数据： %s\n&quot;</span>, szBuffer);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;接受数据失败！\n&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//关闭套接字</span></span><br><span class="line">	<span class="built_in">closesocket</span>(sock);</span><br><span class="line">	<span class="comment">//终止使用 DLL</span></span><br><span class="line">	<span class="built_in">WSACleanup</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SelfCopy</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">char</span> path[MAX_PATH];</span><br><span class="line">	<span class="built_in">memset</span>(path, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(path));</span><br><span class="line">	<span class="built_in">GetModuleFileNameA</span>(<span class="literal">NULL</span>, path, <span class="built_in"><span class="keyword">sizeof</span></span>(path));<span class="comment">//获得文件路径</span></span><br><span class="line">	<span class="keyword">char</span> des[<span class="number">50</span>] = <span class="string">&quot;./copyfile.exe&quot;</span>;</span><br><span class="line">	<span class="keyword">if</span> (<span class="built_in">CopyFileA</span>(path, des, <span class="literal">true</span>))</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">getchar</span>();</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;自我复制成功！\n&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;自我复制失败！\n&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:1524276984@qq.com">Zhao CP</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://zhao-zhao2001.gitee.io/2021/11/17/%E5%9F%BA%E4%BA%8EAPI-HOOK%E7%9A%84%E8%BD%AF%E4%BB%B6%E8%A1%8C%E4%B8%BA%E5%88%86%E6%9E%90%E7%B3%BB%E7%BB%9F/">https://zhao-zhao2001.gitee.io/2021/11/17/%E5%9F%BA%E4%BA%8EAPI-HOOK%E7%9A%84%E8%BD%AF%E4%BB%B6%E8%A1%8C%E4%B8%BA%E5%88%86%E6%9E%90%E7%B3%BB%E7%BB%9F/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://zhao-zhao2001.gitee.io" target="_blank">穿越时空BB机</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E8%BD%AF%E4%BB%B6%E5%AE%89%E5%85%A8/">软件安全</a><a class="post-meta__tags" href="/tags/%E8%AF%BE%E7%A8%8B%E8%AE%BE%E8%AE%A1/">课程设计</a></div><div class="post_share"><div class="social-share" data-image="https://changpeng-image.oss-cn-hangzhou.aliyuncs.com/images-master/img/21142970880911ebb6edd017c2d2eca2.jpg" data-sites="wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2021/11/17/%E6%AD%A6%E6%B1%89%E5%9C%B0%E9%93%81%E6%A8%A1%E6%8B%9F%E7%B3%BB%E7%BB%9F/"><img class="prev-cover" src="https://changpeng-image.oss-cn-hangzhou.aliyuncs.com/images-master/img/c0b418d39a3444e997791a823bc6bea3.jpg" onerror="onerror=null;src='https://changpeng-image.oss-cn-hangzhou.aliyuncs.com/images-master/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">武汉地铁模拟系统</div></div></a></div><div class="next-post pull-right"><a href="/2021/11/17/%E7%AE%97%E6%B3%95%E8%AE%B0%E5%BD%95-%E5%B9%B6%E6%9F%A5%E9%9B%86/"><img class="next-cover" src="https://changpeng-image.oss-cn-hangzhou.aliyuncs.com/images-master/img/718adb38133c407c95806c828e3edf08.png" onerror="onerror=null;src='https://changpeng-image.oss-cn-hangzhou.aliyuncs.com/images-master/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">算法记录-并查集</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="waline-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://changpeng-image.oss-cn-hangzhou.aliyuncs.com/images-master/img/self.png" onerror="this.onerror=null;this.src='https://changpeng-image.oss-cn-hangzhou.aliyuncs.com/images-master/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Zhao CP</div><div class="author-info__description">巅峰产生虚伪的拥护，黄昏见证真正的信徒</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">24</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">13</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">16</div></a></div></div><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/Zhao-zhao2001" target="_blank" title="Github"><i class="iconfont icon-github"></i></a><a class="social-icon" href="mailto:1524276984@qq.com" target="_blank" title="Email"><i class="iconfont icon-zhuangsetubiao-18"></i></a><a class="social-icon" href="https://changpeng-image.oss-cn-hangzhou.aliyuncs.com/images-master/img/qq.jpg" target="_blank" title="QQ"><i class="iconfont icon-linedesign-17"></i></a><a class="social-icon" href="https://changpeng-image.oss-cn-hangzhou.aliyuncs.com/images-master/img/wechat.jpg" target="_blank" title="微信"><i class="iconfont icon-wechat"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#dll%E7%BC%96%E5%86%99"><span class="toc-number">1.</span> <span class="toc-text"> Dll编写</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%A8%E5%B0%84%E5%99%A8%E7%A8%8B%E5%BA%8F"><span class="toc-number">2.</span> <span class="toc-text"> 注射器程序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BB%E7%A8%8B%E5%BA%8Fsoftwarescan"><span class="toc-number">3.</span> <span class="toc-text"> 主程序SoftWareScan</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%8B%E8%AF%95%E7%A8%8B%E5%BA%8Ftestcode"><span class="toc-number">4.</span> <span class="toc-text"> 测试程序TestCode</span></a></li></ol></div></div></div></div></main><footer id="footer" style="background-image: url('https://changpeng-image.oss-cn-hangzhou.aliyuncs.com/images-master/img/21142970880911ebb6edd017c2d2eca2.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2021 - 2022 By Zhao CP</div><div class="footer_custom_text"><p><a style="margin-inline:5px"target="_blank" href="https://hexo.io/"><img src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&logo=hexo" title="博客框架为 Hexo" alt="HEXO"></a><a style="margin-inline:5px"target="_blank" href="https://butterfly.js.org/"><img src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&logo=bitdefender" title="主题采用 Butterfly" alt="Butterfly"></a><a style="margin-inline:5px"target="_blank" href="https://www.jsdelivr.com/"><img src="https://img.shields.io/badge/CDN-jsDelivr-orange?style=flat&logo=jsDelivr" title="本站使用 Jsdelivr 为静态资源提供CDN加速" alt="Jsdelivr"></a><a style="margin-inline:5px"target="_blank" href="https://github.com/"><img src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&logo=GitHub" title="本站项目由 GitHub 托管" alt="GitHub"></a><a style="margin-inline:5px"target="_blank"href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&logo=Claris" alt="img" title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可"></a></p></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="font-plus" type="button" title="放大字体"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="缩小字体"><i class="fas fa-minus"></i></button><button id="translateLink" type="button" title="简繁转换">简</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="chat_btn" type="button" title="rightside.chat_btn"><i class="fas fa-sms"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/js/search/local-search.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/contrib/copy-tex.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/contrib/copy-tex.css"><script>(() => {
  document.querySelectorAll('#article-container span.katex-display').forEach(item => {
    btf.wrap(item, 'div', { class: 'katex-wrap'})
  })
})()</script><script>function loadWaline () {
  function initWaline () {
    const waline = new Waline(Object.assign({
      el: '#waline-wrap',
      serverURL: 'https://comment-six.vercel.app/',
      avatar: 'monsterid',
      avatarCDN: 'https://sdn.geekzu.org/avatar/',
      path: location.pathname,
      visitor: true,
      dark: 'html[data-theme="dark"]'
    }, null))
  }

  if (typeof Waline === 'function') initWaline() 
  else getScript('https://cdn.jsdelivr.net/npm/@waline/client/dist/Waline.min.js').then(initWaline)
}

if ('Waline' === 'Waline' || !true) {
  if (true) btf.loadComment(document.getElementById('waline-wrap'),loadWaline)
  else setTimeout(loadWaline, 0)
} else {
  function loadOtherComment () {
    loadWaline()
  }
}</script></div><script data-pjax src="/js/Peng.js"></script><div class="aplayer no-destroy" data-id="6735350605" data-server="netease" data-type="playlist" data-fixed="true" data-mini="true" data-listFolded="false" data-order="random" data-preload="none" data-autoplay="true" muted></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/fireworks.min.js"></script><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = true;
document.body.addEventListener('input', POWERMODE);
</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/gh/SerokSSR/cdn/meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = [
  'title',
  '#config-diff',
  '#body-wrap',
  '#rightside-config-hide',
  '#rightside-config-show',
  '.js-pjax'
]

if (false) {
  pjaxSelectors.unshift('meta[property="og:image"]', 'meta[property="og:title"]', 'meta[property="og:url"]')
}

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.removeEventListener('scroll', window.tocScrollFn)
  window.removeEventListener('scroll', scrollCollect)

  typeof preloader === 'object' && preloader.initLoading()
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // Analytics
  if (false) {
    MtaH5.pgv()
  }

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()

  typeof preloader === 'object' && preloader.endLoading()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><!-- hexo injector body_end start --><script data-pjax>function history_calendar_injector_config(){
                var parent_div_git = document.getElementsByClassName('sticky_layout')[0];
                var item_html = '<div class="card-widget card-history"><div class="card-content"><div class="item-headline"><i class="fas fa-clock fa-spin"></i><span>那年今日</span></div><div id="history-baidu" style="height: 100px;overflow: hidden"><div class="history_swiper-container" id="history-container" style="width: 100%;height: 100%"><div class="swiper-wrapper" id="history_container_wrapper" style="height:20px"></div></div></div></div>';
                console.log('已挂载history_calendar')
                // parent_div_git.innerHTML=item_html+parent_div_git.innerHTML // 无报错，但不影响使用(支持pjax跳转)
                parent_div_git.insertAdjacentHTML("afterbegin",item_html) // 有报错，但不影响使用(支持pjax跳转)
            }if( document.getElementsByClassName('sticky_layout')[0] && (location.pathname ==='all'|| 'all' ==='all')){

            history_calendar_injector_config()
        } </script><script data-pjax  src="https://cdn.jsdelivr.net/npm/swiper/swiper-bundle.min.js"></script><script data-pjax src="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-card-history/baiduhistory/js/main.js"></script><script data-pjax>function electric_clock_injector_config(){
                var parent_div_git = document.getElementsByClassName('sticky_layout')[0];
                var item_html = '<div class="card-widget card-clock"><div class="card-glass"><div class="card-background"><div class="card-content"><div id="hexo_electric_clock"><img id="card-clock-loading" src="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-clock/clock/images/weather/loading.gif" style="height: 120px; width: 100%;" data-ll-status="loading" class="entered loading"></div></div></div></div></div>';
                console.log('已挂载electric_clock')
                // parent_div_git.innerHTML=item_html+parent_div_git.innerHTML // 无报错，但不影响使用(支持pjax跳转)
                parent_div_git.insertAdjacentHTML("afterbegin",item_html) // 有报错，但不影响使用(支持pjax跳转)
            }if( document.getElementsByClassName('sticky_layout')[0] && (location.pathname ==='all'|| 'all' ==='all')){

            electric_clock_injector_config()
        } </script><script src="https://pv.sohu.com/cityjson?ie=utf-8"></script><script data-pjax  src="https://cdn.jsdelivr.net/gh/Zfour/hexo-electric-clock@1.0.6/clock.js"></script><script async src="//at.alicdn.com/t/font_2032782_8d5kxvn09md.js"></script><!-- hexo injector body_end end --></body></html>